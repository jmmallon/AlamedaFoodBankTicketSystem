{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";import useState from\"rc-util/es/hooks/useState\";import*as React from'react';import{STEP_ACTIVATED,STEP_ACTIVE,STEP_NONE,STEP_PREPARE,STEP_PREPARED,STEP_START}from\"../interface\";import useIsomorphicLayoutEffect from\"./useIsomorphicLayoutEffect\";import useNextFrame from\"./useNextFrame\";var FULL_STEP_QUEUE=[STEP_PREPARE,STEP_START,STEP_ACTIVE,STEP_ACTIVATED];var SIMPLE_STEP_QUEUE=[STEP_PREPARE,STEP_PREPARED];/** Skip current step */export var SkipStep=false;/** Current step should be update in */export var DoStep=true;export function isActive(step){return step===STEP_ACTIVE||step===STEP_ACTIVATED;}export default(function(status,prepareOnly,callback){var _useState=useState(STEP_NONE),_useState2=_slicedToArray(_useState,2),step=_useState2[0],setStep=_useState2[1];var _useNextFrame=useNextFrame(),_useNextFrame2=_slicedToArray(_useNextFrame,2),nextFrame=_useNextFrame2[0],cancelNextFrame=_useNextFrame2[1];function startQueue(){setStep(STEP_PREPARE,true);}var STEP_QUEUE=prepareOnly?SIMPLE_STEP_QUEUE:FULL_STEP_QUEUE;useIsomorphicLayoutEffect(function(){if(step!==STEP_NONE&&step!==STEP_ACTIVATED){var index=STEP_QUEUE.indexOf(step);var nextStep=STEP_QUEUE[index+1];var result=callback(step);if(result===SkipStep){// Skip when no needed\nsetStep(nextStep,true);}else if(nextStep){// Do as frame for step update\nnextFrame(function(info){function doNext(){// Skip since current queue is ood\nif(info.isCanceled())return;setStep(nextStep,true);}if(result===true){doNext();}else{// Only promise should be async\nPromise.resolve(result).then(doNext);}});}}},[status,step]);React.useEffect(function(){return function(){cancelNextFrame();};},[]);return[startQueue,step];});","map":{"version":3,"names":["_slicedToArray","useState","React","STEP_ACTIVATED","STEP_ACTIVE","STEP_NONE","STEP_PREPARE","STEP_PREPARED","STEP_START","useIsomorphicLayoutEffect","useNextFrame","FULL_STEP_QUEUE","SIMPLE_STEP_QUEUE","SkipStep","DoStep","isActive","step","status","prepareOnly","callback","_useState","_useState2","setStep","_useNextFrame","_useNextFrame2","nextFrame","cancelNextFrame","startQueue","STEP_QUEUE","index","indexOf","nextStep","result","info","doNext","isCanceled","Promise","resolve","then","useEffect"],"sources":["/Users/jmmallon/Downloads/js/ticketproject/src/node_modules/rc-motion/es/hooks/useStepQueue.js"],"sourcesContent":["import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport useState from \"rc-util/es/hooks/useState\";\nimport * as React from 'react';\nimport { STEP_ACTIVATED, STEP_ACTIVE, STEP_NONE, STEP_PREPARE, STEP_PREPARED, STEP_START } from \"../interface\";\nimport useIsomorphicLayoutEffect from \"./useIsomorphicLayoutEffect\";\nimport useNextFrame from \"./useNextFrame\";\nvar FULL_STEP_QUEUE = [STEP_PREPARE, STEP_START, STEP_ACTIVE, STEP_ACTIVATED];\nvar SIMPLE_STEP_QUEUE = [STEP_PREPARE, STEP_PREPARED];\n\n/** Skip current step */\nexport var SkipStep = false;\n/** Current step should be update in */\nexport var DoStep = true;\nexport function isActive(step) {\n  return step === STEP_ACTIVE || step === STEP_ACTIVATED;\n}\nexport default (function (status, prepareOnly, callback) {\n  var _useState = useState(STEP_NONE),\n    _useState2 = _slicedToArray(_useState, 2),\n    step = _useState2[0],\n    setStep = _useState2[1];\n  var _useNextFrame = useNextFrame(),\n    _useNextFrame2 = _slicedToArray(_useNextFrame, 2),\n    nextFrame = _useNextFrame2[0],\n    cancelNextFrame = _useNextFrame2[1];\n  function startQueue() {\n    setStep(STEP_PREPARE, true);\n  }\n  var STEP_QUEUE = prepareOnly ? SIMPLE_STEP_QUEUE : FULL_STEP_QUEUE;\n  useIsomorphicLayoutEffect(function () {\n    if (step !== STEP_NONE && step !== STEP_ACTIVATED) {\n      var index = STEP_QUEUE.indexOf(step);\n      var nextStep = STEP_QUEUE[index + 1];\n      var result = callback(step);\n      if (result === SkipStep) {\n        // Skip when no needed\n        setStep(nextStep, true);\n      } else if (nextStep) {\n        // Do as frame for step update\n        nextFrame(function (info) {\n          function doNext() {\n            // Skip since current queue is ood\n            if (info.isCanceled()) return;\n            setStep(nextStep, true);\n          }\n          if (result === true) {\n            doNext();\n          } else {\n            // Only promise should be async\n            Promise.resolve(result).then(doNext);\n          }\n        });\n      }\n    }\n  }, [status, step]);\n  React.useEffect(function () {\n    return function () {\n      cancelNextFrame();\n    };\n  }, []);\n  return [startQueue, step];\n});"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}