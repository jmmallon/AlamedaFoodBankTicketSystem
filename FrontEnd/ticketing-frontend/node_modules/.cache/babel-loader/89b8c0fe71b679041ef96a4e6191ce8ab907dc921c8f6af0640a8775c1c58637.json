{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"@babel/runtime/helpers/esm/objectSpread2\";import _objectWithoutProperties from\"@babel/runtime/helpers/esm/objectWithoutProperties\";import _toConsumableArray from\"@babel/runtime/helpers/esm/toConsumableArray\";import _typeof from\"@babel/runtime/helpers/esm/typeof\";import _createClass from\"@babel/runtime/helpers/esm/createClass\";import _classCallCheck from\"@babel/runtime/helpers/esm/classCallCheck\";import _defineProperty from\"@babel/runtime/helpers/esm/defineProperty\";var _excluded=[\"name\"];import{merge}from\"rc-util/es/utils/set\";import warning from\"rc-util/es/warning\";import*as React from'react';import{HOOK_MARK}from\"./FieldContext\";import{allPromiseFinish}from\"./utils/asyncUtil\";import{defaultValidateMessages}from\"./utils/messages\";import NameMap from\"./utils/NameMap\";import{cloneByNamePathList,containsNamePath,getNamePath,getValue,matchNamePath,setValue}from\"./utils/valueUtil\";export var FormStore=/*#__PURE__*/_createClass(function FormStore(forceRootUpdate){var _this=this;_classCallCheck(this,FormStore);_defineProperty(this,\"formHooked\",false);_defineProperty(this,\"forceRootUpdate\",void 0);_defineProperty(this,\"subscribable\",true);_defineProperty(this,\"store\",{});_defineProperty(this,\"fieldEntities\",[]);_defineProperty(this,\"initialValues\",{});_defineProperty(this,\"callbacks\",{});_defineProperty(this,\"validateMessages\",null);_defineProperty(this,\"preserve\",null);_defineProperty(this,\"lastValidatePromise\",null);_defineProperty(this,\"getForm\",function(){return{getFieldValue:_this.getFieldValue,getFieldsValue:_this.getFieldsValue,getFieldError:_this.getFieldError,getFieldWarning:_this.getFieldWarning,getFieldsError:_this.getFieldsError,isFieldsTouched:_this.isFieldsTouched,isFieldTouched:_this.isFieldTouched,isFieldValidating:_this.isFieldValidating,isFieldsValidating:_this.isFieldsValidating,resetFields:_this.resetFields,setFields:_this.setFields,setFieldValue:_this.setFieldValue,setFieldsValue:_this.setFieldsValue,validateFields:_this.validateFields,submit:_this.submit,_init:true,getInternalHooks:_this.getInternalHooks};});// ======================== Internal Hooks ========================\n_defineProperty(this,\"getInternalHooks\",function(key){if(key===HOOK_MARK){_this.formHooked=true;return{dispatch:_this.dispatch,initEntityValue:_this.initEntityValue,registerField:_this.registerField,useSubscribe:_this.useSubscribe,setInitialValues:_this.setInitialValues,destroyForm:_this.destroyForm,setCallbacks:_this.setCallbacks,setValidateMessages:_this.setValidateMessages,getFields:_this.getFields,setPreserve:_this.setPreserve,getInitialValue:_this.getInitialValue,registerWatch:_this.registerWatch};}warning(false,'`getInternalHooks` is internal usage. Should not call directly.');return null;});_defineProperty(this,\"useSubscribe\",function(subscribable){_this.subscribable=subscribable;});/**\n   * Record prev Form unmount fieldEntities which config preserve false.\n   * This need to be refill with initialValues instead of store value.\n   */_defineProperty(this,\"prevWithoutPreserves\",null);/**\n   * First time `setInitialValues` should update store with initial value\n   */_defineProperty(this,\"setInitialValues\",function(initialValues,init){_this.initialValues=initialValues||{};if(init){var _this$prevWithoutPres;var nextStore=merge(initialValues,_this.store);// We will take consider prev form unmount fields.\n// When the field is not `preserve`, we need fill this with initialValues instead of store.\n// eslint-disable-next-line array-callback-return\n(_this$prevWithoutPres=_this.prevWithoutPreserves)===null||_this$prevWithoutPres===void 0||_this$prevWithoutPres.map(function(_ref){var namePath=_ref.key;nextStore=setValue(nextStore,namePath,getValue(initialValues,namePath));});_this.prevWithoutPreserves=null;_this.updateStore(nextStore);}});_defineProperty(this,\"destroyForm\",function(){var prevWithoutPreserves=new NameMap();_this.getFieldEntities(true).forEach(function(entity){if(!_this.isMergedPreserve(entity.isPreserve())){prevWithoutPreserves.set(entity.getNamePath(),true);}});_this.prevWithoutPreserves=prevWithoutPreserves;});_defineProperty(this,\"getInitialValue\",function(namePath){var initValue=getValue(_this.initialValues,namePath);// Not cloneDeep when without `namePath`\nreturn namePath.length?merge(initValue):initValue;});_defineProperty(this,\"setCallbacks\",function(callbacks){_this.callbacks=callbacks;});_defineProperty(this,\"setValidateMessages\",function(validateMessages){_this.validateMessages=validateMessages;});_defineProperty(this,\"setPreserve\",function(preserve){_this.preserve=preserve;});// ============================= Watch ============================\n_defineProperty(this,\"watchList\",[]);_defineProperty(this,\"registerWatch\",function(callback){_this.watchList.push(callback);return function(){_this.watchList=_this.watchList.filter(function(fn){return fn!==callback;});};});_defineProperty(this,\"notifyWatch\",function(){var namePath=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];// No need to cost perf when nothing need to watch\nif(_this.watchList.length){var values=_this.getFieldsValue();var allValues=_this.getFieldsValue(true);_this.watchList.forEach(function(callback){callback(values,allValues,namePath);});}});// ========================== Dev Warning =========================\n_defineProperty(this,\"timeoutId\",null);_defineProperty(this,\"warningUnhooked\",function(){if(process.env.NODE_ENV!=='production'&&!_this.timeoutId&&typeof window!=='undefined'){_this.timeoutId=setTimeout(function(){_this.timeoutId=null;if(!_this.formHooked){warning(false,'Instance created by `useForm` is not connected to any Form element. Forget to pass `form` prop?');}});}});// ============================ Store =============================\n_defineProperty(this,\"updateStore\",function(nextStore){_this.store=nextStore;});// ============================ Fields ============================\n/**\n   * Get registered field entities.\n   * @param pure Only return field which has a `name`. Default: false\n   */_defineProperty(this,\"getFieldEntities\",function(){var pure=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!pure){return _this.fieldEntities;}return _this.fieldEntities.filter(function(field){return field.getNamePath().length;});});_defineProperty(this,\"getFieldsMap\",function(){var pure=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var cache=new NameMap();_this.getFieldEntities(pure).forEach(function(field){var namePath=field.getNamePath();cache.set(namePath,field);});return cache;});_defineProperty(this,\"getFieldEntitiesForNamePathList\",function(nameList){if(!nameList){return _this.getFieldEntities(true);}var cache=_this.getFieldsMap(true);return nameList.map(function(name){var namePath=getNamePath(name);return cache.get(namePath)||{INVALIDATE_NAME_PATH:getNamePath(name)};});});_defineProperty(this,\"getFieldsValue\",function(nameList,filterFunc){_this.warningUnhooked();// Fill args\nvar mergedNameList;var mergedFilterFunc;var mergedStrict;if(nameList===true||Array.isArray(nameList)){mergedNameList=nameList;mergedFilterFunc=filterFunc;}else if(nameList&&_typeof(nameList)==='object'){mergedStrict=nameList.strict;mergedFilterFunc=nameList.filter;}if(mergedNameList===true&&!mergedFilterFunc){return _this.store;}var fieldEntities=_this.getFieldEntitiesForNamePathList(Array.isArray(mergedNameList)?mergedNameList:null);var filteredNameList=[];fieldEntities.forEach(function(entity){var _isListField,_ref3;var namePath='INVALIDATE_NAME_PATH'in entity?entity.INVALIDATE_NAME_PATH:entity.getNamePath();// Ignore when it's a list item and not specific the namePath,\n// since parent field is already take in count\nif(mergedStrict){var _isList,_ref2;if((_isList=(_ref2=entity).isList)!==null&&_isList!==void 0&&_isList.call(_ref2)){return;}}else if(!mergedNameList&&(_isListField=(_ref3=entity).isListField)!==null&&_isListField!==void 0&&_isListField.call(_ref3)){return;}if(!mergedFilterFunc){filteredNameList.push(namePath);}else{var meta='getMeta'in entity?entity.getMeta():null;if(mergedFilterFunc(meta)){filteredNameList.push(namePath);}}});return cloneByNamePathList(_this.store,filteredNameList.map(getNamePath));});_defineProperty(this,\"getFieldValue\",function(name){_this.warningUnhooked();var namePath=getNamePath(name);return getValue(_this.store,namePath);});_defineProperty(this,\"getFieldsError\",function(nameList){_this.warningUnhooked();var fieldEntities=_this.getFieldEntitiesForNamePathList(nameList);return fieldEntities.map(function(entity,index){if(entity&&!('INVALIDATE_NAME_PATH'in entity)){return{name:entity.getNamePath(),errors:entity.getErrors(),warnings:entity.getWarnings()};}return{name:getNamePath(nameList[index]),errors:[],warnings:[]};});});_defineProperty(this,\"getFieldError\",function(name){_this.warningUnhooked();var namePath=getNamePath(name);var fieldError=_this.getFieldsError([namePath])[0];return fieldError.errors;});_defineProperty(this,\"getFieldWarning\",function(name){_this.warningUnhooked();var namePath=getNamePath(name);var fieldError=_this.getFieldsError([namePath])[0];return fieldError.warnings;});_defineProperty(this,\"isFieldsTouched\",function(){_this.warningUnhooked();for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}var arg0=args[0],arg1=args[1];var namePathList;var isAllFieldsTouched=false;if(args.length===0){namePathList=null;}else if(args.length===1){if(Array.isArray(arg0)){namePathList=arg0.map(getNamePath);isAllFieldsTouched=false;}else{namePathList=null;isAllFieldsTouched=arg0;}}else{namePathList=arg0.map(getNamePath);isAllFieldsTouched=arg1;}var fieldEntities=_this.getFieldEntities(true);var isFieldTouched=function isFieldTouched(field){return field.isFieldTouched();};// ===== Will get fully compare when not config namePathList =====\nif(!namePathList){return isAllFieldsTouched?fieldEntities.every(function(entity){return isFieldTouched(entity)||entity.isList();}):fieldEntities.some(isFieldTouched);}// Generate a nest tree for validate\nvar map=new NameMap();namePathList.forEach(function(shortNamePath){map.set(shortNamePath,[]);});fieldEntities.forEach(function(field){var fieldNamePath=field.getNamePath();// Find matched entity and put into list\nnamePathList.forEach(function(shortNamePath){if(shortNamePath.every(function(nameUnit,i){return fieldNamePath[i]===nameUnit;})){map.update(shortNamePath,function(list){return[].concat(_toConsumableArray(list),[field]);});}});});// Check if NameMap value is touched\nvar isNamePathListTouched=function isNamePathListTouched(entities){return entities.some(isFieldTouched);};var namePathListEntities=map.map(function(_ref4){var value=_ref4.value;return value;});return isAllFieldsTouched?namePathListEntities.every(isNamePathListTouched):namePathListEntities.some(isNamePathListTouched);});_defineProperty(this,\"isFieldTouched\",function(name){_this.warningUnhooked();return _this.isFieldsTouched([name]);});_defineProperty(this,\"isFieldsValidating\",function(nameList){_this.warningUnhooked();var fieldEntities=_this.getFieldEntities();if(!nameList){return fieldEntities.some(function(testField){return testField.isFieldValidating();});}var namePathList=nameList.map(getNamePath);return fieldEntities.some(function(testField){var fieldNamePath=testField.getNamePath();return containsNamePath(namePathList,fieldNamePath)&&testField.isFieldValidating();});});_defineProperty(this,\"isFieldValidating\",function(name){_this.warningUnhooked();return _this.isFieldsValidating([name]);});/**\n   * Reset Field with field `initialValue` prop.\n   * Can pass `entities` or `namePathList` or just nothing.\n   */_defineProperty(this,\"resetWithFieldInitialValue\",function(){var info=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};// Create cache\nvar cache=new NameMap();var fieldEntities=_this.getFieldEntities(true);fieldEntities.forEach(function(field){var initialValue=field.props.initialValue;var namePath=field.getNamePath();// Record only if has `initialValue`\nif(initialValue!==undefined){var records=cache.get(namePath)||new Set();records.add({entity:field,value:initialValue});cache.set(namePath,records);}});// Reset\nvar resetWithFields=function resetWithFields(entities){entities.forEach(function(field){var initialValue=field.props.initialValue;if(initialValue!==undefined){var namePath=field.getNamePath();var formInitialValue=_this.getInitialValue(namePath);if(formInitialValue!==undefined){// Warning if conflict with form initialValues and do not modify value\nwarning(false,\"Form already set 'initialValues' with path '\".concat(namePath.join('.'),\"'. Field can not overwrite it.\"));}else{var records=cache.get(namePath);if(records&&records.size>1){// Warning if multiple field set `initialValue`and do not modify value\nwarning(false,\"Multiple Field with path '\".concat(namePath.join('.'),\"' set 'initialValue'. Can not decide which one to pick.\"));}else if(records){var originValue=_this.getFieldValue(namePath);var isListField=field.isListField();// Set `initialValue`\nif(!isListField&&(!info.skipExist||originValue===undefined)){_this.updateStore(setValue(_this.store,namePath,_toConsumableArray(records)[0].value));}}}}});};var requiredFieldEntities;if(info.entities){requiredFieldEntities=info.entities;}else if(info.namePathList){requiredFieldEntities=[];info.namePathList.forEach(function(namePath){var records=cache.get(namePath);if(records){var _requiredFieldEntitie;(_requiredFieldEntitie=requiredFieldEntities).push.apply(_requiredFieldEntitie,_toConsumableArray(_toConsumableArray(records).map(function(r){return r.entity;})));}});}else{requiredFieldEntities=fieldEntities;}resetWithFields(requiredFieldEntities);});_defineProperty(this,\"resetFields\",function(nameList){_this.warningUnhooked();var prevStore=_this.store;if(!nameList){_this.updateStore(merge(_this.initialValues));_this.resetWithFieldInitialValue();_this.notifyObservers(prevStore,null,{type:'reset'});_this.notifyWatch();return;}// Reset by `nameList`\nvar namePathList=nameList.map(getNamePath);namePathList.forEach(function(namePath){var initialValue=_this.getInitialValue(namePath);_this.updateStore(setValue(_this.store,namePath,initialValue));});_this.resetWithFieldInitialValue({namePathList:namePathList});_this.notifyObservers(prevStore,namePathList,{type:'reset'});_this.notifyWatch(namePathList);});_defineProperty(this,\"setFields\",function(fields){_this.warningUnhooked();var prevStore=_this.store;var namePathList=[];fields.forEach(function(fieldData){var name=fieldData.name,data=_objectWithoutProperties(fieldData,_excluded);var namePath=getNamePath(name);namePathList.push(namePath);// Value\nif('value'in data){_this.updateStore(setValue(_this.store,namePath,data.value));}_this.notifyObservers(prevStore,[namePath],{type:'setField',data:fieldData});});_this.notifyWatch(namePathList);});_defineProperty(this,\"getFields\",function(){var entities=_this.getFieldEntities(true);var fields=entities.map(function(field){var namePath=field.getNamePath();var meta=field.getMeta();var fieldData=_objectSpread(_objectSpread({},meta),{},{name:namePath,value:_this.getFieldValue(namePath)});Object.defineProperty(fieldData,'originRCField',{value:true});return fieldData;});return fields;});// =========================== Observer ===========================\n/**\n   * This only trigger when a field is on constructor to avoid we get initialValue too late\n   */_defineProperty(this,\"initEntityValue\",function(entity){var initialValue=entity.props.initialValue;if(initialValue!==undefined){var namePath=entity.getNamePath();var prevValue=getValue(_this.store,namePath);if(prevValue===undefined){_this.updateStore(setValue(_this.store,namePath,initialValue));}}});_defineProperty(this,\"isMergedPreserve\",function(fieldPreserve){var mergedPreserve=fieldPreserve!==undefined?fieldPreserve:_this.preserve;return mergedPreserve!==null&&mergedPreserve!==void 0?mergedPreserve:true;});_defineProperty(this,\"registerField\",function(entity){_this.fieldEntities.push(entity);var namePath=entity.getNamePath();_this.notifyWatch([namePath]);// Set initial values\nif(entity.props.initialValue!==undefined){var prevStore=_this.store;_this.resetWithFieldInitialValue({entities:[entity],skipExist:true});_this.notifyObservers(prevStore,[entity.getNamePath()],{type:'valueUpdate',source:'internal'});}// un-register field callback\nreturn function(isListField,preserve){var subNamePath=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];_this.fieldEntities=_this.fieldEntities.filter(function(item){return item!==entity;});// Clean up store value if not preserve\nif(!_this.isMergedPreserve(preserve)&&(!isListField||subNamePath.length>1)){var defaultValue=isListField?undefined:_this.getInitialValue(namePath);if(namePath.length&&_this.getFieldValue(namePath)!==defaultValue&&_this.fieldEntities.every(function(field){return(// Only reset when no namePath exist\n!matchNamePath(field.getNamePath(),namePath));})){var _prevStore=_this.store;_this.updateStore(setValue(_prevStore,namePath,defaultValue,true));// Notify that field is unmount\n_this.notifyObservers(_prevStore,[namePath],{type:'remove'});// Dependencies update\n_this.triggerDependenciesUpdate(_prevStore,namePath);}}_this.notifyWatch([namePath]);};});_defineProperty(this,\"dispatch\",function(action){switch(action.type){case'updateValue':{var namePath=action.namePath,value=action.value;_this.updateValue(namePath,value);break;}case'validateField':{var _namePath=action.namePath,triggerName=action.triggerName;_this.validateFields([_namePath],{triggerName:triggerName});break;}default:// Currently we don't have other action. Do nothing.\n}});_defineProperty(this,\"notifyObservers\",function(prevStore,namePathList,info){if(_this.subscribable){var mergedInfo=_objectSpread(_objectSpread({},info),{},{store:_this.getFieldsValue(true)});_this.getFieldEntities().forEach(function(_ref5){var onStoreChange=_ref5.onStoreChange;onStoreChange(prevStore,namePathList,mergedInfo);});}else{_this.forceRootUpdate();}});/**\n   * Notify dependencies children with parent update\n   * We need delay to trigger validate in case Field is under render props\n   */_defineProperty(this,\"triggerDependenciesUpdate\",function(prevStore,namePath){var childrenFields=_this.getDependencyChildrenFields(namePath);if(childrenFields.length){_this.validateFields(childrenFields);}_this.notifyObservers(prevStore,childrenFields,{type:'dependenciesUpdate',relatedFields:[namePath].concat(_toConsumableArray(childrenFields))});return childrenFields;});_defineProperty(this,\"updateValue\",function(name,value){var namePath=getNamePath(name);var prevStore=_this.store;_this.updateStore(setValue(_this.store,namePath,value));_this.notifyObservers(prevStore,[namePath],{type:'valueUpdate',source:'internal'});_this.notifyWatch([namePath]);// Dependencies update\nvar childrenFields=_this.triggerDependenciesUpdate(prevStore,namePath);// trigger callback function\nvar onValuesChange=_this.callbacks.onValuesChange;if(onValuesChange){var changedValues=cloneByNamePathList(_this.store,[namePath]);onValuesChange(changedValues,_this.getFieldsValue());}_this.triggerOnFieldsChange([namePath].concat(_toConsumableArray(childrenFields)));});// Let all child Field get update.\n_defineProperty(this,\"setFieldsValue\",function(store){_this.warningUnhooked();var prevStore=_this.store;if(store){var nextStore=merge(_this.store,store);_this.updateStore(nextStore);}_this.notifyObservers(prevStore,null,{type:'valueUpdate',source:'external'});_this.notifyWatch();});_defineProperty(this,\"setFieldValue\",function(name,value){_this.setFields([{name:name,value:value}]);});_defineProperty(this,\"getDependencyChildrenFields\",function(rootNamePath){var children=new Set();var childrenFields=[];var dependencies2fields=new NameMap();/**\n     * Generate maps\n     * Can use cache to save perf if user report performance issue with this\n     */_this.getFieldEntities().forEach(function(field){var dependencies=field.props.dependencies;(dependencies||[]).forEach(function(dependency){var dependencyNamePath=getNamePath(dependency);dependencies2fields.update(dependencyNamePath,function(){var fields=arguments.length>0&&arguments[0]!==undefined?arguments[0]:new Set();fields.add(field);return fields;});});});var fillChildren=function fillChildren(namePath){var fields=dependencies2fields.get(namePath)||new Set();fields.forEach(function(field){if(!children.has(field)){children.add(field);var fieldNamePath=field.getNamePath();if(field.isFieldDirty()&&fieldNamePath.length){childrenFields.push(fieldNamePath);fillChildren(fieldNamePath);}}});};fillChildren(rootNamePath);return childrenFields;});_defineProperty(this,\"triggerOnFieldsChange\",function(namePathList,filedErrors){var onFieldsChange=_this.callbacks.onFieldsChange;if(onFieldsChange){var fields=_this.getFields();/**\n       * Fill errors since `fields` may be replaced by controlled fields\n       */if(filedErrors){var cache=new NameMap();filedErrors.forEach(function(_ref6){var name=_ref6.name,errors=_ref6.errors;cache.set(name,errors);});fields.forEach(function(field){// eslint-disable-next-line no-param-reassign\nfield.errors=cache.get(field.name)||field.errors;});}var changedFields=fields.filter(function(_ref7){var fieldName=_ref7.name;return containsNamePath(namePathList,fieldName);});if(changedFields.length){onFieldsChange(changedFields,fields);}}});// =========================== Validate ===========================\n_defineProperty(this,\"validateFields\",function(arg1,arg2){_this.warningUnhooked();var nameList;var options;if(Array.isArray(arg1)||typeof arg1==='string'||typeof arg2==='string'){nameList=arg1;options=arg2;}else{options=arg1;}var provideNameList=!!nameList;var namePathList=provideNameList?nameList.map(getNamePath):[];// Collect result in promise list\nvar promiseList=[];// We temp save the path which need trigger for `onFieldsChange`\nvar TMP_SPLIT=String(Date.now());var validateNamePathList=new Set();var _ref8=options||{},recursive=_ref8.recursive,dirty=_ref8.dirty;_this.getFieldEntities(true).forEach(function(field){// Add field if not provide `nameList`\nif(!provideNameList){namePathList.push(field.getNamePath());}// Skip if without rule\nif(!field.props.rules||!field.props.rules.length){return;}// Skip if only validate dirty field\nif(dirty&&!field.isFieldDirty()){return;}var fieldNamePath=field.getNamePath();validateNamePathList.add(fieldNamePath.join(TMP_SPLIT));// Add field validate rule in to promise list\nif(!provideNameList||containsNamePath(namePathList,fieldNamePath,recursive)){var promise=field.validateRules(_objectSpread({validateMessages:_objectSpread(_objectSpread({},defaultValidateMessages),_this.validateMessages)},options));// Wrap promise with field\npromiseList.push(promise.then(function(){return{name:fieldNamePath,errors:[],warnings:[]};}).catch(function(ruleErrors){var _ruleErrors$forEach;var mergedErrors=[];var mergedWarnings=[];(_ruleErrors$forEach=ruleErrors.forEach)===null||_ruleErrors$forEach===void 0||_ruleErrors$forEach.call(ruleErrors,function(_ref9){var warningOnly=_ref9.rule.warningOnly,errors=_ref9.errors;if(warningOnly){mergedWarnings.push.apply(mergedWarnings,_toConsumableArray(errors));}else{mergedErrors.push.apply(mergedErrors,_toConsumableArray(errors));}});if(mergedErrors.length){return Promise.reject({name:fieldNamePath,errors:mergedErrors,warnings:mergedWarnings});}return{name:fieldNamePath,errors:mergedErrors,warnings:mergedWarnings};}));}});var summaryPromise=allPromiseFinish(promiseList);_this.lastValidatePromise=summaryPromise;// Notify fields with rule that validate has finished and need update\nsummaryPromise.catch(function(results){return results;}).then(function(results){var resultNamePathList=results.map(function(_ref10){var name=_ref10.name;return name;});_this.notifyObservers(_this.store,resultNamePathList,{type:'validateFinish'});_this.triggerOnFieldsChange(resultNamePathList,results);});var returnPromise=summaryPromise.then(function(){if(_this.lastValidatePromise===summaryPromise){return Promise.resolve(_this.getFieldsValue(namePathList));}return Promise.reject([]);}).catch(function(results){var errorList=results.filter(function(result){return result&&result.errors.length;});return Promise.reject({values:_this.getFieldsValue(namePathList),errorFields:errorList,outOfDate:_this.lastValidatePromise!==summaryPromise});});// Do not throw in console\nreturnPromise.catch(function(e){return e;});// `validating` changed. Trigger `onFieldsChange`\nvar triggerNamePathList=namePathList.filter(function(namePath){return validateNamePathList.has(namePath.join(TMP_SPLIT));});_this.triggerOnFieldsChange(triggerNamePathList);return returnPromise;});// ============================ Submit ============================\n_defineProperty(this,\"submit\",function(){_this.warningUnhooked();_this.validateFields().then(function(values){var onFinish=_this.callbacks.onFinish;if(onFinish){try{onFinish(values);}catch(err){// Should print error if user `onFinish` callback failed\nconsole.error(err);}}}).catch(function(e){var onFinishFailed=_this.callbacks.onFinishFailed;if(onFinishFailed){onFinishFailed(e);}});});this.forceRootUpdate=forceRootUpdate;});function useForm(form){var formRef=React.useRef();var _React$useState=React.useState({}),_React$useState2=_slicedToArray(_React$useState,2),forceUpdate=_React$useState2[1];if(!formRef.current){if(form){formRef.current=form;}else{// Create a new FormStore if not provided\nvar forceReRender=function forceReRender(){forceUpdate({});};var formStore=new FormStore(forceReRender);formRef.current=formStore.getForm();}}return[formRef.current];}export default useForm;","map":{"version":3,"names":["_slicedToArray","_objectSpread","_objectWithoutProperties","_toConsumableArray","_typeof","_createClass","_classCallCheck","_defineProperty","_excluded","merge","warning","React","HOOK_MARK","allPromiseFinish","defaultValidateMessages","NameMap","cloneByNamePathList","containsNamePath","getNamePath","getValue","matchNamePath","setValue","FormStore","forceRootUpdate","_this","getFieldValue","getFieldsValue","getFieldError","getFieldWarning","getFieldsError","isFieldsTouched","isFieldTouched","isFieldValidating","isFieldsValidating","resetFields","setFields","setFieldValue","setFieldsValue","validateFields","submit","_init","getInternalHooks","key","formHooked","dispatch","initEntityValue","registerField","useSubscribe","setInitialValues","destroyForm","setCallbacks","setValidateMessages","getFields","setPreserve","getInitialValue","registerWatch","subscribable","initialValues","init","_this$prevWithoutPres","nextStore","store","prevWithoutPreserves","map","_ref","namePath","updateStore","getFieldEntities","forEach","entity","isMergedPreserve","isPreserve","set","initValue","length","callbacks","validateMessages","preserve","callback","watchList","push","filter","fn","arguments","undefined","values","allValues","process","env","NODE_ENV","timeoutId","window","setTimeout","pure","fieldEntities","field","cache","nameList","getFieldsMap","name","get","INVALIDATE_NAME_PATH","filterFunc","warningUnhooked","mergedNameList","mergedFilterFunc","mergedStrict","Array","isArray","strict","getFieldEntitiesForNamePathList","filteredNameList","_isListField","_ref3","_isList","_ref2","isList","call","isListField","meta","getMeta","index","errors","getErrors","warnings","getWarnings","fieldError","_len","args","_key","arg0","arg1","namePathList","isAllFieldsTouched","every","some","shortNamePath","fieldNamePath","nameUnit","i","update","list","concat","isNamePathListTouched","entities","namePathListEntities","_ref4","value","testField","info","initialValue","props","records","Set","add","resetWithFields","formInitialValue","join","size","originValue","skipExist","requiredFieldEntities","_requiredFieldEntitie","apply","r","prevStore","resetWithFieldInitialValue","notifyObservers","type","notifyWatch","fields","fieldData","data","Object","defineProperty","prevValue","fieldPreserve","mergedPreserve","source","subNamePath","item","defaultValue","_prevStore","triggerDependenciesUpdate","action","updateValue","_namePath","triggerName","mergedInfo","_ref5","onStoreChange","childrenFields","getDependencyChildrenFields","relatedFields","onValuesChange","changedValues","triggerOnFieldsChange","rootNamePath","children","dependencies2fields","dependencies","dependency","dependencyNamePath","fillChildren","has","isFieldDirty","filedErrors","onFieldsChange","_ref6","changedFields","_ref7","fieldName","arg2","options","provideNameList","promiseList","TMP_SPLIT","String","Date","now","validateNamePathList","_ref8","recursive","dirty","rules","promise","validateRules","then","catch","ruleErrors","_ruleErrors$forEach","mergedErrors","mergedWarnings","_ref9","warningOnly","rule","Promise","reject","summaryPromise","lastValidatePromise","results","resultNamePathList","_ref10","returnPromise","resolve","errorList","result","errorFields","outOfDate","e","triggerNamePathList","onFinish","err","console","error","onFinishFailed","useForm","form","formRef","useRef","_React$useState","useState","_React$useState2","forceUpdate","current","forceReRender","formStore","getForm"],"sources":["/Users/jmmallon/Downloads/js/ticketproject/src/node_modules/rc-field-form/es/useForm.js"],"sourcesContent":["import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _excluded = [\"name\"];\nimport { merge } from \"rc-util/es/utils/set\";\nimport warning from \"rc-util/es/warning\";\nimport * as React from 'react';\nimport { HOOK_MARK } from \"./FieldContext\";\nimport { allPromiseFinish } from \"./utils/asyncUtil\";\nimport { defaultValidateMessages } from \"./utils/messages\";\nimport NameMap from \"./utils/NameMap\";\nimport { cloneByNamePathList, containsNamePath, getNamePath, getValue, matchNamePath, setValue } from \"./utils/valueUtil\";\nexport var FormStore = /*#__PURE__*/_createClass(function FormStore(forceRootUpdate) {\n  var _this = this;\n  _classCallCheck(this, FormStore);\n  _defineProperty(this, \"formHooked\", false);\n  _defineProperty(this, \"forceRootUpdate\", void 0);\n  _defineProperty(this, \"subscribable\", true);\n  _defineProperty(this, \"store\", {});\n  _defineProperty(this, \"fieldEntities\", []);\n  _defineProperty(this, \"initialValues\", {});\n  _defineProperty(this, \"callbacks\", {});\n  _defineProperty(this, \"validateMessages\", null);\n  _defineProperty(this, \"preserve\", null);\n  _defineProperty(this, \"lastValidatePromise\", null);\n  _defineProperty(this, \"getForm\", function () {\n    return {\n      getFieldValue: _this.getFieldValue,\n      getFieldsValue: _this.getFieldsValue,\n      getFieldError: _this.getFieldError,\n      getFieldWarning: _this.getFieldWarning,\n      getFieldsError: _this.getFieldsError,\n      isFieldsTouched: _this.isFieldsTouched,\n      isFieldTouched: _this.isFieldTouched,\n      isFieldValidating: _this.isFieldValidating,\n      isFieldsValidating: _this.isFieldsValidating,\n      resetFields: _this.resetFields,\n      setFields: _this.setFields,\n      setFieldValue: _this.setFieldValue,\n      setFieldsValue: _this.setFieldsValue,\n      validateFields: _this.validateFields,\n      submit: _this.submit,\n      _init: true,\n      getInternalHooks: _this.getInternalHooks\n    };\n  });\n  // ======================== Internal Hooks ========================\n  _defineProperty(this, \"getInternalHooks\", function (key) {\n    if (key === HOOK_MARK) {\n      _this.formHooked = true;\n      return {\n        dispatch: _this.dispatch,\n        initEntityValue: _this.initEntityValue,\n        registerField: _this.registerField,\n        useSubscribe: _this.useSubscribe,\n        setInitialValues: _this.setInitialValues,\n        destroyForm: _this.destroyForm,\n        setCallbacks: _this.setCallbacks,\n        setValidateMessages: _this.setValidateMessages,\n        getFields: _this.getFields,\n        setPreserve: _this.setPreserve,\n        getInitialValue: _this.getInitialValue,\n        registerWatch: _this.registerWatch\n      };\n    }\n    warning(false, '`getInternalHooks` is internal usage. Should not call directly.');\n    return null;\n  });\n  _defineProperty(this, \"useSubscribe\", function (subscribable) {\n    _this.subscribable = subscribable;\n  });\n  /**\n   * Record prev Form unmount fieldEntities which config preserve false.\n   * This need to be refill with initialValues instead of store value.\n   */\n  _defineProperty(this, \"prevWithoutPreserves\", null);\n  /**\n   * First time `setInitialValues` should update store with initial value\n   */\n  _defineProperty(this, \"setInitialValues\", function (initialValues, init) {\n    _this.initialValues = initialValues || {};\n    if (init) {\n      var _this$prevWithoutPres;\n      var nextStore = merge(initialValues, _this.store);\n\n      // We will take consider prev form unmount fields.\n      // When the field is not `preserve`, we need fill this with initialValues instead of store.\n      // eslint-disable-next-line array-callback-return\n      (_this$prevWithoutPres = _this.prevWithoutPreserves) === null || _this$prevWithoutPres === void 0 || _this$prevWithoutPres.map(function (_ref) {\n        var namePath = _ref.key;\n        nextStore = setValue(nextStore, namePath, getValue(initialValues, namePath));\n      });\n      _this.prevWithoutPreserves = null;\n      _this.updateStore(nextStore);\n    }\n  });\n  _defineProperty(this, \"destroyForm\", function () {\n    var prevWithoutPreserves = new NameMap();\n    _this.getFieldEntities(true).forEach(function (entity) {\n      if (!_this.isMergedPreserve(entity.isPreserve())) {\n        prevWithoutPreserves.set(entity.getNamePath(), true);\n      }\n    });\n    _this.prevWithoutPreserves = prevWithoutPreserves;\n  });\n  _defineProperty(this, \"getInitialValue\", function (namePath) {\n    var initValue = getValue(_this.initialValues, namePath);\n\n    // Not cloneDeep when without `namePath`\n    return namePath.length ? merge(initValue) : initValue;\n  });\n  _defineProperty(this, \"setCallbacks\", function (callbacks) {\n    _this.callbacks = callbacks;\n  });\n  _defineProperty(this, \"setValidateMessages\", function (validateMessages) {\n    _this.validateMessages = validateMessages;\n  });\n  _defineProperty(this, \"setPreserve\", function (preserve) {\n    _this.preserve = preserve;\n  });\n  // ============================= Watch ============================\n  _defineProperty(this, \"watchList\", []);\n  _defineProperty(this, \"registerWatch\", function (callback) {\n    _this.watchList.push(callback);\n    return function () {\n      _this.watchList = _this.watchList.filter(function (fn) {\n        return fn !== callback;\n      });\n    };\n  });\n  _defineProperty(this, \"notifyWatch\", function () {\n    var namePath = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    // No need to cost perf when nothing need to watch\n    if (_this.watchList.length) {\n      var values = _this.getFieldsValue();\n      var allValues = _this.getFieldsValue(true);\n      _this.watchList.forEach(function (callback) {\n        callback(values, allValues, namePath);\n      });\n    }\n  });\n  // ========================== Dev Warning =========================\n  _defineProperty(this, \"timeoutId\", null);\n  _defineProperty(this, \"warningUnhooked\", function () {\n    if (process.env.NODE_ENV !== 'production' && !_this.timeoutId && typeof window !== 'undefined') {\n      _this.timeoutId = setTimeout(function () {\n        _this.timeoutId = null;\n        if (!_this.formHooked) {\n          warning(false, 'Instance created by `useForm` is not connected to any Form element. Forget to pass `form` prop?');\n        }\n      });\n    }\n  });\n  // ============================ Store =============================\n  _defineProperty(this, \"updateStore\", function (nextStore) {\n    _this.store = nextStore;\n  });\n  // ============================ Fields ============================\n  /**\n   * Get registered field entities.\n   * @param pure Only return field which has a `name`. Default: false\n   */\n  _defineProperty(this, \"getFieldEntities\", function () {\n    var pure = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    if (!pure) {\n      return _this.fieldEntities;\n    }\n    return _this.fieldEntities.filter(function (field) {\n      return field.getNamePath().length;\n    });\n  });\n  _defineProperty(this, \"getFieldsMap\", function () {\n    var pure = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    var cache = new NameMap();\n    _this.getFieldEntities(pure).forEach(function (field) {\n      var namePath = field.getNamePath();\n      cache.set(namePath, field);\n    });\n    return cache;\n  });\n  _defineProperty(this, \"getFieldEntitiesForNamePathList\", function (nameList) {\n    if (!nameList) {\n      return _this.getFieldEntities(true);\n    }\n    var cache = _this.getFieldsMap(true);\n    return nameList.map(function (name) {\n      var namePath = getNamePath(name);\n      return cache.get(namePath) || {\n        INVALIDATE_NAME_PATH: getNamePath(name)\n      };\n    });\n  });\n  _defineProperty(this, \"getFieldsValue\", function (nameList, filterFunc) {\n    _this.warningUnhooked();\n\n    // Fill args\n    var mergedNameList;\n    var mergedFilterFunc;\n    var mergedStrict;\n    if (nameList === true || Array.isArray(nameList)) {\n      mergedNameList = nameList;\n      mergedFilterFunc = filterFunc;\n    } else if (nameList && _typeof(nameList) === 'object') {\n      mergedStrict = nameList.strict;\n      mergedFilterFunc = nameList.filter;\n    }\n    if (mergedNameList === true && !mergedFilterFunc) {\n      return _this.store;\n    }\n    var fieldEntities = _this.getFieldEntitiesForNamePathList(Array.isArray(mergedNameList) ? mergedNameList : null);\n    var filteredNameList = [];\n    fieldEntities.forEach(function (entity) {\n      var _isListField, _ref3;\n      var namePath = 'INVALIDATE_NAME_PATH' in entity ? entity.INVALIDATE_NAME_PATH : entity.getNamePath();\n\n      // Ignore when it's a list item and not specific the namePath,\n      // since parent field is already take in count\n      if (mergedStrict) {\n        var _isList, _ref2;\n        if ((_isList = (_ref2 = entity).isList) !== null && _isList !== void 0 && _isList.call(_ref2)) {\n          return;\n        }\n      } else if (!mergedNameList && (_isListField = (_ref3 = entity).isListField) !== null && _isListField !== void 0 && _isListField.call(_ref3)) {\n        return;\n      }\n      if (!mergedFilterFunc) {\n        filteredNameList.push(namePath);\n      } else {\n        var meta = 'getMeta' in entity ? entity.getMeta() : null;\n        if (mergedFilterFunc(meta)) {\n          filteredNameList.push(namePath);\n        }\n      }\n    });\n    return cloneByNamePathList(_this.store, filteredNameList.map(getNamePath));\n  });\n  _defineProperty(this, \"getFieldValue\", function (name) {\n    _this.warningUnhooked();\n    var namePath = getNamePath(name);\n    return getValue(_this.store, namePath);\n  });\n  _defineProperty(this, \"getFieldsError\", function (nameList) {\n    _this.warningUnhooked();\n    var fieldEntities = _this.getFieldEntitiesForNamePathList(nameList);\n    return fieldEntities.map(function (entity, index) {\n      if (entity && !('INVALIDATE_NAME_PATH' in entity)) {\n        return {\n          name: entity.getNamePath(),\n          errors: entity.getErrors(),\n          warnings: entity.getWarnings()\n        };\n      }\n      return {\n        name: getNamePath(nameList[index]),\n        errors: [],\n        warnings: []\n      };\n    });\n  });\n  _defineProperty(this, \"getFieldError\", function (name) {\n    _this.warningUnhooked();\n    var namePath = getNamePath(name);\n    var fieldError = _this.getFieldsError([namePath])[0];\n    return fieldError.errors;\n  });\n  _defineProperty(this, \"getFieldWarning\", function (name) {\n    _this.warningUnhooked();\n    var namePath = getNamePath(name);\n    var fieldError = _this.getFieldsError([namePath])[0];\n    return fieldError.warnings;\n  });\n  _defineProperty(this, \"isFieldsTouched\", function () {\n    _this.warningUnhooked();\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    var arg0 = args[0],\n      arg1 = args[1];\n    var namePathList;\n    var isAllFieldsTouched = false;\n    if (args.length === 0) {\n      namePathList = null;\n    } else if (args.length === 1) {\n      if (Array.isArray(arg0)) {\n        namePathList = arg0.map(getNamePath);\n        isAllFieldsTouched = false;\n      } else {\n        namePathList = null;\n        isAllFieldsTouched = arg0;\n      }\n    } else {\n      namePathList = arg0.map(getNamePath);\n      isAllFieldsTouched = arg1;\n    }\n    var fieldEntities = _this.getFieldEntities(true);\n    var isFieldTouched = function isFieldTouched(field) {\n      return field.isFieldTouched();\n    };\n\n    // ===== Will get fully compare when not config namePathList =====\n    if (!namePathList) {\n      return isAllFieldsTouched ? fieldEntities.every(function (entity) {\n        return isFieldTouched(entity) || entity.isList();\n      }) : fieldEntities.some(isFieldTouched);\n    }\n\n    // Generate a nest tree for validate\n    var map = new NameMap();\n    namePathList.forEach(function (shortNamePath) {\n      map.set(shortNamePath, []);\n    });\n    fieldEntities.forEach(function (field) {\n      var fieldNamePath = field.getNamePath();\n\n      // Find matched entity and put into list\n      namePathList.forEach(function (shortNamePath) {\n        if (shortNamePath.every(function (nameUnit, i) {\n          return fieldNamePath[i] === nameUnit;\n        })) {\n          map.update(shortNamePath, function (list) {\n            return [].concat(_toConsumableArray(list), [field]);\n          });\n        }\n      });\n    });\n\n    // Check if NameMap value is touched\n    var isNamePathListTouched = function isNamePathListTouched(entities) {\n      return entities.some(isFieldTouched);\n    };\n    var namePathListEntities = map.map(function (_ref4) {\n      var value = _ref4.value;\n      return value;\n    });\n    return isAllFieldsTouched ? namePathListEntities.every(isNamePathListTouched) : namePathListEntities.some(isNamePathListTouched);\n  });\n  _defineProperty(this, \"isFieldTouched\", function (name) {\n    _this.warningUnhooked();\n    return _this.isFieldsTouched([name]);\n  });\n  _defineProperty(this, \"isFieldsValidating\", function (nameList) {\n    _this.warningUnhooked();\n    var fieldEntities = _this.getFieldEntities();\n    if (!nameList) {\n      return fieldEntities.some(function (testField) {\n        return testField.isFieldValidating();\n      });\n    }\n    var namePathList = nameList.map(getNamePath);\n    return fieldEntities.some(function (testField) {\n      var fieldNamePath = testField.getNamePath();\n      return containsNamePath(namePathList, fieldNamePath) && testField.isFieldValidating();\n    });\n  });\n  _defineProperty(this, \"isFieldValidating\", function (name) {\n    _this.warningUnhooked();\n    return _this.isFieldsValidating([name]);\n  });\n  /**\n   * Reset Field with field `initialValue` prop.\n   * Can pass `entities` or `namePathList` or just nothing.\n   */\n  _defineProperty(this, \"resetWithFieldInitialValue\", function () {\n    var info = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    // Create cache\n    var cache = new NameMap();\n    var fieldEntities = _this.getFieldEntities(true);\n    fieldEntities.forEach(function (field) {\n      var initialValue = field.props.initialValue;\n      var namePath = field.getNamePath();\n\n      // Record only if has `initialValue`\n      if (initialValue !== undefined) {\n        var records = cache.get(namePath) || new Set();\n        records.add({\n          entity: field,\n          value: initialValue\n        });\n        cache.set(namePath, records);\n      }\n    });\n\n    // Reset\n    var resetWithFields = function resetWithFields(entities) {\n      entities.forEach(function (field) {\n        var initialValue = field.props.initialValue;\n        if (initialValue !== undefined) {\n          var namePath = field.getNamePath();\n          var formInitialValue = _this.getInitialValue(namePath);\n          if (formInitialValue !== undefined) {\n            // Warning if conflict with form initialValues and do not modify value\n            warning(false, \"Form already set 'initialValues' with path '\".concat(namePath.join('.'), \"'. Field can not overwrite it.\"));\n          } else {\n            var records = cache.get(namePath);\n            if (records && records.size > 1) {\n              // Warning if multiple field set `initialValue`and do not modify value\n              warning(false, \"Multiple Field with path '\".concat(namePath.join('.'), \"' set 'initialValue'. Can not decide which one to pick.\"));\n            } else if (records) {\n              var originValue = _this.getFieldValue(namePath);\n              var isListField = field.isListField();\n\n              // Set `initialValue`\n              if (!isListField && (!info.skipExist || originValue === undefined)) {\n                _this.updateStore(setValue(_this.store, namePath, _toConsumableArray(records)[0].value));\n              }\n            }\n          }\n        }\n      });\n    };\n    var requiredFieldEntities;\n    if (info.entities) {\n      requiredFieldEntities = info.entities;\n    } else if (info.namePathList) {\n      requiredFieldEntities = [];\n      info.namePathList.forEach(function (namePath) {\n        var records = cache.get(namePath);\n        if (records) {\n          var _requiredFieldEntitie;\n          (_requiredFieldEntitie = requiredFieldEntities).push.apply(_requiredFieldEntitie, _toConsumableArray(_toConsumableArray(records).map(function (r) {\n            return r.entity;\n          })));\n        }\n      });\n    } else {\n      requiredFieldEntities = fieldEntities;\n    }\n    resetWithFields(requiredFieldEntities);\n  });\n  _defineProperty(this, \"resetFields\", function (nameList) {\n    _this.warningUnhooked();\n    var prevStore = _this.store;\n    if (!nameList) {\n      _this.updateStore(merge(_this.initialValues));\n      _this.resetWithFieldInitialValue();\n      _this.notifyObservers(prevStore, null, {\n        type: 'reset'\n      });\n      _this.notifyWatch();\n      return;\n    }\n\n    // Reset by `nameList`\n    var namePathList = nameList.map(getNamePath);\n    namePathList.forEach(function (namePath) {\n      var initialValue = _this.getInitialValue(namePath);\n      _this.updateStore(setValue(_this.store, namePath, initialValue));\n    });\n    _this.resetWithFieldInitialValue({\n      namePathList: namePathList\n    });\n    _this.notifyObservers(prevStore, namePathList, {\n      type: 'reset'\n    });\n    _this.notifyWatch(namePathList);\n  });\n  _defineProperty(this, \"setFields\", function (fields) {\n    _this.warningUnhooked();\n    var prevStore = _this.store;\n    var namePathList = [];\n    fields.forEach(function (fieldData) {\n      var name = fieldData.name,\n        data = _objectWithoutProperties(fieldData, _excluded);\n      var namePath = getNamePath(name);\n      namePathList.push(namePath);\n\n      // Value\n      if ('value' in data) {\n        _this.updateStore(setValue(_this.store, namePath, data.value));\n      }\n      _this.notifyObservers(prevStore, [namePath], {\n        type: 'setField',\n        data: fieldData\n      });\n    });\n    _this.notifyWatch(namePathList);\n  });\n  _defineProperty(this, \"getFields\", function () {\n    var entities = _this.getFieldEntities(true);\n    var fields = entities.map(function (field) {\n      var namePath = field.getNamePath();\n      var meta = field.getMeta();\n      var fieldData = _objectSpread(_objectSpread({}, meta), {}, {\n        name: namePath,\n        value: _this.getFieldValue(namePath)\n      });\n      Object.defineProperty(fieldData, 'originRCField', {\n        value: true\n      });\n      return fieldData;\n    });\n    return fields;\n  });\n  // =========================== Observer ===========================\n  /**\n   * This only trigger when a field is on constructor to avoid we get initialValue too late\n   */\n  _defineProperty(this, \"initEntityValue\", function (entity) {\n    var initialValue = entity.props.initialValue;\n    if (initialValue !== undefined) {\n      var namePath = entity.getNamePath();\n      var prevValue = getValue(_this.store, namePath);\n      if (prevValue === undefined) {\n        _this.updateStore(setValue(_this.store, namePath, initialValue));\n      }\n    }\n  });\n  _defineProperty(this, \"isMergedPreserve\", function (fieldPreserve) {\n    var mergedPreserve = fieldPreserve !== undefined ? fieldPreserve : _this.preserve;\n    return mergedPreserve !== null && mergedPreserve !== void 0 ? mergedPreserve : true;\n  });\n  _defineProperty(this, \"registerField\", function (entity) {\n    _this.fieldEntities.push(entity);\n    var namePath = entity.getNamePath();\n    _this.notifyWatch([namePath]);\n\n    // Set initial values\n    if (entity.props.initialValue !== undefined) {\n      var prevStore = _this.store;\n      _this.resetWithFieldInitialValue({\n        entities: [entity],\n        skipExist: true\n      });\n      _this.notifyObservers(prevStore, [entity.getNamePath()], {\n        type: 'valueUpdate',\n        source: 'internal'\n      });\n    }\n\n    // un-register field callback\n    return function (isListField, preserve) {\n      var subNamePath = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n      _this.fieldEntities = _this.fieldEntities.filter(function (item) {\n        return item !== entity;\n      });\n\n      // Clean up store value if not preserve\n      if (!_this.isMergedPreserve(preserve) && (!isListField || subNamePath.length > 1)) {\n        var defaultValue = isListField ? undefined : _this.getInitialValue(namePath);\n        if (namePath.length && _this.getFieldValue(namePath) !== defaultValue && _this.fieldEntities.every(function (field) {\n          return (\n            // Only reset when no namePath exist\n            !matchNamePath(field.getNamePath(), namePath)\n          );\n        })) {\n          var _prevStore = _this.store;\n          _this.updateStore(setValue(_prevStore, namePath, defaultValue, true));\n\n          // Notify that field is unmount\n          _this.notifyObservers(_prevStore, [namePath], {\n            type: 'remove'\n          });\n\n          // Dependencies update\n          _this.triggerDependenciesUpdate(_prevStore, namePath);\n        }\n      }\n      _this.notifyWatch([namePath]);\n    };\n  });\n  _defineProperty(this, \"dispatch\", function (action) {\n    switch (action.type) {\n      case 'updateValue':\n        {\n          var namePath = action.namePath,\n            value = action.value;\n          _this.updateValue(namePath, value);\n          break;\n        }\n      case 'validateField':\n        {\n          var _namePath = action.namePath,\n            triggerName = action.triggerName;\n          _this.validateFields([_namePath], {\n            triggerName: triggerName\n          });\n          break;\n        }\n      default:\n      // Currently we don't have other action. Do nothing.\n    }\n  });\n  _defineProperty(this, \"notifyObservers\", function (prevStore, namePathList, info) {\n    if (_this.subscribable) {\n      var mergedInfo = _objectSpread(_objectSpread({}, info), {}, {\n        store: _this.getFieldsValue(true)\n      });\n      _this.getFieldEntities().forEach(function (_ref5) {\n        var onStoreChange = _ref5.onStoreChange;\n        onStoreChange(prevStore, namePathList, mergedInfo);\n      });\n    } else {\n      _this.forceRootUpdate();\n    }\n  });\n  /**\n   * Notify dependencies children with parent update\n   * We need delay to trigger validate in case Field is under render props\n   */\n  _defineProperty(this, \"triggerDependenciesUpdate\", function (prevStore, namePath) {\n    var childrenFields = _this.getDependencyChildrenFields(namePath);\n    if (childrenFields.length) {\n      _this.validateFields(childrenFields);\n    }\n    _this.notifyObservers(prevStore, childrenFields, {\n      type: 'dependenciesUpdate',\n      relatedFields: [namePath].concat(_toConsumableArray(childrenFields))\n    });\n    return childrenFields;\n  });\n  _defineProperty(this, \"updateValue\", function (name, value) {\n    var namePath = getNamePath(name);\n    var prevStore = _this.store;\n    _this.updateStore(setValue(_this.store, namePath, value));\n    _this.notifyObservers(prevStore, [namePath], {\n      type: 'valueUpdate',\n      source: 'internal'\n    });\n    _this.notifyWatch([namePath]);\n\n    // Dependencies update\n    var childrenFields = _this.triggerDependenciesUpdate(prevStore, namePath);\n\n    // trigger callback function\n    var onValuesChange = _this.callbacks.onValuesChange;\n    if (onValuesChange) {\n      var changedValues = cloneByNamePathList(_this.store, [namePath]);\n      onValuesChange(changedValues, _this.getFieldsValue());\n    }\n    _this.triggerOnFieldsChange([namePath].concat(_toConsumableArray(childrenFields)));\n  });\n  // Let all child Field get update.\n  _defineProperty(this, \"setFieldsValue\", function (store) {\n    _this.warningUnhooked();\n    var prevStore = _this.store;\n    if (store) {\n      var nextStore = merge(_this.store, store);\n      _this.updateStore(nextStore);\n    }\n    _this.notifyObservers(prevStore, null, {\n      type: 'valueUpdate',\n      source: 'external'\n    });\n    _this.notifyWatch();\n  });\n  _defineProperty(this, \"setFieldValue\", function (name, value) {\n    _this.setFields([{\n      name: name,\n      value: value\n    }]);\n  });\n  _defineProperty(this, \"getDependencyChildrenFields\", function (rootNamePath) {\n    var children = new Set();\n    var childrenFields = [];\n    var dependencies2fields = new NameMap();\n\n    /**\n     * Generate maps\n     * Can use cache to save perf if user report performance issue with this\n     */\n    _this.getFieldEntities().forEach(function (field) {\n      var dependencies = field.props.dependencies;\n      (dependencies || []).forEach(function (dependency) {\n        var dependencyNamePath = getNamePath(dependency);\n        dependencies2fields.update(dependencyNamePath, function () {\n          var fields = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Set();\n          fields.add(field);\n          return fields;\n        });\n      });\n    });\n    var fillChildren = function fillChildren(namePath) {\n      var fields = dependencies2fields.get(namePath) || new Set();\n      fields.forEach(function (field) {\n        if (!children.has(field)) {\n          children.add(field);\n          var fieldNamePath = field.getNamePath();\n          if (field.isFieldDirty() && fieldNamePath.length) {\n            childrenFields.push(fieldNamePath);\n            fillChildren(fieldNamePath);\n          }\n        }\n      });\n    };\n    fillChildren(rootNamePath);\n    return childrenFields;\n  });\n  _defineProperty(this, \"triggerOnFieldsChange\", function (namePathList, filedErrors) {\n    var onFieldsChange = _this.callbacks.onFieldsChange;\n    if (onFieldsChange) {\n      var fields = _this.getFields();\n\n      /**\n       * Fill errors since `fields` may be replaced by controlled fields\n       */\n      if (filedErrors) {\n        var cache = new NameMap();\n        filedErrors.forEach(function (_ref6) {\n          var name = _ref6.name,\n            errors = _ref6.errors;\n          cache.set(name, errors);\n        });\n        fields.forEach(function (field) {\n          // eslint-disable-next-line no-param-reassign\n          field.errors = cache.get(field.name) || field.errors;\n        });\n      }\n      var changedFields = fields.filter(function (_ref7) {\n        var fieldName = _ref7.name;\n        return containsNamePath(namePathList, fieldName);\n      });\n      if (changedFields.length) {\n        onFieldsChange(changedFields, fields);\n      }\n    }\n  });\n  // =========================== Validate ===========================\n  _defineProperty(this, \"validateFields\", function (arg1, arg2) {\n    _this.warningUnhooked();\n    var nameList;\n    var options;\n    if (Array.isArray(arg1) || typeof arg1 === 'string' || typeof arg2 === 'string') {\n      nameList = arg1;\n      options = arg2;\n    } else {\n      options = arg1;\n    }\n    var provideNameList = !!nameList;\n    var namePathList = provideNameList ? nameList.map(getNamePath) : [];\n\n    // Collect result in promise list\n    var promiseList = [];\n\n    // We temp save the path which need trigger for `onFieldsChange`\n    var TMP_SPLIT = String(Date.now());\n    var validateNamePathList = new Set();\n    var _ref8 = options || {},\n      recursive = _ref8.recursive,\n      dirty = _ref8.dirty;\n    _this.getFieldEntities(true).forEach(function (field) {\n      // Add field if not provide `nameList`\n      if (!provideNameList) {\n        namePathList.push(field.getNamePath());\n      }\n\n      // Skip if without rule\n      if (!field.props.rules || !field.props.rules.length) {\n        return;\n      }\n\n      // Skip if only validate dirty field\n      if (dirty && !field.isFieldDirty()) {\n        return;\n      }\n      var fieldNamePath = field.getNamePath();\n      validateNamePathList.add(fieldNamePath.join(TMP_SPLIT));\n\n      // Add field validate rule in to promise list\n      if (!provideNameList || containsNamePath(namePathList, fieldNamePath, recursive)) {\n        var promise = field.validateRules(_objectSpread({\n          validateMessages: _objectSpread(_objectSpread({}, defaultValidateMessages), _this.validateMessages)\n        }, options));\n\n        // Wrap promise with field\n        promiseList.push(promise.then(function () {\n          return {\n            name: fieldNamePath,\n            errors: [],\n            warnings: []\n          };\n        }).catch(function (ruleErrors) {\n          var _ruleErrors$forEach;\n          var mergedErrors = [];\n          var mergedWarnings = [];\n          (_ruleErrors$forEach = ruleErrors.forEach) === null || _ruleErrors$forEach === void 0 || _ruleErrors$forEach.call(ruleErrors, function (_ref9) {\n            var warningOnly = _ref9.rule.warningOnly,\n              errors = _ref9.errors;\n            if (warningOnly) {\n              mergedWarnings.push.apply(mergedWarnings, _toConsumableArray(errors));\n            } else {\n              mergedErrors.push.apply(mergedErrors, _toConsumableArray(errors));\n            }\n          });\n          if (mergedErrors.length) {\n            return Promise.reject({\n              name: fieldNamePath,\n              errors: mergedErrors,\n              warnings: mergedWarnings\n            });\n          }\n          return {\n            name: fieldNamePath,\n            errors: mergedErrors,\n            warnings: mergedWarnings\n          };\n        }));\n      }\n    });\n    var summaryPromise = allPromiseFinish(promiseList);\n    _this.lastValidatePromise = summaryPromise;\n\n    // Notify fields with rule that validate has finished and need update\n    summaryPromise.catch(function (results) {\n      return results;\n    }).then(function (results) {\n      var resultNamePathList = results.map(function (_ref10) {\n        var name = _ref10.name;\n        return name;\n      });\n      _this.notifyObservers(_this.store, resultNamePathList, {\n        type: 'validateFinish'\n      });\n      _this.triggerOnFieldsChange(resultNamePathList, results);\n    });\n    var returnPromise = summaryPromise.then(function () {\n      if (_this.lastValidatePromise === summaryPromise) {\n        return Promise.resolve(_this.getFieldsValue(namePathList));\n      }\n      return Promise.reject([]);\n    }).catch(function (results) {\n      var errorList = results.filter(function (result) {\n        return result && result.errors.length;\n      });\n      return Promise.reject({\n        values: _this.getFieldsValue(namePathList),\n        errorFields: errorList,\n        outOfDate: _this.lastValidatePromise !== summaryPromise\n      });\n    });\n\n    // Do not throw in console\n    returnPromise.catch(function (e) {\n      return e;\n    });\n\n    // `validating` changed. Trigger `onFieldsChange`\n    var triggerNamePathList = namePathList.filter(function (namePath) {\n      return validateNamePathList.has(namePath.join(TMP_SPLIT));\n    });\n    _this.triggerOnFieldsChange(triggerNamePathList);\n    return returnPromise;\n  });\n  // ============================ Submit ============================\n  _defineProperty(this, \"submit\", function () {\n    _this.warningUnhooked();\n    _this.validateFields().then(function (values) {\n      var onFinish = _this.callbacks.onFinish;\n      if (onFinish) {\n        try {\n          onFinish(values);\n        } catch (err) {\n          // Should print error if user `onFinish` callback failed\n          console.error(err);\n        }\n      }\n    }).catch(function (e) {\n      var onFinishFailed = _this.callbacks.onFinishFailed;\n      if (onFinishFailed) {\n        onFinishFailed(e);\n      }\n    });\n  });\n  this.forceRootUpdate = forceRootUpdate;\n});\nfunction useForm(form) {\n  var formRef = React.useRef();\n  var _React$useState = React.useState({}),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    forceUpdate = _React$useState2[1];\n  if (!formRef.current) {\n    if (form) {\n      formRef.current = form;\n    } else {\n      // Create a new FormStore if not provided\n      var forceReRender = function forceReRender() {\n        forceUpdate({});\n      };\n      var formStore = new FormStore(forceReRender);\n      formRef.current = formStore.getForm();\n    }\n  }\n  return [formRef.current];\n}\nexport default useForm;"],"mappings":"AAAA,MAAO,CAAAA,cAAc,KAAM,0CAA0C,CACrE,MAAO,CAAAC,aAAa,KAAM,0CAA0C,CACpE,MAAO,CAAAC,wBAAwB,KAAM,oDAAoD,CACzF,MAAO,CAAAC,kBAAkB,KAAM,8CAA8C,CAC7E,MAAO,CAAAC,OAAO,KAAM,mCAAmC,CACvD,MAAO,CAAAC,YAAY,KAAM,wCAAwC,CACjE,MAAO,CAAAC,eAAe,KAAM,2CAA2C,CACvE,MAAO,CAAAC,eAAe,KAAM,2CAA2C,CACvE,GAAI,CAAAC,SAAS,CAAG,CAAC,MAAM,CAAC,CACxB,OAASC,KAAK,KAAQ,sBAAsB,CAC5C,MAAO,CAAAC,OAAO,KAAM,oBAAoB,CACxC,MAAO,GAAK,CAAAC,KAAK,KAAM,OAAO,CAC9B,OAASC,SAAS,KAAQ,gBAAgB,CAC1C,OAASC,gBAAgB,KAAQ,mBAAmB,CACpD,OAASC,uBAAuB,KAAQ,kBAAkB,CAC1D,MAAO,CAAAC,OAAO,KAAM,iBAAiB,CACrC,OAASC,mBAAmB,CAAEC,gBAAgB,CAAEC,WAAW,CAAEC,QAAQ,CAAEC,aAAa,CAAEC,QAAQ,KAAQ,mBAAmB,CACzH,MAAO,IAAI,CAAAC,SAAS,CAAG,aAAajB,YAAY,CAAC,QAAS,CAAAiB,SAASA,CAACC,eAAe,CAAE,CACnF,GAAI,CAAAC,KAAK,CAAG,IAAI,CAChBlB,eAAe,CAAC,IAAI,CAAEgB,SAAS,CAAC,CAChCf,eAAe,CAAC,IAAI,CAAE,YAAY,CAAE,KAAK,CAAC,CAC1CA,eAAe,CAAC,IAAI,CAAE,iBAAiB,CAAE,IAAK,EAAC,CAAC,CAChDA,eAAe,CAAC,IAAI,CAAE,cAAc,CAAE,IAAI,CAAC,CAC3CA,eAAe,CAAC,IAAI,CAAE,OAAO,CAAE,CAAC,CAAC,CAAC,CAClCA,eAAe,CAAC,IAAI,CAAE,eAAe,CAAE,EAAE,CAAC,CAC1CA,eAAe,CAAC,IAAI,CAAE,eAAe,CAAE,CAAC,CAAC,CAAC,CAC1CA,eAAe,CAAC,IAAI,CAAE,WAAW,CAAE,CAAC,CAAC,CAAC,CACtCA,eAAe,CAAC,IAAI,CAAE,kBAAkB,CAAE,IAAI,CAAC,CAC/CA,eAAe,CAAC,IAAI,CAAE,UAAU,CAAE,IAAI,CAAC,CACvCA,eAAe,CAAC,IAAI,CAAE,qBAAqB,CAAE,IAAI,CAAC,CAClDA,eAAe,CAAC,IAAI,CAAE,SAAS,CAAE,UAAY,CAC3C,MAAO,CACLkB,aAAa,CAAED,KAAK,CAACC,aAAa,CAClCC,cAAc,CAAEF,KAAK,CAACE,cAAc,CACpCC,aAAa,CAAEH,KAAK,CAACG,aAAa,CAClCC,eAAe,CAAEJ,KAAK,CAACI,eAAe,CACtCC,cAAc,CAAEL,KAAK,CAACK,cAAc,CACpCC,eAAe,CAAEN,KAAK,CAACM,eAAe,CACtCC,cAAc,CAAEP,KAAK,CAACO,cAAc,CACpCC,iBAAiB,CAAER,KAAK,CAACQ,iBAAiB,CAC1CC,kBAAkB,CAAET,KAAK,CAACS,kBAAkB,CAC5CC,WAAW,CAAEV,KAAK,CAACU,WAAW,CAC9BC,SAAS,CAAEX,KAAK,CAACW,SAAS,CAC1BC,aAAa,CAAEZ,KAAK,CAACY,aAAa,CAClCC,cAAc,CAAEb,KAAK,CAACa,cAAc,CACpCC,cAAc,CAAEd,KAAK,CAACc,cAAc,CACpCC,MAAM,CAAEf,KAAK,CAACe,MAAM,CACpBC,KAAK,CAAE,IAAI,CACXC,gBAAgB,CAAEjB,KAAK,CAACiB,gBAC1B,CAAC,CACH,CAAC,CAAC,CACF;AACAlC,eAAe,CAAC,IAAI,CAAE,kBAAkB,CAAE,SAAUmC,GAAG,CAAE,CACvD,GAAIA,GAAG,GAAK9B,SAAS,CAAE,CACrBY,KAAK,CAACmB,UAAU,CAAG,IAAI,CACvB,MAAO,CACLC,QAAQ,CAAEpB,KAAK,CAACoB,QAAQ,CACxBC,eAAe,CAAErB,KAAK,CAACqB,eAAe,CACtCC,aAAa,CAAEtB,KAAK,CAACsB,aAAa,CAClCC,YAAY,CAAEvB,KAAK,CAACuB,YAAY,CAChCC,gBAAgB,CAAExB,KAAK,CAACwB,gBAAgB,CACxCC,WAAW,CAAEzB,KAAK,CAACyB,WAAW,CAC9BC,YAAY,CAAE1B,KAAK,CAAC0B,YAAY,CAChCC,mBAAmB,CAAE3B,KAAK,CAAC2B,mBAAmB,CAC9CC,SAAS,CAAE5B,KAAK,CAAC4B,SAAS,CAC1BC,WAAW,CAAE7B,KAAK,CAAC6B,WAAW,CAC9BC,eAAe,CAAE9B,KAAK,CAAC8B,eAAe,CACtCC,aAAa,CAAE/B,KAAK,CAAC+B,aACvB,CAAC,CACH,CACA7C,OAAO,CAAC,KAAK,CAAE,iEAAiE,CAAC,CACjF,MAAO,KAAI,CACb,CAAC,CAAC,CACFH,eAAe,CAAC,IAAI,CAAE,cAAc,CAAE,SAAUiD,YAAY,CAAE,CAC5DhC,KAAK,CAACgC,YAAY,CAAGA,YAAY,CACnC,CAAC,CAAC,CACF;AACF;AACA;AACA,KACEjD,eAAe,CAAC,IAAI,CAAE,sBAAsB,CAAE,IAAI,CAAC,CACnD;AACF;AACA,KACEA,eAAe,CAAC,IAAI,CAAE,kBAAkB,CAAE,SAAUkD,aAAa,CAAEC,IAAI,CAAE,CACvElC,KAAK,CAACiC,aAAa,CAAGA,aAAa,EAAI,CAAC,CAAC,CACzC,GAAIC,IAAI,CAAE,CACR,GAAI,CAAAC,qBAAqB,CACzB,GAAI,CAAAC,SAAS,CAAGnD,KAAK,CAACgD,aAAa,CAAEjC,KAAK,CAACqC,KAAK,CAAC,CAEjD;AACA;AACA;AACA,CAACF,qBAAqB,CAAGnC,KAAK,CAACsC,oBAAoB,IAAM,IAAI,EAAIH,qBAAqB,GAAK,IAAK,EAAC,EAAIA,qBAAqB,CAACI,GAAG,CAAC,SAAUC,IAAI,CAAE,CAC7I,GAAI,CAAAC,QAAQ,CAAGD,IAAI,CAACtB,GAAG,CACvBkB,SAAS,CAAGvC,QAAQ,CAACuC,SAAS,CAAEK,QAAQ,CAAE9C,QAAQ,CAACsC,aAAa,CAAEQ,QAAQ,CAAC,CAAC,CAC9E,CAAC,CAAC,CACFzC,KAAK,CAACsC,oBAAoB,CAAG,IAAI,CACjCtC,KAAK,CAAC0C,WAAW,CAACN,SAAS,CAAC,CAC9B,CACF,CAAC,CAAC,CACFrD,eAAe,CAAC,IAAI,CAAE,aAAa,CAAE,UAAY,CAC/C,GAAI,CAAAuD,oBAAoB,CAAG,GAAI,CAAA/C,OAAO,CAAC,CAAC,CACxCS,KAAK,CAAC2C,gBAAgB,CAAC,IAAI,CAAC,CAACC,OAAO,CAAC,SAAUC,MAAM,CAAE,CACrD,GAAI,CAAC7C,KAAK,CAAC8C,gBAAgB,CAACD,MAAM,CAACE,UAAU,CAAC,CAAC,CAAC,CAAE,CAChDT,oBAAoB,CAACU,GAAG,CAACH,MAAM,CAACnD,WAAW,CAAC,CAAC,CAAE,IAAI,CAAC,CACtD,CACF,CAAC,CAAC,CACFM,KAAK,CAACsC,oBAAoB,CAAGA,oBAAoB,CACnD,CAAC,CAAC,CACFvD,eAAe,CAAC,IAAI,CAAE,iBAAiB,CAAE,SAAU0D,QAAQ,CAAE,CAC3D,GAAI,CAAAQ,SAAS,CAAGtD,QAAQ,CAACK,KAAK,CAACiC,aAAa,CAAEQ,QAAQ,CAAC,CAEvD;AACA,MAAO,CAAAA,QAAQ,CAACS,MAAM,CAAGjE,KAAK,CAACgE,SAAS,CAAC,CAAGA,SAAS,CACvD,CAAC,CAAC,CACFlE,eAAe,CAAC,IAAI,CAAE,cAAc,CAAE,SAAUoE,SAAS,CAAE,CACzDnD,KAAK,CAACmD,SAAS,CAAGA,SAAS,CAC7B,CAAC,CAAC,CACFpE,eAAe,CAAC,IAAI,CAAE,qBAAqB,CAAE,SAAUqE,gBAAgB,CAAE,CACvEpD,KAAK,CAACoD,gBAAgB,CAAGA,gBAAgB,CAC3C,CAAC,CAAC,CACFrE,eAAe,CAAC,IAAI,CAAE,aAAa,CAAE,SAAUsE,QAAQ,CAAE,CACvDrD,KAAK,CAACqD,QAAQ,CAAGA,QAAQ,CAC3B,CAAC,CAAC,CACF;AACAtE,eAAe,CAAC,IAAI,CAAE,WAAW,CAAE,EAAE,CAAC,CACtCA,eAAe,CAAC,IAAI,CAAE,eAAe,CAAE,SAAUuE,QAAQ,CAAE,CACzDtD,KAAK,CAACuD,SAAS,CAACC,IAAI,CAACF,QAAQ,CAAC,CAC9B,MAAO,WAAY,CACjBtD,KAAK,CAACuD,SAAS,CAAGvD,KAAK,CAACuD,SAAS,CAACE,MAAM,CAAC,SAAUC,EAAE,CAAE,CACrD,MAAO,CAAAA,EAAE,GAAKJ,QAAQ,CACxB,CAAC,CAAC,CACJ,CAAC,CACH,CAAC,CAAC,CACFvE,eAAe,CAAC,IAAI,CAAE,aAAa,CAAE,UAAY,CAC/C,GAAI,CAAA0D,QAAQ,CAAGkB,SAAS,CAACT,MAAM,CAAG,CAAC,EAAIS,SAAS,CAAC,CAAC,CAAC,GAAKC,SAAS,CAAGD,SAAS,CAAC,CAAC,CAAC,CAAG,EAAE,CACrF;AACA,GAAI3D,KAAK,CAACuD,SAAS,CAACL,MAAM,CAAE,CAC1B,GAAI,CAAAW,MAAM,CAAG7D,KAAK,CAACE,cAAc,CAAC,CAAC,CACnC,GAAI,CAAA4D,SAAS,CAAG9D,KAAK,CAACE,cAAc,CAAC,IAAI,CAAC,CAC1CF,KAAK,CAACuD,SAAS,CAACX,OAAO,CAAC,SAAUU,QAAQ,CAAE,CAC1CA,QAAQ,CAACO,MAAM,CAAEC,SAAS,CAAErB,QAAQ,CAAC,CACvC,CAAC,CAAC,CACJ,CACF,CAAC,CAAC,CACF;AACA1D,eAAe,CAAC,IAAI,CAAE,WAAW,CAAE,IAAI,CAAC,CACxCA,eAAe,CAAC,IAAI,CAAE,iBAAiB,CAAE,UAAY,CACnD,GAAIgF,OAAO,CAACC,GAAG,CAACC,QAAQ,GAAK,YAAY,EAAI,CAACjE,KAAK,CAACkE,SAAS,EAAI,MAAO,CAAAC,MAAM,GAAK,WAAW,CAAE,CAC9FnE,KAAK,CAACkE,SAAS,CAAGE,UAAU,CAAC,UAAY,CACvCpE,KAAK,CAACkE,SAAS,CAAG,IAAI,CACtB,GAAI,CAAClE,KAAK,CAACmB,UAAU,CAAE,CACrBjC,OAAO,CAAC,KAAK,CAAE,iGAAiG,CAAC,CACnH,CACF,CAAC,CAAC,CACJ,CACF,CAAC,CAAC,CACF;AACAH,eAAe,CAAC,IAAI,CAAE,aAAa,CAAE,SAAUqD,SAAS,CAAE,CACxDpC,KAAK,CAACqC,KAAK,CAAGD,SAAS,CACzB,CAAC,CAAC,CACF;AACA;AACF;AACA;AACA,KACErD,eAAe,CAAC,IAAI,CAAE,kBAAkB,CAAE,UAAY,CACpD,GAAI,CAAAsF,IAAI,CAAGV,SAAS,CAACT,MAAM,CAAG,CAAC,EAAIS,SAAS,CAAC,CAAC,CAAC,GAAKC,SAAS,CAAGD,SAAS,CAAC,CAAC,CAAC,CAAG,KAAK,CACpF,GAAI,CAACU,IAAI,CAAE,CACT,MAAO,CAAArE,KAAK,CAACsE,aAAa,CAC5B,CACA,MAAO,CAAAtE,KAAK,CAACsE,aAAa,CAACb,MAAM,CAAC,SAAUc,KAAK,CAAE,CACjD,MAAO,CAAAA,KAAK,CAAC7E,WAAW,CAAC,CAAC,CAACwD,MAAM,CACnC,CAAC,CAAC,CACJ,CAAC,CAAC,CACFnE,eAAe,CAAC,IAAI,CAAE,cAAc,CAAE,UAAY,CAChD,GAAI,CAAAsF,IAAI,CAAGV,SAAS,CAACT,MAAM,CAAG,CAAC,EAAIS,SAAS,CAAC,CAAC,CAAC,GAAKC,SAAS,CAAGD,SAAS,CAAC,CAAC,CAAC,CAAG,KAAK,CACpF,GAAI,CAAAa,KAAK,CAAG,GAAI,CAAAjF,OAAO,CAAC,CAAC,CACzBS,KAAK,CAAC2C,gBAAgB,CAAC0B,IAAI,CAAC,CAACzB,OAAO,CAAC,SAAU2B,KAAK,CAAE,CACpD,GAAI,CAAA9B,QAAQ,CAAG8B,KAAK,CAAC7E,WAAW,CAAC,CAAC,CAClC8E,KAAK,CAACxB,GAAG,CAACP,QAAQ,CAAE8B,KAAK,CAAC,CAC5B,CAAC,CAAC,CACF,MAAO,CAAAC,KAAK,CACd,CAAC,CAAC,CACFzF,eAAe,CAAC,IAAI,CAAE,iCAAiC,CAAE,SAAU0F,QAAQ,CAAE,CAC3E,GAAI,CAACA,QAAQ,CAAE,CACb,MAAO,CAAAzE,KAAK,CAAC2C,gBAAgB,CAAC,IAAI,CAAC,CACrC,CACA,GAAI,CAAA6B,KAAK,CAAGxE,KAAK,CAAC0E,YAAY,CAAC,IAAI,CAAC,CACpC,MAAO,CAAAD,QAAQ,CAAClC,GAAG,CAAC,SAAUoC,IAAI,CAAE,CAClC,GAAI,CAAAlC,QAAQ,CAAG/C,WAAW,CAACiF,IAAI,CAAC,CAChC,MAAO,CAAAH,KAAK,CAACI,GAAG,CAACnC,QAAQ,CAAC,EAAI,CAC5BoC,oBAAoB,CAAEnF,WAAW,CAACiF,IAAI,CACxC,CAAC,CACH,CAAC,CAAC,CACJ,CAAC,CAAC,CACF5F,eAAe,CAAC,IAAI,CAAE,gBAAgB,CAAE,SAAU0F,QAAQ,CAAEK,UAAU,CAAE,CACtE9E,KAAK,CAAC+E,eAAe,CAAC,CAAC,CAEvB;AACA,GAAI,CAAAC,cAAc,CAClB,GAAI,CAAAC,gBAAgB,CACpB,GAAI,CAAAC,YAAY,CAChB,GAAIT,QAAQ,GAAK,IAAI,EAAIU,KAAK,CAACC,OAAO,CAACX,QAAQ,CAAC,CAAE,CAChDO,cAAc,CAAGP,QAAQ,CACzBQ,gBAAgB,CAAGH,UAAU,CAC/B,CAAC,IAAM,IAAIL,QAAQ,EAAI7F,OAAO,CAAC6F,QAAQ,CAAC,GAAK,QAAQ,CAAE,CACrDS,YAAY,CAAGT,QAAQ,CAACY,MAAM,CAC9BJ,gBAAgB,CAAGR,QAAQ,CAAChB,MAAM,CACpC,CACA,GAAIuB,cAAc,GAAK,IAAI,EAAI,CAACC,gBAAgB,CAAE,CAChD,MAAO,CAAAjF,KAAK,CAACqC,KAAK,CACpB,CACA,GAAI,CAAAiC,aAAa,CAAGtE,KAAK,CAACsF,+BAA+B,CAACH,KAAK,CAACC,OAAO,CAACJ,cAAc,CAAC,CAAGA,cAAc,CAAG,IAAI,CAAC,CAChH,GAAI,CAAAO,gBAAgB,CAAG,EAAE,CACzBjB,aAAa,CAAC1B,OAAO,CAAC,SAAUC,MAAM,CAAE,CACtC,GAAI,CAAA2C,YAAY,CAAEC,KAAK,CACvB,GAAI,CAAAhD,QAAQ,CAAG,sBAAsB,EAAI,CAAAI,MAAM,CAAGA,MAAM,CAACgC,oBAAoB,CAAGhC,MAAM,CAACnD,WAAW,CAAC,CAAC,CAEpG;AACA;AACA,GAAIwF,YAAY,CAAE,CAChB,GAAI,CAAAQ,OAAO,CAAEC,KAAK,CAClB,GAAI,CAACD,OAAO,CAAG,CAACC,KAAK,CAAG9C,MAAM,EAAE+C,MAAM,IAAM,IAAI,EAAIF,OAAO,GAAK,IAAK,EAAC,EAAIA,OAAO,CAACG,IAAI,CAACF,KAAK,CAAC,CAAE,CAC7F,OACF,CACF,CAAC,IAAM,IAAI,CAACX,cAAc,EAAI,CAACQ,YAAY,CAAG,CAACC,KAAK,CAAG5C,MAAM,EAAEiD,WAAW,IAAM,IAAI,EAAIN,YAAY,GAAK,IAAK,EAAC,EAAIA,YAAY,CAACK,IAAI,CAACJ,KAAK,CAAC,CAAE,CAC3I,OACF,CACA,GAAI,CAACR,gBAAgB,CAAE,CACrBM,gBAAgB,CAAC/B,IAAI,CAACf,QAAQ,CAAC,CACjC,CAAC,IAAM,CACL,GAAI,CAAAsD,IAAI,CAAG,SAAS,EAAI,CAAAlD,MAAM,CAAGA,MAAM,CAACmD,OAAO,CAAC,CAAC,CAAG,IAAI,CACxD,GAAIf,gBAAgB,CAACc,IAAI,CAAC,CAAE,CAC1BR,gBAAgB,CAAC/B,IAAI,CAACf,QAAQ,CAAC,CACjC,CACF,CACF,CAAC,CAAC,CACF,MAAO,CAAAjD,mBAAmB,CAACQ,KAAK,CAACqC,KAAK,CAAEkD,gBAAgB,CAAChD,GAAG,CAAC7C,WAAW,CAAC,CAAC,CAC5E,CAAC,CAAC,CACFX,eAAe,CAAC,IAAI,CAAE,eAAe,CAAE,SAAU4F,IAAI,CAAE,CACrD3E,KAAK,CAAC+E,eAAe,CAAC,CAAC,CACvB,GAAI,CAAAtC,QAAQ,CAAG/C,WAAW,CAACiF,IAAI,CAAC,CAChC,MAAO,CAAAhF,QAAQ,CAACK,KAAK,CAACqC,KAAK,CAAEI,QAAQ,CAAC,CACxC,CAAC,CAAC,CACF1D,eAAe,CAAC,IAAI,CAAE,gBAAgB,CAAE,SAAU0F,QAAQ,CAAE,CAC1DzE,KAAK,CAAC+E,eAAe,CAAC,CAAC,CACvB,GAAI,CAAAT,aAAa,CAAGtE,KAAK,CAACsF,+BAA+B,CAACb,QAAQ,CAAC,CACnE,MAAO,CAAAH,aAAa,CAAC/B,GAAG,CAAC,SAAUM,MAAM,CAAEoD,KAAK,CAAE,CAChD,GAAIpD,MAAM,EAAI,EAAE,sBAAsB,EAAI,CAAAA,MAAM,CAAC,CAAE,CACjD,MAAO,CACL8B,IAAI,CAAE9B,MAAM,CAACnD,WAAW,CAAC,CAAC,CAC1BwG,MAAM,CAAErD,MAAM,CAACsD,SAAS,CAAC,CAAC,CAC1BC,QAAQ,CAAEvD,MAAM,CAACwD,WAAW,CAAC,CAC/B,CAAC,CACH,CACA,MAAO,CACL1B,IAAI,CAAEjF,WAAW,CAAC+E,QAAQ,CAACwB,KAAK,CAAC,CAAC,CAClCC,MAAM,CAAE,EAAE,CACVE,QAAQ,CAAE,EACZ,CAAC,CACH,CAAC,CAAC,CACJ,CAAC,CAAC,CACFrH,eAAe,CAAC,IAAI,CAAE,eAAe,CAAE,SAAU4F,IAAI,CAAE,CACrD3E,KAAK,CAAC+E,eAAe,CAAC,CAAC,CACvB,GAAI,CAAAtC,QAAQ,CAAG/C,WAAW,CAACiF,IAAI,CAAC,CAChC,GAAI,CAAA2B,UAAU,CAAGtG,KAAK,CAACK,cAAc,CAAC,CAACoC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CACpD,MAAO,CAAA6D,UAAU,CAACJ,MAAM,CAC1B,CAAC,CAAC,CACFnH,eAAe,CAAC,IAAI,CAAE,iBAAiB,CAAE,SAAU4F,IAAI,CAAE,CACvD3E,KAAK,CAAC+E,eAAe,CAAC,CAAC,CACvB,GAAI,CAAAtC,QAAQ,CAAG/C,WAAW,CAACiF,IAAI,CAAC,CAChC,GAAI,CAAA2B,UAAU,CAAGtG,KAAK,CAACK,cAAc,CAAC,CAACoC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CACpD,MAAO,CAAA6D,UAAU,CAACF,QAAQ,CAC5B,CAAC,CAAC,CACFrH,eAAe,CAAC,IAAI,CAAE,iBAAiB,CAAE,UAAY,CACnDiB,KAAK,CAAC+E,eAAe,CAAC,CAAC,CACvB,IAAK,GAAI,CAAAwB,IAAI,CAAG5C,SAAS,CAACT,MAAM,CAAEsD,IAAI,CAAG,GAAI,CAAArB,KAAK,CAACoB,IAAI,CAAC,CAAEE,IAAI,CAAG,CAAC,CAAEA,IAAI,CAAGF,IAAI,CAAEE,IAAI,EAAE,CAAE,CACvFD,IAAI,CAACC,IAAI,CAAC,CAAG9C,SAAS,CAAC8C,IAAI,CAAC,CAC9B,CACA,GAAI,CAAAC,IAAI,CAAGF,IAAI,CAAC,CAAC,CAAC,CAChBG,IAAI,CAAGH,IAAI,CAAC,CAAC,CAAC,CAChB,GAAI,CAAAI,YAAY,CAChB,GAAI,CAAAC,kBAAkB,CAAG,KAAK,CAC9B,GAAIL,IAAI,CAACtD,MAAM,GAAK,CAAC,CAAE,CACrB0D,YAAY,CAAG,IAAI,CACrB,CAAC,IAAM,IAAIJ,IAAI,CAACtD,MAAM,GAAK,CAAC,CAAE,CAC5B,GAAIiC,KAAK,CAACC,OAAO,CAACsB,IAAI,CAAC,CAAE,CACvBE,YAAY,CAAGF,IAAI,CAACnE,GAAG,CAAC7C,WAAW,CAAC,CACpCmH,kBAAkB,CAAG,KAAK,CAC5B,CAAC,IAAM,CACLD,YAAY,CAAG,IAAI,CACnBC,kBAAkB,CAAGH,IAAI,CAC3B,CACF,CAAC,IAAM,CACLE,YAAY,CAAGF,IAAI,CAACnE,GAAG,CAAC7C,WAAW,CAAC,CACpCmH,kBAAkB,CAAGF,IAAI,CAC3B,CACA,GAAI,CAAArC,aAAa,CAAGtE,KAAK,CAAC2C,gBAAgB,CAAC,IAAI,CAAC,CAChD,GAAI,CAAApC,cAAc,CAAG,QAAS,CAAAA,cAAcA,CAACgE,KAAK,CAAE,CAClD,MAAO,CAAAA,KAAK,CAAChE,cAAc,CAAC,CAAC,CAC/B,CAAC,CAED;AACA,GAAI,CAACqG,YAAY,CAAE,CACjB,MAAO,CAAAC,kBAAkB,CAAGvC,aAAa,CAACwC,KAAK,CAAC,SAAUjE,MAAM,CAAE,CAChE,MAAO,CAAAtC,cAAc,CAACsC,MAAM,CAAC,EAAIA,MAAM,CAAC+C,MAAM,CAAC,CAAC,CAClD,CAAC,CAAC,CAAGtB,aAAa,CAACyC,IAAI,CAACxG,cAAc,CAAC,CACzC,CAEA;AACA,GAAI,CAAAgC,GAAG,CAAG,GAAI,CAAAhD,OAAO,CAAC,CAAC,CACvBqH,YAAY,CAAChE,OAAO,CAAC,SAAUoE,aAAa,CAAE,CAC5CzE,GAAG,CAACS,GAAG,CAACgE,aAAa,CAAE,EAAE,CAAC,CAC5B,CAAC,CAAC,CACF1C,aAAa,CAAC1B,OAAO,CAAC,SAAU2B,KAAK,CAAE,CACrC,GAAI,CAAA0C,aAAa,CAAG1C,KAAK,CAAC7E,WAAW,CAAC,CAAC,CAEvC;AACAkH,YAAY,CAAChE,OAAO,CAAC,SAAUoE,aAAa,CAAE,CAC5C,GAAIA,aAAa,CAACF,KAAK,CAAC,SAAUI,QAAQ,CAAEC,CAAC,CAAE,CAC7C,MAAO,CAAAF,aAAa,CAACE,CAAC,CAAC,GAAKD,QAAQ,CACtC,CAAC,CAAC,CAAE,CACF3E,GAAG,CAAC6E,MAAM,CAACJ,aAAa,CAAE,SAAUK,IAAI,CAAE,CACxC,MAAO,EAAE,CAACC,MAAM,CAAC3I,kBAAkB,CAAC0I,IAAI,CAAC,CAAE,CAAC9C,KAAK,CAAC,CAAC,CACrD,CAAC,CAAC,CACJ,CACF,CAAC,CAAC,CACJ,CAAC,CAAC,CAEF;AACA,GAAI,CAAAgD,qBAAqB,CAAG,QAAS,CAAAA,qBAAqBA,CAACC,QAAQ,CAAE,CACnE,MAAO,CAAAA,QAAQ,CAACT,IAAI,CAACxG,cAAc,CAAC,CACtC,CAAC,CACD,GAAI,CAAAkH,oBAAoB,CAAGlF,GAAG,CAACA,GAAG,CAAC,SAAUmF,KAAK,CAAE,CAClD,GAAI,CAAAC,KAAK,CAAGD,KAAK,CAACC,KAAK,CACvB,MAAO,CAAAA,KAAK,CACd,CAAC,CAAC,CACF,MAAO,CAAAd,kBAAkB,CAAGY,oBAAoB,CAACX,KAAK,CAACS,qBAAqB,CAAC,CAAGE,oBAAoB,CAACV,IAAI,CAACQ,qBAAqB,CAAC,CAClI,CAAC,CAAC,CACFxI,eAAe,CAAC,IAAI,CAAE,gBAAgB,CAAE,SAAU4F,IAAI,CAAE,CACtD3E,KAAK,CAAC+E,eAAe,CAAC,CAAC,CACvB,MAAO,CAAA/E,KAAK,CAACM,eAAe,CAAC,CAACqE,IAAI,CAAC,CAAC,CACtC,CAAC,CAAC,CACF5F,eAAe,CAAC,IAAI,CAAE,oBAAoB,CAAE,SAAU0F,QAAQ,CAAE,CAC9DzE,KAAK,CAAC+E,eAAe,CAAC,CAAC,CACvB,GAAI,CAAAT,aAAa,CAAGtE,KAAK,CAAC2C,gBAAgB,CAAC,CAAC,CAC5C,GAAI,CAAC8B,QAAQ,CAAE,CACb,MAAO,CAAAH,aAAa,CAACyC,IAAI,CAAC,SAAUa,SAAS,CAAE,CAC7C,MAAO,CAAAA,SAAS,CAACpH,iBAAiB,CAAC,CAAC,CACtC,CAAC,CAAC,CACJ,CACA,GAAI,CAAAoG,YAAY,CAAGnC,QAAQ,CAAClC,GAAG,CAAC7C,WAAW,CAAC,CAC5C,MAAO,CAAA4E,aAAa,CAACyC,IAAI,CAAC,SAAUa,SAAS,CAAE,CAC7C,GAAI,CAAAX,aAAa,CAAGW,SAAS,CAAClI,WAAW,CAAC,CAAC,CAC3C,MAAO,CAAAD,gBAAgB,CAACmH,YAAY,CAAEK,aAAa,CAAC,EAAIW,SAAS,CAACpH,iBAAiB,CAAC,CAAC,CACvF,CAAC,CAAC,CACJ,CAAC,CAAC,CACFzB,eAAe,CAAC,IAAI,CAAE,mBAAmB,CAAE,SAAU4F,IAAI,CAAE,CACzD3E,KAAK,CAAC+E,eAAe,CAAC,CAAC,CACvB,MAAO,CAAA/E,KAAK,CAACS,kBAAkB,CAAC,CAACkE,IAAI,CAAC,CAAC,CACzC,CAAC,CAAC,CACF;AACF;AACA;AACA,KACE5F,eAAe,CAAC,IAAI,CAAE,4BAA4B,CAAE,UAAY,CAC9D,GAAI,CAAA8I,IAAI,CAAGlE,SAAS,CAACT,MAAM,CAAG,CAAC,EAAIS,SAAS,CAAC,CAAC,CAAC,GAAKC,SAAS,CAAGD,SAAS,CAAC,CAAC,CAAC,CAAG,CAAC,CAAC,CACjF;AACA,GAAI,CAAAa,KAAK,CAAG,GAAI,CAAAjF,OAAO,CAAC,CAAC,CACzB,GAAI,CAAA+E,aAAa,CAAGtE,KAAK,CAAC2C,gBAAgB,CAAC,IAAI,CAAC,CAChD2B,aAAa,CAAC1B,OAAO,CAAC,SAAU2B,KAAK,CAAE,CACrC,GAAI,CAAAuD,YAAY,CAAGvD,KAAK,CAACwD,KAAK,CAACD,YAAY,CAC3C,GAAI,CAAArF,QAAQ,CAAG8B,KAAK,CAAC7E,WAAW,CAAC,CAAC,CAElC;AACA,GAAIoI,YAAY,GAAKlE,SAAS,CAAE,CAC9B,GAAI,CAAAoE,OAAO,CAAGxD,KAAK,CAACI,GAAG,CAACnC,QAAQ,CAAC,EAAI,GAAI,CAAAwF,GAAG,CAAC,CAAC,CAC9CD,OAAO,CAACE,GAAG,CAAC,CACVrF,MAAM,CAAE0B,KAAK,CACboD,KAAK,CAAEG,YACT,CAAC,CAAC,CACFtD,KAAK,CAACxB,GAAG,CAACP,QAAQ,CAAEuF,OAAO,CAAC,CAC9B,CACF,CAAC,CAAC,CAEF;AACA,GAAI,CAAAG,eAAe,CAAG,QAAS,CAAAA,eAAeA,CAACX,QAAQ,CAAE,CACvDA,QAAQ,CAAC5E,OAAO,CAAC,SAAU2B,KAAK,CAAE,CAChC,GAAI,CAAAuD,YAAY,CAAGvD,KAAK,CAACwD,KAAK,CAACD,YAAY,CAC3C,GAAIA,YAAY,GAAKlE,SAAS,CAAE,CAC9B,GAAI,CAAAnB,QAAQ,CAAG8B,KAAK,CAAC7E,WAAW,CAAC,CAAC,CAClC,GAAI,CAAA0I,gBAAgB,CAAGpI,KAAK,CAAC8B,eAAe,CAACW,QAAQ,CAAC,CACtD,GAAI2F,gBAAgB,GAAKxE,SAAS,CAAE,CAClC;AACA1E,OAAO,CAAC,KAAK,CAAE,8CAA8C,CAACoI,MAAM,CAAC7E,QAAQ,CAAC4F,IAAI,CAAC,GAAG,CAAC,CAAE,gCAAgC,CAAC,CAAC,CAC7H,CAAC,IAAM,CACL,GAAI,CAAAL,OAAO,CAAGxD,KAAK,CAACI,GAAG,CAACnC,QAAQ,CAAC,CACjC,GAAIuF,OAAO,EAAIA,OAAO,CAACM,IAAI,CAAG,CAAC,CAAE,CAC/B;AACApJ,OAAO,CAAC,KAAK,CAAE,4BAA4B,CAACoI,MAAM,CAAC7E,QAAQ,CAAC4F,IAAI,CAAC,GAAG,CAAC,CAAE,yDAAyD,CAAC,CAAC,CACpI,CAAC,IAAM,IAAIL,OAAO,CAAE,CAClB,GAAI,CAAAO,WAAW,CAAGvI,KAAK,CAACC,aAAa,CAACwC,QAAQ,CAAC,CAC/C,GAAI,CAAAqD,WAAW,CAAGvB,KAAK,CAACuB,WAAW,CAAC,CAAC,CAErC;AACA,GAAI,CAACA,WAAW,GAAK,CAAC+B,IAAI,CAACW,SAAS,EAAID,WAAW,GAAK3E,SAAS,CAAC,CAAE,CAClE5D,KAAK,CAAC0C,WAAW,CAAC7C,QAAQ,CAACG,KAAK,CAACqC,KAAK,CAAEI,QAAQ,CAAE9D,kBAAkB,CAACqJ,OAAO,CAAC,CAAC,CAAC,CAAC,CAACL,KAAK,CAAC,CAAC,CAC1F,CACF,CACF,CACF,CACF,CAAC,CAAC,CACJ,CAAC,CACD,GAAI,CAAAc,qBAAqB,CACzB,GAAIZ,IAAI,CAACL,QAAQ,CAAE,CACjBiB,qBAAqB,CAAGZ,IAAI,CAACL,QAAQ,CACvC,CAAC,IAAM,IAAIK,IAAI,CAACjB,YAAY,CAAE,CAC5B6B,qBAAqB,CAAG,EAAE,CAC1BZ,IAAI,CAACjB,YAAY,CAAChE,OAAO,CAAC,SAAUH,QAAQ,CAAE,CAC5C,GAAI,CAAAuF,OAAO,CAAGxD,KAAK,CAACI,GAAG,CAACnC,QAAQ,CAAC,CACjC,GAAIuF,OAAO,CAAE,CACX,GAAI,CAAAU,qBAAqB,CACzB,CAACA,qBAAqB,CAAGD,qBAAqB,EAAEjF,IAAI,CAACmF,KAAK,CAACD,qBAAqB,CAAE/J,kBAAkB,CAACA,kBAAkB,CAACqJ,OAAO,CAAC,CAACzF,GAAG,CAAC,SAAUqG,CAAC,CAAE,CAChJ,MAAO,CAAAA,CAAC,CAAC/F,MAAM,CACjB,CAAC,CAAC,CAAC,CAAC,CACN,CACF,CAAC,CAAC,CACJ,CAAC,IAAM,CACL4F,qBAAqB,CAAGnE,aAAa,CACvC,CACA6D,eAAe,CAACM,qBAAqB,CAAC,CACxC,CAAC,CAAC,CACF1J,eAAe,CAAC,IAAI,CAAE,aAAa,CAAE,SAAU0F,QAAQ,CAAE,CACvDzE,KAAK,CAAC+E,eAAe,CAAC,CAAC,CACvB,GAAI,CAAA8D,SAAS,CAAG7I,KAAK,CAACqC,KAAK,CAC3B,GAAI,CAACoC,QAAQ,CAAE,CACbzE,KAAK,CAAC0C,WAAW,CAACzD,KAAK,CAACe,KAAK,CAACiC,aAAa,CAAC,CAAC,CAC7CjC,KAAK,CAAC8I,0BAA0B,CAAC,CAAC,CAClC9I,KAAK,CAAC+I,eAAe,CAACF,SAAS,CAAE,IAAI,CAAE,CACrCG,IAAI,CAAE,OACR,CAAC,CAAC,CACFhJ,KAAK,CAACiJ,WAAW,CAAC,CAAC,CACnB,OACF,CAEA;AACA,GAAI,CAAArC,YAAY,CAAGnC,QAAQ,CAAClC,GAAG,CAAC7C,WAAW,CAAC,CAC5CkH,YAAY,CAAChE,OAAO,CAAC,SAAUH,QAAQ,CAAE,CACvC,GAAI,CAAAqF,YAAY,CAAG9H,KAAK,CAAC8B,eAAe,CAACW,QAAQ,CAAC,CAClDzC,KAAK,CAAC0C,WAAW,CAAC7C,QAAQ,CAACG,KAAK,CAACqC,KAAK,CAAEI,QAAQ,CAAEqF,YAAY,CAAC,CAAC,CAClE,CAAC,CAAC,CACF9H,KAAK,CAAC8I,0BAA0B,CAAC,CAC/BlC,YAAY,CAAEA,YAChB,CAAC,CAAC,CACF5G,KAAK,CAAC+I,eAAe,CAACF,SAAS,CAAEjC,YAAY,CAAE,CAC7CoC,IAAI,CAAE,OACR,CAAC,CAAC,CACFhJ,KAAK,CAACiJ,WAAW,CAACrC,YAAY,CAAC,CACjC,CAAC,CAAC,CACF7H,eAAe,CAAC,IAAI,CAAE,WAAW,CAAE,SAAUmK,MAAM,CAAE,CACnDlJ,KAAK,CAAC+E,eAAe,CAAC,CAAC,CACvB,GAAI,CAAA8D,SAAS,CAAG7I,KAAK,CAACqC,KAAK,CAC3B,GAAI,CAAAuE,YAAY,CAAG,EAAE,CACrBsC,MAAM,CAACtG,OAAO,CAAC,SAAUuG,SAAS,CAAE,CAClC,GAAI,CAAAxE,IAAI,CAAGwE,SAAS,CAACxE,IAAI,CACvByE,IAAI,CAAG1K,wBAAwB,CAACyK,SAAS,CAAEnK,SAAS,CAAC,CACvD,GAAI,CAAAyD,QAAQ,CAAG/C,WAAW,CAACiF,IAAI,CAAC,CAChCiC,YAAY,CAACpD,IAAI,CAACf,QAAQ,CAAC,CAE3B;AACA,GAAI,OAAO,EAAI,CAAA2G,IAAI,CAAE,CACnBpJ,KAAK,CAAC0C,WAAW,CAAC7C,QAAQ,CAACG,KAAK,CAACqC,KAAK,CAAEI,QAAQ,CAAE2G,IAAI,CAACzB,KAAK,CAAC,CAAC,CAChE,CACA3H,KAAK,CAAC+I,eAAe,CAACF,SAAS,CAAE,CAACpG,QAAQ,CAAC,CAAE,CAC3CuG,IAAI,CAAE,UAAU,CAChBI,IAAI,CAAED,SACR,CAAC,CAAC,CACJ,CAAC,CAAC,CACFnJ,KAAK,CAACiJ,WAAW,CAACrC,YAAY,CAAC,CACjC,CAAC,CAAC,CACF7H,eAAe,CAAC,IAAI,CAAE,WAAW,CAAE,UAAY,CAC7C,GAAI,CAAAyI,QAAQ,CAAGxH,KAAK,CAAC2C,gBAAgB,CAAC,IAAI,CAAC,CAC3C,GAAI,CAAAuG,MAAM,CAAG1B,QAAQ,CAACjF,GAAG,CAAC,SAAUgC,KAAK,CAAE,CACzC,GAAI,CAAA9B,QAAQ,CAAG8B,KAAK,CAAC7E,WAAW,CAAC,CAAC,CAClC,GAAI,CAAAqG,IAAI,CAAGxB,KAAK,CAACyB,OAAO,CAAC,CAAC,CAC1B,GAAI,CAAAmD,SAAS,CAAG1K,aAAa,CAACA,aAAa,CAAC,CAAC,CAAC,CAAEsH,IAAI,CAAC,CAAE,CAAC,CAAC,CAAE,CACzDpB,IAAI,CAAElC,QAAQ,CACdkF,KAAK,CAAE3H,KAAK,CAACC,aAAa,CAACwC,QAAQ,CACrC,CAAC,CAAC,CACF4G,MAAM,CAACC,cAAc,CAACH,SAAS,CAAE,eAAe,CAAE,CAChDxB,KAAK,CAAE,IACT,CAAC,CAAC,CACF,MAAO,CAAAwB,SAAS,CAClB,CAAC,CAAC,CACF,MAAO,CAAAD,MAAM,CACf,CAAC,CAAC,CACF;AACA;AACF;AACA,KACEnK,eAAe,CAAC,IAAI,CAAE,iBAAiB,CAAE,SAAU8D,MAAM,CAAE,CACzD,GAAI,CAAAiF,YAAY,CAAGjF,MAAM,CAACkF,KAAK,CAACD,YAAY,CAC5C,GAAIA,YAAY,GAAKlE,SAAS,CAAE,CAC9B,GAAI,CAAAnB,QAAQ,CAAGI,MAAM,CAACnD,WAAW,CAAC,CAAC,CACnC,GAAI,CAAA6J,SAAS,CAAG5J,QAAQ,CAACK,KAAK,CAACqC,KAAK,CAAEI,QAAQ,CAAC,CAC/C,GAAI8G,SAAS,GAAK3F,SAAS,CAAE,CAC3B5D,KAAK,CAAC0C,WAAW,CAAC7C,QAAQ,CAACG,KAAK,CAACqC,KAAK,CAAEI,QAAQ,CAAEqF,YAAY,CAAC,CAAC,CAClE,CACF,CACF,CAAC,CAAC,CACF/I,eAAe,CAAC,IAAI,CAAE,kBAAkB,CAAE,SAAUyK,aAAa,CAAE,CACjE,GAAI,CAAAC,cAAc,CAAGD,aAAa,GAAK5F,SAAS,CAAG4F,aAAa,CAAGxJ,KAAK,CAACqD,QAAQ,CACjF,MAAO,CAAAoG,cAAc,GAAK,IAAI,EAAIA,cAAc,GAAK,IAAK,EAAC,CAAGA,cAAc,CAAG,IAAI,CACrF,CAAC,CAAC,CACF1K,eAAe,CAAC,IAAI,CAAE,eAAe,CAAE,SAAU8D,MAAM,CAAE,CACvD7C,KAAK,CAACsE,aAAa,CAACd,IAAI,CAACX,MAAM,CAAC,CAChC,GAAI,CAAAJ,QAAQ,CAAGI,MAAM,CAACnD,WAAW,CAAC,CAAC,CACnCM,KAAK,CAACiJ,WAAW,CAAC,CAACxG,QAAQ,CAAC,CAAC,CAE7B;AACA,GAAII,MAAM,CAACkF,KAAK,CAACD,YAAY,GAAKlE,SAAS,CAAE,CAC3C,GAAI,CAAAiF,SAAS,CAAG7I,KAAK,CAACqC,KAAK,CAC3BrC,KAAK,CAAC8I,0BAA0B,CAAC,CAC/BtB,QAAQ,CAAE,CAAC3E,MAAM,CAAC,CAClB2F,SAAS,CAAE,IACb,CAAC,CAAC,CACFxI,KAAK,CAAC+I,eAAe,CAACF,SAAS,CAAE,CAAChG,MAAM,CAACnD,WAAW,CAAC,CAAC,CAAC,CAAE,CACvDsJ,IAAI,CAAE,aAAa,CACnBU,MAAM,CAAE,UACV,CAAC,CAAC,CACJ,CAEA;AACA,MAAO,UAAU5D,WAAW,CAAEzC,QAAQ,CAAE,CACtC,GAAI,CAAAsG,WAAW,CAAGhG,SAAS,CAACT,MAAM,CAAG,CAAC,EAAIS,SAAS,CAAC,CAAC,CAAC,GAAKC,SAAS,CAAGD,SAAS,CAAC,CAAC,CAAC,CAAG,EAAE,CACxF3D,KAAK,CAACsE,aAAa,CAAGtE,KAAK,CAACsE,aAAa,CAACb,MAAM,CAAC,SAAUmG,IAAI,CAAE,CAC/D,MAAO,CAAAA,IAAI,GAAK/G,MAAM,CACxB,CAAC,CAAC,CAEF;AACA,GAAI,CAAC7C,KAAK,CAAC8C,gBAAgB,CAACO,QAAQ,CAAC,GAAK,CAACyC,WAAW,EAAI6D,WAAW,CAACzG,MAAM,CAAG,CAAC,CAAC,CAAE,CACjF,GAAI,CAAA2G,YAAY,CAAG/D,WAAW,CAAGlC,SAAS,CAAG5D,KAAK,CAAC8B,eAAe,CAACW,QAAQ,CAAC,CAC5E,GAAIA,QAAQ,CAACS,MAAM,EAAIlD,KAAK,CAACC,aAAa,CAACwC,QAAQ,CAAC,GAAKoH,YAAY,EAAI7J,KAAK,CAACsE,aAAa,CAACwC,KAAK,CAAC,SAAUvC,KAAK,CAAE,CAClH,MACE;AACA,CAAC3E,aAAa,CAAC2E,KAAK,CAAC7E,WAAW,CAAC,CAAC,CAAE+C,QAAQ,CAAC,EAEjD,CAAC,CAAC,CAAE,CACF,GAAI,CAAAqH,UAAU,CAAG9J,KAAK,CAACqC,KAAK,CAC5BrC,KAAK,CAAC0C,WAAW,CAAC7C,QAAQ,CAACiK,UAAU,CAAErH,QAAQ,CAAEoH,YAAY,CAAE,IAAI,CAAC,CAAC,CAErE;AACA7J,KAAK,CAAC+I,eAAe,CAACe,UAAU,CAAE,CAACrH,QAAQ,CAAC,CAAE,CAC5CuG,IAAI,CAAE,QACR,CAAC,CAAC,CAEF;AACAhJ,KAAK,CAAC+J,yBAAyB,CAACD,UAAU,CAAErH,QAAQ,CAAC,CACvD,CACF,CACAzC,KAAK,CAACiJ,WAAW,CAAC,CAACxG,QAAQ,CAAC,CAAC,CAC/B,CAAC,CACH,CAAC,CAAC,CACF1D,eAAe,CAAC,IAAI,CAAE,UAAU,CAAE,SAAUiL,MAAM,CAAE,CAClD,OAAQA,MAAM,CAAChB,IAAI,EACjB,IAAK,aAAa,CAChB,CACE,GAAI,CAAAvG,QAAQ,CAAGuH,MAAM,CAACvH,QAAQ,CAC5BkF,KAAK,CAAGqC,MAAM,CAACrC,KAAK,CACtB3H,KAAK,CAACiK,WAAW,CAACxH,QAAQ,CAAEkF,KAAK,CAAC,CAClC,MACF,CACF,IAAK,eAAe,CAClB,CACE,GAAI,CAAAuC,SAAS,CAAGF,MAAM,CAACvH,QAAQ,CAC7B0H,WAAW,CAAGH,MAAM,CAACG,WAAW,CAClCnK,KAAK,CAACc,cAAc,CAAC,CAACoJ,SAAS,CAAC,CAAE,CAChCC,WAAW,CAAEA,WACf,CAAC,CAAC,CACF,MACF,CACF,QACA;AACF,CACF,CAAC,CAAC,CACFpL,eAAe,CAAC,IAAI,CAAE,iBAAiB,CAAE,SAAU8J,SAAS,CAAEjC,YAAY,CAAEiB,IAAI,CAAE,CAChF,GAAI7H,KAAK,CAACgC,YAAY,CAAE,CACtB,GAAI,CAAAoI,UAAU,CAAG3L,aAAa,CAACA,aAAa,CAAC,CAAC,CAAC,CAAEoJ,IAAI,CAAC,CAAE,CAAC,CAAC,CAAE,CAC1DxF,KAAK,CAAErC,KAAK,CAACE,cAAc,CAAC,IAAI,CAClC,CAAC,CAAC,CACFF,KAAK,CAAC2C,gBAAgB,CAAC,CAAC,CAACC,OAAO,CAAC,SAAUyH,KAAK,CAAE,CAChD,GAAI,CAAAC,aAAa,CAAGD,KAAK,CAACC,aAAa,CACvCA,aAAa,CAACzB,SAAS,CAAEjC,YAAY,CAAEwD,UAAU,CAAC,CACpD,CAAC,CAAC,CACJ,CAAC,IAAM,CACLpK,KAAK,CAACD,eAAe,CAAC,CAAC,CACzB,CACF,CAAC,CAAC,CACF;AACF;AACA;AACA,KACEhB,eAAe,CAAC,IAAI,CAAE,2BAA2B,CAAE,SAAU8J,SAAS,CAAEpG,QAAQ,CAAE,CAChF,GAAI,CAAA8H,cAAc,CAAGvK,KAAK,CAACwK,2BAA2B,CAAC/H,QAAQ,CAAC,CAChE,GAAI8H,cAAc,CAACrH,MAAM,CAAE,CACzBlD,KAAK,CAACc,cAAc,CAACyJ,cAAc,CAAC,CACtC,CACAvK,KAAK,CAAC+I,eAAe,CAACF,SAAS,CAAE0B,cAAc,CAAE,CAC/CvB,IAAI,CAAE,oBAAoB,CAC1ByB,aAAa,CAAE,CAAChI,QAAQ,CAAC,CAAC6E,MAAM,CAAC3I,kBAAkB,CAAC4L,cAAc,CAAC,CACrE,CAAC,CAAC,CACF,MAAO,CAAAA,cAAc,CACvB,CAAC,CAAC,CACFxL,eAAe,CAAC,IAAI,CAAE,aAAa,CAAE,SAAU4F,IAAI,CAAEgD,KAAK,CAAE,CAC1D,GAAI,CAAAlF,QAAQ,CAAG/C,WAAW,CAACiF,IAAI,CAAC,CAChC,GAAI,CAAAkE,SAAS,CAAG7I,KAAK,CAACqC,KAAK,CAC3BrC,KAAK,CAAC0C,WAAW,CAAC7C,QAAQ,CAACG,KAAK,CAACqC,KAAK,CAAEI,QAAQ,CAAEkF,KAAK,CAAC,CAAC,CACzD3H,KAAK,CAAC+I,eAAe,CAACF,SAAS,CAAE,CAACpG,QAAQ,CAAC,CAAE,CAC3CuG,IAAI,CAAE,aAAa,CACnBU,MAAM,CAAE,UACV,CAAC,CAAC,CACF1J,KAAK,CAACiJ,WAAW,CAAC,CAACxG,QAAQ,CAAC,CAAC,CAE7B;AACA,GAAI,CAAA8H,cAAc,CAAGvK,KAAK,CAAC+J,yBAAyB,CAAClB,SAAS,CAAEpG,QAAQ,CAAC,CAEzE;AACA,GAAI,CAAAiI,cAAc,CAAG1K,KAAK,CAACmD,SAAS,CAACuH,cAAc,CACnD,GAAIA,cAAc,CAAE,CAClB,GAAI,CAAAC,aAAa,CAAGnL,mBAAmB,CAACQ,KAAK,CAACqC,KAAK,CAAE,CAACI,QAAQ,CAAC,CAAC,CAChEiI,cAAc,CAACC,aAAa,CAAE3K,KAAK,CAACE,cAAc,CAAC,CAAC,CAAC,CACvD,CACAF,KAAK,CAAC4K,qBAAqB,CAAC,CAACnI,QAAQ,CAAC,CAAC6E,MAAM,CAAC3I,kBAAkB,CAAC4L,cAAc,CAAC,CAAC,CAAC,CACpF,CAAC,CAAC,CACF;AACAxL,eAAe,CAAC,IAAI,CAAE,gBAAgB,CAAE,SAAUsD,KAAK,CAAE,CACvDrC,KAAK,CAAC+E,eAAe,CAAC,CAAC,CACvB,GAAI,CAAA8D,SAAS,CAAG7I,KAAK,CAACqC,KAAK,CAC3B,GAAIA,KAAK,CAAE,CACT,GAAI,CAAAD,SAAS,CAAGnD,KAAK,CAACe,KAAK,CAACqC,KAAK,CAAEA,KAAK,CAAC,CACzCrC,KAAK,CAAC0C,WAAW,CAACN,SAAS,CAAC,CAC9B,CACApC,KAAK,CAAC+I,eAAe,CAACF,SAAS,CAAE,IAAI,CAAE,CACrCG,IAAI,CAAE,aAAa,CACnBU,MAAM,CAAE,UACV,CAAC,CAAC,CACF1J,KAAK,CAACiJ,WAAW,CAAC,CAAC,CACrB,CAAC,CAAC,CACFlK,eAAe,CAAC,IAAI,CAAE,eAAe,CAAE,SAAU4F,IAAI,CAAEgD,KAAK,CAAE,CAC5D3H,KAAK,CAACW,SAAS,CAAC,CAAC,CACfgE,IAAI,CAAEA,IAAI,CACVgD,KAAK,CAAEA,KACT,CAAC,CAAC,CAAC,CACL,CAAC,CAAC,CACF5I,eAAe,CAAC,IAAI,CAAE,6BAA6B,CAAE,SAAU8L,YAAY,CAAE,CAC3E,GAAI,CAAAC,QAAQ,CAAG,GAAI,CAAA7C,GAAG,CAAC,CAAC,CACxB,GAAI,CAAAsC,cAAc,CAAG,EAAE,CACvB,GAAI,CAAAQ,mBAAmB,CAAG,GAAI,CAAAxL,OAAO,CAAC,CAAC,CAEvC;AACJ;AACA;AACA,OACIS,KAAK,CAAC2C,gBAAgB,CAAC,CAAC,CAACC,OAAO,CAAC,SAAU2B,KAAK,CAAE,CAChD,GAAI,CAAAyG,YAAY,CAAGzG,KAAK,CAACwD,KAAK,CAACiD,YAAY,CAC3C,CAACA,YAAY,EAAI,EAAE,EAAEpI,OAAO,CAAC,SAAUqI,UAAU,CAAE,CACjD,GAAI,CAAAC,kBAAkB,CAAGxL,WAAW,CAACuL,UAAU,CAAC,CAChDF,mBAAmB,CAAC3D,MAAM,CAAC8D,kBAAkB,CAAE,UAAY,CACzD,GAAI,CAAAhC,MAAM,CAAGvF,SAAS,CAACT,MAAM,CAAG,CAAC,EAAIS,SAAS,CAAC,CAAC,CAAC,GAAKC,SAAS,CAAGD,SAAS,CAAC,CAAC,CAAC,CAAG,GAAI,CAAAsE,GAAG,CAAC,CAAC,CAC1FiB,MAAM,CAAChB,GAAG,CAAC3D,KAAK,CAAC,CACjB,MAAO,CAAA2E,MAAM,CACf,CAAC,CAAC,CACJ,CAAC,CAAC,CACJ,CAAC,CAAC,CACF,GAAI,CAAAiC,YAAY,CAAG,QAAS,CAAAA,YAAYA,CAAC1I,QAAQ,CAAE,CACjD,GAAI,CAAAyG,MAAM,CAAG6B,mBAAmB,CAACnG,GAAG,CAACnC,QAAQ,CAAC,EAAI,GAAI,CAAAwF,GAAG,CAAC,CAAC,CAC3DiB,MAAM,CAACtG,OAAO,CAAC,SAAU2B,KAAK,CAAE,CAC9B,GAAI,CAACuG,QAAQ,CAACM,GAAG,CAAC7G,KAAK,CAAC,CAAE,CACxBuG,QAAQ,CAAC5C,GAAG,CAAC3D,KAAK,CAAC,CACnB,GAAI,CAAA0C,aAAa,CAAG1C,KAAK,CAAC7E,WAAW,CAAC,CAAC,CACvC,GAAI6E,KAAK,CAAC8G,YAAY,CAAC,CAAC,EAAIpE,aAAa,CAAC/D,MAAM,CAAE,CAChDqH,cAAc,CAAC/G,IAAI,CAACyD,aAAa,CAAC,CAClCkE,YAAY,CAAClE,aAAa,CAAC,CAC7B,CACF,CACF,CAAC,CAAC,CACJ,CAAC,CACDkE,YAAY,CAACN,YAAY,CAAC,CAC1B,MAAO,CAAAN,cAAc,CACvB,CAAC,CAAC,CACFxL,eAAe,CAAC,IAAI,CAAE,uBAAuB,CAAE,SAAU6H,YAAY,CAAE0E,WAAW,CAAE,CAClF,GAAI,CAAAC,cAAc,CAAGvL,KAAK,CAACmD,SAAS,CAACoI,cAAc,CACnD,GAAIA,cAAc,CAAE,CAClB,GAAI,CAAArC,MAAM,CAAGlJ,KAAK,CAAC4B,SAAS,CAAC,CAAC,CAE9B;AACN;AACA,SACM,GAAI0J,WAAW,CAAE,CACf,GAAI,CAAA9G,KAAK,CAAG,GAAI,CAAAjF,OAAO,CAAC,CAAC,CACzB+L,WAAW,CAAC1I,OAAO,CAAC,SAAU4I,KAAK,CAAE,CACnC,GAAI,CAAA7G,IAAI,CAAG6G,KAAK,CAAC7G,IAAI,CACnBuB,MAAM,CAAGsF,KAAK,CAACtF,MAAM,CACvB1B,KAAK,CAACxB,GAAG,CAAC2B,IAAI,CAAEuB,MAAM,CAAC,CACzB,CAAC,CAAC,CACFgD,MAAM,CAACtG,OAAO,CAAC,SAAU2B,KAAK,CAAE,CAC9B;AACAA,KAAK,CAAC2B,MAAM,CAAG1B,KAAK,CAACI,GAAG,CAACL,KAAK,CAACI,IAAI,CAAC,EAAIJ,KAAK,CAAC2B,MAAM,CACtD,CAAC,CAAC,CACJ,CACA,GAAI,CAAAuF,aAAa,CAAGvC,MAAM,CAACzF,MAAM,CAAC,SAAUiI,KAAK,CAAE,CACjD,GAAI,CAAAC,SAAS,CAAGD,KAAK,CAAC/G,IAAI,CAC1B,MAAO,CAAAlF,gBAAgB,CAACmH,YAAY,CAAE+E,SAAS,CAAC,CAClD,CAAC,CAAC,CACF,GAAIF,aAAa,CAACvI,MAAM,CAAE,CACxBqI,cAAc,CAACE,aAAa,CAAEvC,MAAM,CAAC,CACvC,CACF,CACF,CAAC,CAAC,CACF;AACAnK,eAAe,CAAC,IAAI,CAAE,gBAAgB,CAAE,SAAU4H,IAAI,CAAEiF,IAAI,CAAE,CAC5D5L,KAAK,CAAC+E,eAAe,CAAC,CAAC,CACvB,GAAI,CAAAN,QAAQ,CACZ,GAAI,CAAAoH,OAAO,CACX,GAAI1G,KAAK,CAACC,OAAO,CAACuB,IAAI,CAAC,EAAI,MAAO,CAAAA,IAAI,GAAK,QAAQ,EAAI,MAAO,CAAAiF,IAAI,GAAK,QAAQ,CAAE,CAC/EnH,QAAQ,CAAGkC,IAAI,CACfkF,OAAO,CAAGD,IAAI,CAChB,CAAC,IAAM,CACLC,OAAO,CAAGlF,IAAI,CAChB,CACA,GAAI,CAAAmF,eAAe,CAAG,CAAC,CAACrH,QAAQ,CAChC,GAAI,CAAAmC,YAAY,CAAGkF,eAAe,CAAGrH,QAAQ,CAAClC,GAAG,CAAC7C,WAAW,CAAC,CAAG,EAAE,CAEnE;AACA,GAAI,CAAAqM,WAAW,CAAG,EAAE,CAEpB;AACA,GAAI,CAAAC,SAAS,CAAGC,MAAM,CAACC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAC,CAClC,GAAI,CAAAC,oBAAoB,CAAG,GAAI,CAAAnE,GAAG,CAAC,CAAC,CACpC,GAAI,CAAAoE,KAAK,CAAGR,OAAO,EAAI,CAAC,CAAC,CACvBS,SAAS,CAAGD,KAAK,CAACC,SAAS,CAC3BC,KAAK,CAAGF,KAAK,CAACE,KAAK,CACrBvM,KAAK,CAAC2C,gBAAgB,CAAC,IAAI,CAAC,CAACC,OAAO,CAAC,SAAU2B,KAAK,CAAE,CACpD;AACA,GAAI,CAACuH,eAAe,CAAE,CACpBlF,YAAY,CAACpD,IAAI,CAACe,KAAK,CAAC7E,WAAW,CAAC,CAAC,CAAC,CACxC,CAEA;AACA,GAAI,CAAC6E,KAAK,CAACwD,KAAK,CAACyE,KAAK,EAAI,CAACjI,KAAK,CAACwD,KAAK,CAACyE,KAAK,CAACtJ,MAAM,CAAE,CACnD,OACF,CAEA;AACA,GAAIqJ,KAAK,EAAI,CAAChI,KAAK,CAAC8G,YAAY,CAAC,CAAC,CAAE,CAClC,OACF,CACA,GAAI,CAAApE,aAAa,CAAG1C,KAAK,CAAC7E,WAAW,CAAC,CAAC,CACvC0M,oBAAoB,CAAClE,GAAG,CAACjB,aAAa,CAACoB,IAAI,CAAC2D,SAAS,CAAC,CAAC,CAEvD;AACA,GAAI,CAACF,eAAe,EAAIrM,gBAAgB,CAACmH,YAAY,CAAEK,aAAa,CAAEqF,SAAS,CAAC,CAAE,CAChF,GAAI,CAAAG,OAAO,CAAGlI,KAAK,CAACmI,aAAa,CAACjO,aAAa,CAAC,CAC9C2E,gBAAgB,CAAE3E,aAAa,CAACA,aAAa,CAAC,CAAC,CAAC,CAAEa,uBAAuB,CAAC,CAAEU,KAAK,CAACoD,gBAAgB,CACpG,CAAC,CAAEyI,OAAO,CAAC,CAAC,CAEZ;AACAE,WAAW,CAACvI,IAAI,CAACiJ,OAAO,CAACE,IAAI,CAAC,UAAY,CACxC,MAAO,CACLhI,IAAI,CAAEsC,aAAa,CACnBf,MAAM,CAAE,EAAE,CACVE,QAAQ,CAAE,EACZ,CAAC,CACH,CAAC,CAAC,CAACwG,KAAK,CAAC,SAAUC,UAAU,CAAE,CAC7B,GAAI,CAAAC,mBAAmB,CACvB,GAAI,CAAAC,YAAY,CAAG,EAAE,CACrB,GAAI,CAAAC,cAAc,CAAG,EAAE,CACvB,CAACF,mBAAmB,CAAGD,UAAU,CAACjK,OAAO,IAAM,IAAI,EAAIkK,mBAAmB,GAAK,IAAK,EAAC,EAAIA,mBAAmB,CAACjH,IAAI,CAACgH,UAAU,CAAE,SAAUI,KAAK,CAAE,CAC7I,GAAI,CAAAC,WAAW,CAAGD,KAAK,CAACE,IAAI,CAACD,WAAW,CACtChH,MAAM,CAAG+G,KAAK,CAAC/G,MAAM,CACvB,GAAIgH,WAAW,CAAE,CACfF,cAAc,CAACxJ,IAAI,CAACmF,KAAK,CAACqE,cAAc,CAAErO,kBAAkB,CAACuH,MAAM,CAAC,CAAC,CACvE,CAAC,IAAM,CACL6G,YAAY,CAACvJ,IAAI,CAACmF,KAAK,CAACoE,YAAY,CAAEpO,kBAAkB,CAACuH,MAAM,CAAC,CAAC,CACnE,CACF,CAAC,CAAC,CACF,GAAI6G,YAAY,CAAC7J,MAAM,CAAE,CACvB,MAAO,CAAAkK,OAAO,CAACC,MAAM,CAAC,CACpB1I,IAAI,CAAEsC,aAAa,CACnBf,MAAM,CAAE6G,YAAY,CACpB3G,QAAQ,CAAE4G,cACZ,CAAC,CAAC,CACJ,CACA,MAAO,CACLrI,IAAI,CAAEsC,aAAa,CACnBf,MAAM,CAAE6G,YAAY,CACpB3G,QAAQ,CAAE4G,cACZ,CAAC,CACH,CAAC,CAAC,CAAC,CACL,CACF,CAAC,CAAC,CACF,GAAI,CAAAM,cAAc,CAAGjO,gBAAgB,CAAC0M,WAAW,CAAC,CAClD/L,KAAK,CAACuN,mBAAmB,CAAGD,cAAc,CAE1C;AACAA,cAAc,CAACV,KAAK,CAAC,SAAUY,OAAO,CAAE,CACtC,MAAO,CAAAA,OAAO,CAChB,CAAC,CAAC,CAACb,IAAI,CAAC,SAAUa,OAAO,CAAE,CACzB,GAAI,CAAAC,kBAAkB,CAAGD,OAAO,CAACjL,GAAG,CAAC,SAAUmL,MAAM,CAAE,CACrD,GAAI,CAAA/I,IAAI,CAAG+I,MAAM,CAAC/I,IAAI,CACtB,MAAO,CAAAA,IAAI,CACb,CAAC,CAAC,CACF3E,KAAK,CAAC+I,eAAe,CAAC/I,KAAK,CAACqC,KAAK,CAAEoL,kBAAkB,CAAE,CACrDzE,IAAI,CAAE,gBACR,CAAC,CAAC,CACFhJ,KAAK,CAAC4K,qBAAqB,CAAC6C,kBAAkB,CAAED,OAAO,CAAC,CAC1D,CAAC,CAAC,CACF,GAAI,CAAAG,aAAa,CAAGL,cAAc,CAACX,IAAI,CAAC,UAAY,CAClD,GAAI3M,KAAK,CAACuN,mBAAmB,GAAKD,cAAc,CAAE,CAChD,MAAO,CAAAF,OAAO,CAACQ,OAAO,CAAC5N,KAAK,CAACE,cAAc,CAAC0G,YAAY,CAAC,CAAC,CAC5D,CACA,MAAO,CAAAwG,OAAO,CAACC,MAAM,CAAC,EAAE,CAAC,CAC3B,CAAC,CAAC,CAACT,KAAK,CAAC,SAAUY,OAAO,CAAE,CAC1B,GAAI,CAAAK,SAAS,CAAGL,OAAO,CAAC/J,MAAM,CAAC,SAAUqK,MAAM,CAAE,CAC/C,MAAO,CAAAA,MAAM,EAAIA,MAAM,CAAC5H,MAAM,CAAChD,MAAM,CACvC,CAAC,CAAC,CACF,MAAO,CAAAkK,OAAO,CAACC,MAAM,CAAC,CACpBxJ,MAAM,CAAE7D,KAAK,CAACE,cAAc,CAAC0G,YAAY,CAAC,CAC1CmH,WAAW,CAAEF,SAAS,CACtBG,SAAS,CAAEhO,KAAK,CAACuN,mBAAmB,GAAKD,cAC3C,CAAC,CAAC,CACJ,CAAC,CAAC,CAEF;AACAK,aAAa,CAACf,KAAK,CAAC,SAAUqB,CAAC,CAAE,CAC/B,MAAO,CAAAA,CAAC,CACV,CAAC,CAAC,CAEF;AACA,GAAI,CAAAC,mBAAmB,CAAGtH,YAAY,CAACnD,MAAM,CAAC,SAAUhB,QAAQ,CAAE,CAChE,MAAO,CAAA2J,oBAAoB,CAAChB,GAAG,CAAC3I,QAAQ,CAAC4F,IAAI,CAAC2D,SAAS,CAAC,CAAC,CAC3D,CAAC,CAAC,CACFhM,KAAK,CAAC4K,qBAAqB,CAACsD,mBAAmB,CAAC,CAChD,MAAO,CAAAP,aAAa,CACtB,CAAC,CAAC,CACF;AACA5O,eAAe,CAAC,IAAI,CAAE,QAAQ,CAAE,UAAY,CAC1CiB,KAAK,CAAC+E,eAAe,CAAC,CAAC,CACvB/E,KAAK,CAACc,cAAc,CAAC,CAAC,CAAC6L,IAAI,CAAC,SAAU9I,MAAM,CAAE,CAC5C,GAAI,CAAAsK,QAAQ,CAAGnO,KAAK,CAACmD,SAAS,CAACgL,QAAQ,CACvC,GAAIA,QAAQ,CAAE,CACZ,GAAI,CACFA,QAAQ,CAACtK,MAAM,CAAC,CAClB,CAAE,MAAOuK,GAAG,CAAE,CACZ;AACAC,OAAO,CAACC,KAAK,CAACF,GAAG,CAAC,CACpB,CACF,CACF,CAAC,CAAC,CAACxB,KAAK,CAAC,SAAUqB,CAAC,CAAE,CACpB,GAAI,CAAAM,cAAc,CAAGvO,KAAK,CAACmD,SAAS,CAACoL,cAAc,CACnD,GAAIA,cAAc,CAAE,CAClBA,cAAc,CAACN,CAAC,CAAC,CACnB,CACF,CAAC,CAAC,CACJ,CAAC,CAAC,CACF,IAAI,CAAClO,eAAe,CAAGA,eAAe,CACxC,CAAC,CAAC,CACF,QAAS,CAAAyO,OAAOA,CAACC,IAAI,CAAE,CACrB,GAAI,CAAAC,OAAO,CAAGvP,KAAK,CAACwP,MAAM,CAAC,CAAC,CAC5B,GAAI,CAAAC,eAAe,CAAGzP,KAAK,CAAC0P,QAAQ,CAAC,CAAC,CAAC,CAAC,CACtCC,gBAAgB,CAAGtQ,cAAc,CAACoQ,eAAe,CAAE,CAAC,CAAC,CACrDG,WAAW,CAAGD,gBAAgB,CAAC,CAAC,CAAC,CACnC,GAAI,CAACJ,OAAO,CAACM,OAAO,CAAE,CACpB,GAAIP,IAAI,CAAE,CACRC,OAAO,CAACM,OAAO,CAAGP,IAAI,CACxB,CAAC,IAAM,CACL;AACA,GAAI,CAAAQ,aAAa,CAAG,QAAS,CAAAA,aAAaA,CAAA,CAAG,CAC3CF,WAAW,CAAC,CAAC,CAAC,CAAC,CACjB,CAAC,CACD,GAAI,CAAAG,SAAS,CAAG,GAAI,CAAApP,SAAS,CAACmP,aAAa,CAAC,CAC5CP,OAAO,CAACM,OAAO,CAAGE,SAAS,CAACC,OAAO,CAAC,CAAC,CACvC,CACF,CACA,MAAO,CAACT,OAAO,CAACM,OAAO,CAAC,CAC1B,CACA,cAAe,CAAAR,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}