{"ast":null,"code":"import _objectSpread from\"@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";import{useState,useRef,useEffect}from'react';import addEventListener from\"rc-util/es/Dom/addEventListener\";import{warning}from\"rc-util/es/warning\";import getFixScaleEleTransPosition from\"../getFixScaleEleTransPosition\";import{BASE_SCALE_RATIO,WHEEL_MAX_SCALE_RATIO}from\"../previewConfig\";export default function useMouseEvent(imgRef,movable,visible,scaleStep,transform,updateTransform,dispatchZoomChange){var rotate=transform.rotate,scale=transform.scale,x=transform.x,y=transform.y;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isMoving=_useState2[0],setMoving=_useState2[1];var startPositionInfo=useRef({diffX:0,diffY:0,transformX:0,transformY:0});var onMouseDown=function onMouseDown(event){// Only allow main button\nif(!movable||event.button!==0)return;event.preventDefault();event.stopPropagation();startPositionInfo.current={diffX:event.pageX-x,diffY:event.pageY-y,transformX:x,transformY:y};setMoving(true);};var onMouseMove=function onMouseMove(event){if(visible&&isMoving){updateTransform({x:event.pageX-startPositionInfo.current.diffX,y:event.pageY-startPositionInfo.current.diffY},'move');}};var onMouseUp=function onMouseUp(){if(visible&&isMoving){setMoving(false);/** No need to restore the position when the picture is not moved, So as not to interfere with the click */var _startPositionInfo$cu=startPositionInfo.current,transformX=_startPositionInfo$cu.transformX,transformY=_startPositionInfo$cu.transformY;var hasChangedPosition=x!==transformX&&y!==transformY;if(!hasChangedPosition)return;var width=imgRef.current.offsetWidth*scale;var height=imgRef.current.offsetHeight*scale;// eslint-disable-next-line @typescript-eslint/no-shadow\nvar _imgRef$current$getBo=imgRef.current.getBoundingClientRect(),left=_imgRef$current$getBo.left,top=_imgRef$current$getBo.top;var isRotate=rotate%180!==0;var fixState=getFixScaleEleTransPosition(isRotate?height:width,isRotate?width:height,left,top);if(fixState){updateTransform(_objectSpread({},fixState),'dragRebound');}}};var onWheel=function onWheel(event){if(!visible||event.deltaY==0)return;// Scale ratio depends on the deltaY size\nvar scaleRatio=Math.abs(event.deltaY/100);// Limit the maximum scale ratio\nvar mergedScaleRatio=Math.min(scaleRatio,WHEEL_MAX_SCALE_RATIO);// Scale the ratio each time\nvar ratio=BASE_SCALE_RATIO+mergedScaleRatio*scaleStep;if(event.deltaY>0){ratio=BASE_SCALE_RATIO/ratio;}dispatchZoomChange(ratio,'wheel',event.clientX,event.clientY);};useEffect(function(){var onTopMouseUpListener;var onTopMouseMoveListener;var onMouseUpListener;var onMouseMoveListener;if(movable){onMouseUpListener=addEventListener(window,'mouseup',onMouseUp,false);onMouseMoveListener=addEventListener(window,'mousemove',onMouseMove,false);try{// Resolve if in iframe lost event\n/* istanbul ignore next */if(window.top!==window.self){onTopMouseUpListener=addEventListener(window.top,'mouseup',onMouseUp,false);onTopMouseMoveListener=addEventListener(window.top,'mousemove',onMouseMove,false);}}catch(error){/* istanbul ignore next */warning(false,\"[rc-image] \".concat(error));}}return function(){var _onMouseUpListener,_onMouseMoveListener,_onTopMouseUpListener,_onTopMouseMoveListen;(_onMouseUpListener=onMouseUpListener)===null||_onMouseUpListener===void 0||_onMouseUpListener.remove();(_onMouseMoveListener=onMouseMoveListener)===null||_onMouseMoveListener===void 0||_onMouseMoveListener.remove();/* istanbul ignore next */(_onTopMouseUpListener=onTopMouseUpListener)===null||_onTopMouseUpListener===void 0||_onTopMouseUpListener.remove();/* istanbul ignore next */(_onTopMouseMoveListen=onTopMouseMoveListener)===null||_onTopMouseMoveListen===void 0||_onTopMouseMoveListen.remove();};},[visible,isMoving,x,y,rotate,movable]);return{isMoving:isMoving,onMouseDown:onMouseDown,onMouseMove:onMouseMove,onMouseUp:onMouseUp,onWheel:onWheel};};","map":{"version":3,"names":["_objectSpread","_slicedToArray","useState","useRef","useEffect","addEventListener","warning","getFixScaleEleTransPosition","BASE_SCALE_RATIO","WHEEL_MAX_SCALE_RATIO","useMouseEvent","imgRef","movable","visible","scaleStep","transform","updateTransform","dispatchZoomChange","rotate","scale","x","y","_useState","_useState2","isMoving","setMoving","startPositionInfo","diffX","diffY","transformX","transformY","onMouseDown","event","button","preventDefault","stopPropagation","current","pageX","pageY","onMouseMove","onMouseUp","_startPositionInfo$cu","hasChangedPosition","width","offsetWidth","height","offsetHeight","_imgRef$current$getBo","getBoundingClientRect","left","top","isRotate","fixState","onWheel","deltaY","scaleRatio","Math","abs","mergedScaleRatio","min","ratio","clientX","clientY","onTopMouseUpListener","onTopMouseMoveListener","onMouseUpListener","onMouseMoveListener","window","self","error","concat","_onMouseUpListener","_onMouseMoveListener","_onTopMouseUpListener","_onTopMouseMoveListen","remove"],"sources":["/Users/jmmallon/Downloads/js/ticketproject/src/node_modules/rc-image/es/hooks/useMouseEvent.js"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport { useState, useRef, useEffect } from 'react';\nimport addEventListener from \"rc-util/es/Dom/addEventListener\";\nimport { warning } from \"rc-util/es/warning\";\nimport getFixScaleEleTransPosition from \"../getFixScaleEleTransPosition\";\nimport { BASE_SCALE_RATIO, WHEEL_MAX_SCALE_RATIO } from \"../previewConfig\";\nexport default function useMouseEvent(imgRef, movable, visible, scaleStep, transform, updateTransform, dispatchZoomChange) {\n  var rotate = transform.rotate,\n    scale = transform.scale,\n    x = transform.x,\n    y = transform.y;\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    isMoving = _useState2[0],\n    setMoving = _useState2[1];\n  var startPositionInfo = useRef({\n    diffX: 0,\n    diffY: 0,\n    transformX: 0,\n    transformY: 0\n  });\n  var onMouseDown = function onMouseDown(event) {\n    // Only allow main button\n    if (!movable || event.button !== 0) return;\n    event.preventDefault();\n    event.stopPropagation();\n    startPositionInfo.current = {\n      diffX: event.pageX - x,\n      diffY: event.pageY - y,\n      transformX: x,\n      transformY: y\n    };\n    setMoving(true);\n  };\n  var onMouseMove = function onMouseMove(event) {\n    if (visible && isMoving) {\n      updateTransform({\n        x: event.pageX - startPositionInfo.current.diffX,\n        y: event.pageY - startPositionInfo.current.diffY\n      }, 'move');\n    }\n  };\n  var onMouseUp = function onMouseUp() {\n    if (visible && isMoving) {\n      setMoving(false);\n\n      /** No need to restore the position when the picture is not moved, So as not to interfere with the click */\n      var _startPositionInfo$cu = startPositionInfo.current,\n        transformX = _startPositionInfo$cu.transformX,\n        transformY = _startPositionInfo$cu.transformY;\n      var hasChangedPosition = x !== transformX && y !== transformY;\n      if (!hasChangedPosition) return;\n      var width = imgRef.current.offsetWidth * scale;\n      var height = imgRef.current.offsetHeight * scale;\n      // eslint-disable-next-line @typescript-eslint/no-shadow\n      var _imgRef$current$getBo = imgRef.current.getBoundingClientRect(),\n        left = _imgRef$current$getBo.left,\n        top = _imgRef$current$getBo.top;\n      var isRotate = rotate % 180 !== 0;\n      var fixState = getFixScaleEleTransPosition(isRotate ? height : width, isRotate ? width : height, left, top);\n      if (fixState) {\n        updateTransform(_objectSpread({}, fixState), 'dragRebound');\n      }\n    }\n  };\n  var onWheel = function onWheel(event) {\n    if (!visible || event.deltaY == 0) return;\n    // Scale ratio depends on the deltaY size\n    var scaleRatio = Math.abs(event.deltaY / 100);\n    // Limit the maximum scale ratio\n    var mergedScaleRatio = Math.min(scaleRatio, WHEEL_MAX_SCALE_RATIO);\n    // Scale the ratio each time\n    var ratio = BASE_SCALE_RATIO + mergedScaleRatio * scaleStep;\n    if (event.deltaY > 0) {\n      ratio = BASE_SCALE_RATIO / ratio;\n    }\n    dispatchZoomChange(ratio, 'wheel', event.clientX, event.clientY);\n  };\n  useEffect(function () {\n    var onTopMouseUpListener;\n    var onTopMouseMoveListener;\n    var onMouseUpListener;\n    var onMouseMoveListener;\n    if (movable) {\n      onMouseUpListener = addEventListener(window, 'mouseup', onMouseUp, false);\n      onMouseMoveListener = addEventListener(window, 'mousemove', onMouseMove, false);\n      try {\n        // Resolve if in iframe lost event\n        /* istanbul ignore next */\n        if (window.top !== window.self) {\n          onTopMouseUpListener = addEventListener(window.top, 'mouseup', onMouseUp, false);\n          onTopMouseMoveListener = addEventListener(window.top, 'mousemove', onMouseMove, false);\n        }\n      } catch (error) {\n        /* istanbul ignore next */\n        warning(false, \"[rc-image] \".concat(error));\n      }\n    }\n    return function () {\n      var _onMouseUpListener, _onMouseMoveListener, _onTopMouseUpListener, _onTopMouseMoveListen;\n      (_onMouseUpListener = onMouseUpListener) === null || _onMouseUpListener === void 0 || _onMouseUpListener.remove();\n      (_onMouseMoveListener = onMouseMoveListener) === null || _onMouseMoveListener === void 0 || _onMouseMoveListener.remove();\n      /* istanbul ignore next */\n      (_onTopMouseUpListener = onTopMouseUpListener) === null || _onTopMouseUpListener === void 0 || _onTopMouseUpListener.remove();\n      /* istanbul ignore next */\n      (_onTopMouseMoveListen = onTopMouseMoveListener) === null || _onTopMouseMoveListen === void 0 || _onTopMouseMoveListen.remove();\n    };\n  }, [visible, isMoving, x, y, rotate, movable]);\n  return {\n    isMoving: isMoving,\n    onMouseDown: onMouseDown,\n    onMouseMove: onMouseMove,\n    onMouseUp: onMouseUp,\n    onWheel: onWheel\n  };\n}\n;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}