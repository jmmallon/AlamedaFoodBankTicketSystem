{"ast":null,"code":"\"use client\";import _toConsumableArray from\"@babel/runtime/helpers/esm/toConsumableArray\";import*as React from'react';import usePatchElement from'../../_util/hooks/usePatchElement';import{withConfirm,withError,withInfo,withSuccess,withWarn}from'../confirm';import destroyFns from'../destroyFns';import HookModal from'./HookModal';let uuid=0;const ElementsHolder=/*#__PURE__*/React.memo(/*#__PURE__*/React.forwardRef((_props,ref)=>{const[elements,patchElement]=usePatchElement();React.useImperativeHandle(ref,()=>({patchElement}),[]);// eslint-disable-next-line react/jsx-no-useless-fragment\nreturn/*#__PURE__*/React.createElement(React.Fragment,null,elements);}));function useModal(){const holderRef=React.useRef(null);// ========================== Effect ==========================\nconst[actionQueue,setActionQueue]=React.useState([]);React.useEffect(()=>{if(actionQueue.length){const cloneQueue=_toConsumableArray(actionQueue);cloneQueue.forEach(action=>{action();});setActionQueue([]);}},[actionQueue]);// =========================== Hook ===========================\nconst getConfirmFunc=React.useCallback(withFunc=>function hookConfirm(config){var _a;uuid+=1;const modalRef=/*#__PURE__*/React.createRef();// Proxy to promise with `onClose`\nlet resolvePromise;const promise=new Promise(resolve=>{resolvePromise=resolve;});let silent=false;let closeFunc;const modal=/*#__PURE__*/React.createElement(HookModal,{key:\"modal-\".concat(uuid),config:withFunc(config),ref:modalRef,afterClose:()=>{closeFunc===null||closeFunc===void 0?void 0:closeFunc();},isSilent:()=>silent,onConfirm:confirmed=>{resolvePromise(confirmed);}});closeFunc=(_a=holderRef.current)===null||_a===void 0?void 0:_a.patchElement(modal);if(closeFunc){destroyFns.push(closeFunc);}const instance={destroy:()=>{function destroyAction(){var _a;(_a=modalRef.current)===null||_a===void 0?void 0:_a.destroy();}if(modalRef.current){destroyAction();}else{setActionQueue(prev=>[].concat(_toConsumableArray(prev),[destroyAction]));}},update:newConfig=>{function updateAction(){var _a;(_a=modalRef.current)===null||_a===void 0?void 0:_a.update(newConfig);}if(modalRef.current){updateAction();}else{setActionQueue(prev=>[].concat(_toConsumableArray(prev),[updateAction]));}},then:resolve=>{silent=true;return promise.then(resolve);}};return instance;},[]);const fns=React.useMemo(()=>({info:getConfirmFunc(withInfo),success:getConfirmFunc(withSuccess),error:getConfirmFunc(withError),warning:getConfirmFunc(withWarn),confirm:getConfirmFunc(withConfirm)}),[]);return[fns,/*#__PURE__*/React.createElement(ElementsHolder,{key:\"modal-holder\",ref:holderRef})];}export default useModal;","map":{"version":3,"names":["_toConsumableArray","React","usePatchElement","withConfirm","withError","withInfo","withSuccess","withWarn","destroyFns","HookModal","uuid","ElementsHolder","memo","forwardRef","_props","ref","elements","patchElement","useImperativeHandle","createElement","Fragment","useModal","holderRef","useRef","actionQueue","setActionQueue","useState","useEffect","length","cloneQueue","forEach","action","getConfirmFunc","useCallback","withFunc","hookConfirm","config","_a","modalRef","createRef","resolvePromise","promise","Promise","resolve","silent","closeFunc","modal","key","concat","afterClose","isSilent","onConfirm","confirmed","current","push","instance","destroy","destroyAction","prev","update","newConfig","updateAction","then","fns","useMemo","info","success","error","warning","confirm"],"sources":["/Users/jmmallon/Downloads/js/ticketproject/src/node_modules/antd/es/modal/useModal/index.js"],"sourcesContent":["\"use client\";\n\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport * as React from 'react';\nimport usePatchElement from '../../_util/hooks/usePatchElement';\nimport { withConfirm, withError, withInfo, withSuccess, withWarn } from '../confirm';\nimport destroyFns from '../destroyFns';\nimport HookModal from './HookModal';\nlet uuid = 0;\nconst ElementsHolder = /*#__PURE__*/React.memo( /*#__PURE__*/React.forwardRef((_props, ref) => {\n  const [elements, patchElement] = usePatchElement();\n  React.useImperativeHandle(ref, () => ({\n    patchElement\n  }), []);\n  // eslint-disable-next-line react/jsx-no-useless-fragment\n  return /*#__PURE__*/React.createElement(React.Fragment, null, elements);\n}));\nfunction useModal() {\n  const holderRef = React.useRef(null);\n  // ========================== Effect ==========================\n  const [actionQueue, setActionQueue] = React.useState([]);\n  React.useEffect(() => {\n    if (actionQueue.length) {\n      const cloneQueue = _toConsumableArray(actionQueue);\n      cloneQueue.forEach(action => {\n        action();\n      });\n      setActionQueue([]);\n    }\n  }, [actionQueue]);\n  // =========================== Hook ===========================\n  const getConfirmFunc = React.useCallback(withFunc => function hookConfirm(config) {\n    var _a;\n    uuid += 1;\n    const modalRef = /*#__PURE__*/React.createRef();\n    // Proxy to promise with `onClose`\n    let resolvePromise;\n    const promise = new Promise(resolve => {\n      resolvePromise = resolve;\n    });\n    let silent = false;\n    let closeFunc;\n    const modal = /*#__PURE__*/React.createElement(HookModal, {\n      key: `modal-${uuid}`,\n      config: withFunc(config),\n      ref: modalRef,\n      afterClose: () => {\n        closeFunc === null || closeFunc === void 0 ? void 0 : closeFunc();\n      },\n      isSilent: () => silent,\n      onConfirm: confirmed => {\n        resolvePromise(confirmed);\n      }\n    });\n    closeFunc = (_a = holderRef.current) === null || _a === void 0 ? void 0 : _a.patchElement(modal);\n    if (closeFunc) {\n      destroyFns.push(closeFunc);\n    }\n    const instance = {\n      destroy: () => {\n        function destroyAction() {\n          var _a;\n          (_a = modalRef.current) === null || _a === void 0 ? void 0 : _a.destroy();\n        }\n        if (modalRef.current) {\n          destroyAction();\n        } else {\n          setActionQueue(prev => [].concat(_toConsumableArray(prev), [destroyAction]));\n        }\n      },\n      update: newConfig => {\n        function updateAction() {\n          var _a;\n          (_a = modalRef.current) === null || _a === void 0 ? void 0 : _a.update(newConfig);\n        }\n        if (modalRef.current) {\n          updateAction();\n        } else {\n          setActionQueue(prev => [].concat(_toConsumableArray(prev), [updateAction]));\n        }\n      },\n      then: resolve => {\n        silent = true;\n        return promise.then(resolve);\n      }\n    };\n    return instance;\n  }, []);\n  const fns = React.useMemo(() => ({\n    info: getConfirmFunc(withInfo),\n    success: getConfirmFunc(withSuccess),\n    error: getConfirmFunc(withError),\n    warning: getConfirmFunc(withWarn),\n    confirm: getConfirmFunc(withConfirm)\n  }), []);\n  return [fns, /*#__PURE__*/React.createElement(ElementsHolder, {\n    key: \"modal-holder\",\n    ref: holderRef\n  })];\n}\nexport default useModal;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}