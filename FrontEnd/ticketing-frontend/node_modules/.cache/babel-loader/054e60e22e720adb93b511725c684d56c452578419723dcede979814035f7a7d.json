{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";import warning from\"rc-util/es/warning\";import{useContext,useEffect,useMemo,useRef,useState}from'react';import FieldContext,{HOOK_MARK}from\"./FieldContext\";import{isFormInstance}from\"./utils/typeUtil\";import{getNamePath,getValue}from\"./utils/valueUtil\";export function stringify(value){try{return JSON.stringify(value);}catch(err){return Math.random();}}var useWatchWarning=process.env.NODE_ENV!=='production'?function(namePath){var fullyStr=namePath.join('__RC_FIELD_FORM_SPLIT__');var nameStrRef=useRef(fullyStr);warning(nameStrRef.current===fullyStr,'`useWatch` is not support dynamic `namePath`. Please provide static instead.');}:function(){};// ------- selector type -------\n// ------- selector type end -------\nfunction useWatch(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}var dependencies=args[0],_args$=args[1],_form=_args$===void 0?{}:_args$;var options=isFormInstance(_form)?{form:_form}:_form;var form=options.form;var _useState=useState(),_useState2=_slicedToArray(_useState,2),value=_useState2[0],setValue=_useState2[1];var valueStr=useMemo(function(){return stringify(value);},[value]);var valueStrRef=useRef(valueStr);valueStrRef.current=valueStr;var fieldContext=useContext(FieldContext);var formInstance=form||fieldContext;var isValidForm=formInstance&&formInstance._init;// Warning if not exist form instance\nif(process.env.NODE_ENV!=='production'){warning(args.length===2?form?isValidForm:true:isValidForm,'useWatch requires a form instance since it can not auto detect from context.');}var namePath=getNamePath(dependencies);var namePathRef=useRef(namePath);namePathRef.current=namePath;useWatchWarning(namePath);useEffect(function(){// Skip if not exist form instance\nif(!isValidForm){return;}var getFieldsValue=formInstance.getFieldsValue,getInternalHooks=formInstance.getInternalHooks;var _getInternalHooks=getInternalHooks(HOOK_MARK),registerWatch=_getInternalHooks.registerWatch;var getWatchValue=function getWatchValue(values,allValues){var watchValue=options.preserve?allValues:values;return typeof dependencies==='function'?dependencies(watchValue):getValue(watchValue,namePathRef.current);};var cancelRegister=registerWatch(function(values,allValues){var newValue=getWatchValue(values,allValues);var nextValueStr=stringify(newValue);// Compare stringify in case it's nest object\nif(valueStrRef.current!==nextValueStr){valueStrRef.current=nextValueStr;setValue(newValue);}});// TODO: We can improve this perf in future\nvar initialValue=getWatchValue(getFieldsValue(),getFieldsValue(true));// React 18 has the bug that will queue update twice even the value is not changed\n// ref: https://github.com/facebook/react/issues/27213\nif(value!==initialValue){setValue(initialValue);}return cancelRegister;},// We do not need re-register since namePath content is the same\n// eslint-disable-next-line react-hooks/exhaustive-deps\n[isValidForm]);return value;}export default useWatch;","map":{"version":3,"names":["_slicedToArray","warning","useContext","useEffect","useMemo","useRef","useState","FieldContext","HOOK_MARK","isFormInstance","getNamePath","getValue","stringify","value","JSON","err","Math","random","useWatchWarning","process","env","NODE_ENV","namePath","fullyStr","join","nameStrRef","current","useWatch","_len","arguments","length","args","Array","_key","dependencies","_args$","_form","options","form","_useState","_useState2","setValue","valueStr","valueStrRef","fieldContext","formInstance","isValidForm","_init","namePathRef","getFieldsValue","getInternalHooks","_getInternalHooks","registerWatch","getWatchValue","values","allValues","watchValue","preserve","cancelRegister","newValue","nextValueStr","initialValue"],"sources":["/Users/jmmallon/Downloads/js/ticketproject/src/node_modules/rc-field-form/es/useWatch.js"],"sourcesContent":["import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport warning from \"rc-util/es/warning\";\nimport { useContext, useEffect, useMemo, useRef, useState } from 'react';\nimport FieldContext, { HOOK_MARK } from \"./FieldContext\";\nimport { isFormInstance } from \"./utils/typeUtil\";\nimport { getNamePath, getValue } from \"./utils/valueUtil\";\nexport function stringify(value) {\n  try {\n    return JSON.stringify(value);\n  } catch (err) {\n    return Math.random();\n  }\n}\nvar useWatchWarning = process.env.NODE_ENV !== 'production' ? function (namePath) {\n  var fullyStr = namePath.join('__RC_FIELD_FORM_SPLIT__');\n  var nameStrRef = useRef(fullyStr);\n  warning(nameStrRef.current === fullyStr, '`useWatch` is not support dynamic `namePath`. Please provide static instead.');\n} : function () {};\n\n// ------- selector type -------\n\n// ------- selector type end -------\n\nfunction useWatch() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n  var dependencies = args[0],\n    _args$ = args[1],\n    _form = _args$ === void 0 ? {} : _args$;\n  var options = isFormInstance(_form) ? {\n    form: _form\n  } : _form;\n  var form = options.form;\n  var _useState = useState(),\n    _useState2 = _slicedToArray(_useState, 2),\n    value = _useState2[0],\n    setValue = _useState2[1];\n  var valueStr = useMemo(function () {\n    return stringify(value);\n  }, [value]);\n  var valueStrRef = useRef(valueStr);\n  valueStrRef.current = valueStr;\n  var fieldContext = useContext(FieldContext);\n  var formInstance = form || fieldContext;\n  var isValidForm = formInstance && formInstance._init;\n\n  // Warning if not exist form instance\n  if (process.env.NODE_ENV !== 'production') {\n    warning(args.length === 2 ? form ? isValidForm : true : isValidForm, 'useWatch requires a form instance since it can not auto detect from context.');\n  }\n  var namePath = getNamePath(dependencies);\n  var namePathRef = useRef(namePath);\n  namePathRef.current = namePath;\n  useWatchWarning(namePath);\n  useEffect(function () {\n    // Skip if not exist form instance\n    if (!isValidForm) {\n      return;\n    }\n    var getFieldsValue = formInstance.getFieldsValue,\n      getInternalHooks = formInstance.getInternalHooks;\n    var _getInternalHooks = getInternalHooks(HOOK_MARK),\n      registerWatch = _getInternalHooks.registerWatch;\n    var getWatchValue = function getWatchValue(values, allValues) {\n      var watchValue = options.preserve ? allValues : values;\n      return typeof dependencies === 'function' ? dependencies(watchValue) : getValue(watchValue, namePathRef.current);\n    };\n    var cancelRegister = registerWatch(function (values, allValues) {\n      var newValue = getWatchValue(values, allValues);\n      var nextValueStr = stringify(newValue);\n\n      // Compare stringify in case it's nest object\n      if (valueStrRef.current !== nextValueStr) {\n        valueStrRef.current = nextValueStr;\n        setValue(newValue);\n      }\n    });\n\n    // TODO: We can improve this perf in future\n    var initialValue = getWatchValue(getFieldsValue(), getFieldsValue(true));\n\n    // React 18 has the bug that will queue update twice even the value is not changed\n    // ref: https://github.com/facebook/react/issues/27213\n    if (value !== initialValue) {\n      setValue(initialValue);\n    }\n    return cancelRegister;\n  },\n  // We do not need re-register since namePath content is the same\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  [isValidForm]);\n  return value;\n}\nexport default useWatch;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}