{"ast":null,"code":"import _objectSpread from\"@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";import{isDOM}from\"rc-util/es/Dom/findDOMNode\";import isVisible from\"rc-util/es/Dom/isVisible\";import useEvent from\"rc-util/es/hooks/useEvent\";import useLayoutEffect from\"rc-util/es/hooks/useLayoutEffect\";import*as React from'react';import{collectScroller,getVisibleArea,getWin,toNum}from\"../util\";function getUnitOffset(size){var offset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var offsetStr=\"\".concat(offset);var cells=offsetStr.match(/^(.*)\\%$/);if(cells){return size*(parseFloat(cells[1])/100);}return parseFloat(offsetStr);}function getNumberOffset(rect,offset){var _ref=offset||[],_ref2=_slicedToArray(_ref,2),offsetX=_ref2[0],offsetY=_ref2[1];return[getUnitOffset(rect.width,offsetX),getUnitOffset(rect.height,offsetY)];}function splitPoints(){var points=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';return[points[0],points[1]];}function getAlignPoint(rect,points){var topBottom=points[0];var leftRight=points[1];var x;var y;// Top & Bottom\nif(topBottom==='t'){y=rect.y;}else if(topBottom==='b'){y=rect.y+rect.height;}else{y=rect.y+rect.height/2;}// Left & Right\nif(leftRight==='l'){x=rect.x;}else if(leftRight==='r'){x=rect.x+rect.width;}else{x=rect.x+rect.width/2;}return{x:x,y:y};}function reversePoints(points,index){var reverseMap={t:'b',b:'t',l:'r',r:'l'};return points.map(function(point,i){if(i===index){return reverseMap[point]||'c';}return point;}).join('');}export default function useAlign(open,popupEle,target,placement,builtinPlacements,popupAlign,onPopupAlign){var _React$useState=React.useState({ready:false,offsetX:0,offsetY:0,offsetR:0,offsetB:0,arrowX:0,arrowY:0,scaleX:1,scaleY:1,align:builtinPlacements[placement]||{}}),_React$useState2=_slicedToArray(_React$useState,2),offsetInfo=_React$useState2[0],setOffsetInfo=_React$useState2[1];var alignCountRef=React.useRef(0);var scrollerList=React.useMemo(function(){if(!popupEle){return[];}return collectScroller(popupEle);},[popupEle]);// ========================= Flip ==========================\n// We will memo flip info.\n// If size change to make flip, it will memo the flip info and use it in next align.\nvar prevFlipRef=React.useRef({});var resetFlipCache=function resetFlipCache(){prevFlipRef.current={};};if(!open){resetFlipCache();}// ========================= Align =========================\nvar onAlign=useEvent(function(){if(popupEle&&target&&open){var _popupElement$parentE,_popupElement$parentE2;var popupElement=popupEle;var doc=popupElement.ownerDocument;var win=getWin(popupElement);var _win$getComputedStyle=win.getComputedStyle(popupElement),width=_win$getComputedStyle.width,height=_win$getComputedStyle.height,popupPosition=_win$getComputedStyle.position;var originLeft=popupElement.style.left;var originTop=popupElement.style.top;var originRight=popupElement.style.right;var originBottom=popupElement.style.bottom;var originOverflow=popupElement.style.overflow;// Placement\nvar placementInfo=_objectSpread(_objectSpread({},builtinPlacements[placement]),popupAlign);// placeholder element\nvar placeholderElement=doc.createElement('div');(_popupElement$parentE=popupElement.parentElement)===null||_popupElement$parentE===void 0||_popupElement$parentE.appendChild(placeholderElement);placeholderElement.style.left=\"\".concat(popupElement.offsetLeft,\"px\");placeholderElement.style.top=\"\".concat(popupElement.offsetTop,\"px\");placeholderElement.style.position=popupPosition;placeholderElement.style.height=\"\".concat(popupElement.offsetHeight,\"px\");placeholderElement.style.width=\"\".concat(popupElement.offsetWidth,\"px\");// Reset first\npopupElement.style.left='0';popupElement.style.top='0';popupElement.style.right='auto';popupElement.style.bottom='auto';popupElement.style.overflow='hidden';// Calculate align style, we should consider `transform` case\nvar targetRect;if(Array.isArray(target)){targetRect={x:target[0],y:target[1],width:0,height:0};}else{var rect=target.getBoundingClientRect();targetRect={x:rect.x,y:rect.y,width:rect.width,height:rect.height};}var popupRect=popupElement.getBoundingClientRect();var _doc$documentElement=doc.documentElement,clientWidth=_doc$documentElement.clientWidth,clientHeight=_doc$documentElement.clientHeight,scrollWidth=_doc$documentElement.scrollWidth,scrollHeight=_doc$documentElement.scrollHeight,scrollTop=_doc$documentElement.scrollTop,scrollLeft=_doc$documentElement.scrollLeft;var popupHeight=popupRect.height;var popupWidth=popupRect.width;var targetHeight=targetRect.height;var targetWidth=targetRect.width;// Get bounding of visible area\nvar visibleRegion={left:0,top:0,right:clientWidth,bottom:clientHeight};var scrollRegion={left:-scrollLeft,top:-scrollTop,right:scrollWidth-scrollLeft,bottom:scrollHeight-scrollTop};var htmlRegion=placementInfo.htmlRegion;var VISIBLE='visible';var VISIBLE_FIRST='visibleFirst';if(htmlRegion!=='scroll'&&htmlRegion!==VISIBLE_FIRST){htmlRegion=VISIBLE;}var isVisibleFirst=htmlRegion===VISIBLE_FIRST;var scrollRegionArea=getVisibleArea(scrollRegion,scrollerList);var visibleRegionArea=getVisibleArea(visibleRegion,scrollerList);var visibleArea=htmlRegion===VISIBLE?visibleRegionArea:scrollRegionArea;// When set to `visibleFirst`,\n// the check `adjust` logic will use `visibleRegion` for check first.\nvar adjustCheckVisibleArea=isVisibleFirst?visibleRegionArea:visibleArea;// Record right & bottom align data\npopupElement.style.left='auto';popupElement.style.top='auto';popupElement.style.right='0';popupElement.style.bottom='0';var popupMirrorRect=popupElement.getBoundingClientRect();// Reset back\npopupElement.style.left=originLeft;popupElement.style.top=originTop;popupElement.style.right=originRight;popupElement.style.bottom=originBottom;popupElement.style.overflow=originOverflow;(_popupElement$parentE2=popupElement.parentElement)===null||_popupElement$parentE2===void 0||_popupElement$parentE2.removeChild(placeholderElement);// Calculate scale\nvar _scaleX=toNum(Math.round(popupWidth/parseFloat(width)*1000)/1000);var _scaleY=toNum(Math.round(popupHeight/parseFloat(height)*1000)/1000);// No need to align since it's not visible in view\nif(_scaleX===0||_scaleY===0||isDOM(target)&&!isVisible(target)){return;}// Offset\nvar offset=placementInfo.offset,targetOffset=placementInfo.targetOffset;var _getNumberOffset=getNumberOffset(popupRect,offset),_getNumberOffset2=_slicedToArray(_getNumberOffset,2),popupOffsetX=_getNumberOffset2[0],popupOffsetY=_getNumberOffset2[1];var _getNumberOffset3=getNumberOffset(targetRect,targetOffset),_getNumberOffset4=_slicedToArray(_getNumberOffset3,2),targetOffsetX=_getNumberOffset4[0],targetOffsetY=_getNumberOffset4[1];targetRect.x-=targetOffsetX;targetRect.y-=targetOffsetY;// Points\nvar _ref3=placementInfo.points||[],_ref4=_slicedToArray(_ref3,2),popupPoint=_ref4[0],targetPoint=_ref4[1];var targetPoints=splitPoints(targetPoint);var popupPoints=splitPoints(popupPoint);var targetAlignPoint=getAlignPoint(targetRect,targetPoints);var popupAlignPoint=getAlignPoint(popupRect,popupPoints);// Real align info may not same as origin one\nvar nextAlignInfo=_objectSpread({},placementInfo);// Next Offset\nvar nextOffsetX=targetAlignPoint.x-popupAlignPoint.x+popupOffsetX;var nextOffsetY=targetAlignPoint.y-popupAlignPoint.y+popupOffsetY;// ============== Intersection ===============\n// Get area by position. Used for check if flip area is better\nfunction getIntersectionVisibleArea(offsetX,offsetY){var area=arguments.length>2&&arguments[2]!==undefined?arguments[2]:visibleArea;var l=popupRect.x+offsetX;var t=popupRect.y+offsetY;var r=l+popupWidth;var b=t+popupHeight;var visibleL=Math.max(l,area.left);var visibleT=Math.max(t,area.top);var visibleR=Math.min(r,area.right);var visibleB=Math.min(b,area.bottom);return Math.max(0,(visibleR-visibleL)*(visibleB-visibleT));}var originIntersectionVisibleArea=getIntersectionVisibleArea(nextOffsetX,nextOffsetY);// As `visibleFirst`, we prepare this for check\nvar originIntersectionRecommendArea=getIntersectionVisibleArea(nextOffsetX,nextOffsetY,visibleRegionArea);// ========================== Overflow ===========================\nvar targetAlignPointTL=getAlignPoint(targetRect,['t','l']);var popupAlignPointTL=getAlignPoint(popupRect,['t','l']);var targetAlignPointBR=getAlignPoint(targetRect,['b','r']);var popupAlignPointBR=getAlignPoint(popupRect,['b','r']);var overflow=placementInfo.overflow||{};var adjustX=overflow.adjustX,adjustY=overflow.adjustY,shiftX=overflow.shiftX,shiftY=overflow.shiftY;var supportAdjust=function supportAdjust(val){if(typeof val==='boolean'){return val;}return val>=0;};// Prepare position\nvar nextPopupY;var nextPopupBottom;var nextPopupX;var nextPopupRight;function syncNextPopupPosition(){nextPopupY=popupRect.y+nextOffsetY;nextPopupBottom=nextPopupY+popupHeight;nextPopupX=popupRect.x+nextOffsetX;nextPopupRight=nextPopupX+popupWidth;}syncNextPopupPosition();// >>>>>>>>>> Top & Bottom\nvar needAdjustY=supportAdjust(adjustY);var sameTB=popupPoints[0]===targetPoints[0];// Bottom to Top\nif(needAdjustY&&popupPoints[0]==='t'&&(nextPopupBottom>adjustCheckVisibleArea.bottom||prevFlipRef.current.bt)){var tmpNextOffsetY=nextOffsetY;if(sameTB){tmpNextOffsetY-=popupHeight-targetHeight;}else{tmpNextOffsetY=targetAlignPointTL.y-popupAlignPointBR.y-popupOffsetY;}var newVisibleArea=getIntersectionVisibleArea(nextOffsetX,tmpNextOffsetY);var newVisibleRecommendArea=getIntersectionVisibleArea(nextOffsetX,tmpNextOffsetY,visibleRegionArea);if(// Of course use larger one\nnewVisibleArea>originIntersectionVisibleArea||newVisibleArea===originIntersectionVisibleArea&&(!isVisibleFirst||// Choose recommend one\nnewVisibleRecommendArea>=originIntersectionRecommendArea)){prevFlipRef.current.bt=true;nextOffsetY=tmpNextOffsetY;popupOffsetY=-popupOffsetY;nextAlignInfo.points=[reversePoints(popupPoints,0),reversePoints(targetPoints,0)];}else{prevFlipRef.current.bt=false;}}// Top to Bottom\nif(needAdjustY&&popupPoints[0]==='b'&&(nextPopupY<adjustCheckVisibleArea.top||prevFlipRef.current.tb)){var _tmpNextOffsetY=nextOffsetY;if(sameTB){_tmpNextOffsetY+=popupHeight-targetHeight;}else{_tmpNextOffsetY=targetAlignPointBR.y-popupAlignPointTL.y-popupOffsetY;}var _newVisibleArea=getIntersectionVisibleArea(nextOffsetX,_tmpNextOffsetY);var _newVisibleRecommendArea=getIntersectionVisibleArea(nextOffsetX,_tmpNextOffsetY,visibleRegionArea);if(// Of course use larger one\n_newVisibleArea>originIntersectionVisibleArea||_newVisibleArea===originIntersectionVisibleArea&&(!isVisibleFirst||// Choose recommend one\n_newVisibleRecommendArea>=originIntersectionRecommendArea)){prevFlipRef.current.tb=true;nextOffsetY=_tmpNextOffsetY;popupOffsetY=-popupOffsetY;nextAlignInfo.points=[reversePoints(popupPoints,0),reversePoints(targetPoints,0)];}else{prevFlipRef.current.tb=false;}}// >>>>>>>>>> Left & Right\nvar needAdjustX=supportAdjust(adjustX);// >>>>> Flip\nvar sameLR=popupPoints[1]===targetPoints[1];// Right to Left\nif(needAdjustX&&popupPoints[1]==='l'&&(nextPopupRight>adjustCheckVisibleArea.right||prevFlipRef.current.rl)){var tmpNextOffsetX=nextOffsetX;if(sameLR){tmpNextOffsetX-=popupWidth-targetWidth;}else{tmpNextOffsetX=targetAlignPointTL.x-popupAlignPointBR.x-popupOffsetX;}var _newVisibleArea2=getIntersectionVisibleArea(tmpNextOffsetX,nextOffsetY);var _newVisibleRecommendArea2=getIntersectionVisibleArea(tmpNextOffsetX,nextOffsetY,visibleRegionArea);if(// Of course use larger one\n_newVisibleArea2>originIntersectionVisibleArea||_newVisibleArea2===originIntersectionVisibleArea&&(!isVisibleFirst||// Choose recommend one\n_newVisibleRecommendArea2>=originIntersectionRecommendArea)){prevFlipRef.current.rl=true;nextOffsetX=tmpNextOffsetX;popupOffsetX=-popupOffsetX;nextAlignInfo.points=[reversePoints(popupPoints,1),reversePoints(targetPoints,1)];}else{prevFlipRef.current.rl=false;}}// Left to Right\nif(needAdjustX&&popupPoints[1]==='r'&&(nextPopupX<adjustCheckVisibleArea.left||prevFlipRef.current.lr)){var _tmpNextOffsetX=nextOffsetX;if(sameLR){_tmpNextOffsetX+=popupWidth-targetWidth;}else{_tmpNextOffsetX=targetAlignPointBR.x-popupAlignPointTL.x-popupOffsetX;}var _newVisibleArea3=getIntersectionVisibleArea(_tmpNextOffsetX,nextOffsetY);var _newVisibleRecommendArea3=getIntersectionVisibleArea(_tmpNextOffsetX,nextOffsetY,visibleRegionArea);if(// Of course use larger one\n_newVisibleArea3>originIntersectionVisibleArea||_newVisibleArea3===originIntersectionVisibleArea&&(!isVisibleFirst||// Choose recommend one\n_newVisibleRecommendArea3>=originIntersectionRecommendArea)){prevFlipRef.current.lr=true;nextOffsetX=_tmpNextOffsetX;popupOffsetX=-popupOffsetX;nextAlignInfo.points=[reversePoints(popupPoints,1),reversePoints(targetPoints,1)];}else{prevFlipRef.current.lr=false;}}// ============================ Shift ============================\nsyncNextPopupPosition();var numShiftX=shiftX===true?0:shiftX;if(typeof numShiftX==='number'){// Left\nif(nextPopupX<visibleRegionArea.left){nextOffsetX-=nextPopupX-visibleRegionArea.left-popupOffsetX;if(targetRect.x+targetWidth<visibleRegionArea.left+numShiftX){nextOffsetX+=targetRect.x-visibleRegionArea.left+targetWidth-numShiftX;}}// Right\nif(nextPopupRight>visibleRegionArea.right){nextOffsetX-=nextPopupRight-visibleRegionArea.right-popupOffsetX;if(targetRect.x>visibleRegionArea.right-numShiftX){nextOffsetX+=targetRect.x-visibleRegionArea.right+numShiftX;}}}var numShiftY=shiftY===true?0:shiftY;if(typeof numShiftY==='number'){// Top\nif(nextPopupY<visibleRegionArea.top){nextOffsetY-=nextPopupY-visibleRegionArea.top-popupOffsetY;// When target if far away from visible area\n// Stop shift\nif(targetRect.y+targetHeight<visibleRegionArea.top+numShiftY){nextOffsetY+=targetRect.y-visibleRegionArea.top+targetHeight-numShiftY;}}// Bottom\nif(nextPopupBottom>visibleRegionArea.bottom){nextOffsetY-=nextPopupBottom-visibleRegionArea.bottom-popupOffsetY;if(targetRect.y>visibleRegionArea.bottom-numShiftY){nextOffsetY+=targetRect.y-visibleRegionArea.bottom+numShiftY;}}}// ============================ Arrow ============================\n// Arrow center align\nvar popupLeft=popupRect.x+nextOffsetX;var popupRight=popupLeft+popupWidth;var popupTop=popupRect.y+nextOffsetY;var popupBottom=popupTop+popupHeight;var targetLeft=targetRect.x;var targetRight=targetLeft+targetWidth;var targetTop=targetRect.y;var targetBottom=targetTop+targetHeight;var maxLeft=Math.max(popupLeft,targetLeft);var minRight=Math.min(popupRight,targetRight);var xCenter=(maxLeft+minRight)/2;var nextArrowX=xCenter-popupLeft;var maxTop=Math.max(popupTop,targetTop);var minBottom=Math.min(popupBottom,targetBottom);var yCenter=(maxTop+minBottom)/2;var nextArrowY=yCenter-popupTop;onPopupAlign===null||onPopupAlign===void 0||onPopupAlign(popupEle,nextAlignInfo);// Additional calculate right & bottom position\nvar offsetX4Right=popupMirrorRect.right-popupRect.x-(nextOffsetX+popupRect.width);var offsetY4Bottom=popupMirrorRect.bottom-popupRect.y-(nextOffsetY+popupRect.height);setOffsetInfo({ready:true,offsetX:nextOffsetX/_scaleX,offsetY:nextOffsetY/_scaleY,offsetR:offsetX4Right/_scaleX,offsetB:offsetY4Bottom/_scaleY,arrowX:nextArrowX/_scaleX,arrowY:nextArrowY/_scaleY,scaleX:_scaleX,scaleY:_scaleY,align:nextAlignInfo});}});var triggerAlign=function triggerAlign(){alignCountRef.current+=1;var id=alignCountRef.current;// Merge all align requirement into one frame\nPromise.resolve().then(function(){if(alignCountRef.current===id){onAlign();}});};// Reset ready status when placement & open changed\nvar resetReady=function resetReady(){setOffsetInfo(function(ori){return _objectSpread(_objectSpread({},ori),{},{ready:false});});};useLayoutEffect(resetReady,[placement]);useLayoutEffect(function(){if(!open){resetReady();}},[open]);return[offsetInfo.ready,offsetInfo.offsetX,offsetInfo.offsetY,offsetInfo.offsetR,offsetInfo.offsetB,offsetInfo.arrowX,offsetInfo.arrowY,offsetInfo.scaleX,offsetInfo.scaleY,offsetInfo.align,triggerAlign];}","map":{"version":3,"names":["_objectSpread","_slicedToArray","isDOM","isVisible","useEvent","useLayoutEffect","React","collectScroller","getVisibleArea","getWin","toNum","getUnitOffset","size","offset","arguments","length","undefined","offsetStr","concat","cells","match","parseFloat","getNumberOffset","rect","_ref","_ref2","offsetX","offsetY","width","height","splitPoints","points","getAlignPoint","topBottom","leftRight","x","y","reversePoints","index","reverseMap","t","b","l","r","map","point","i","join","useAlign","open","popupEle","target","placement","builtinPlacements","popupAlign","onPopupAlign","_React$useState","useState","ready","offsetR","offsetB","arrowX","arrowY","scaleX","scaleY","align","_React$useState2","offsetInfo","setOffsetInfo","alignCountRef","useRef","scrollerList","useMemo","prevFlipRef","resetFlipCache","current","onAlign","_popupElement$parentE","_popupElement$parentE2","popupElement","doc","ownerDocument","win","_win$getComputedStyle","getComputedStyle","popupPosition","position","originLeft","style","left","originTop","top","originRight","right","originBottom","bottom","originOverflow","overflow","placementInfo","placeholderElement","createElement","parentElement","appendChild","offsetLeft","offsetTop","offsetHeight","offsetWidth","targetRect","Array","isArray","getBoundingClientRect","popupRect","_doc$documentElement","documentElement","clientWidth","clientHeight","scrollWidth","scrollHeight","scrollTop","scrollLeft","popupHeight","popupWidth","targetHeight","targetWidth","visibleRegion","scrollRegion","htmlRegion","VISIBLE","VISIBLE_FIRST","isVisibleFirst","scrollRegionArea","visibleRegionArea","visibleArea","adjustCheckVisibleArea","popupMirrorRect","removeChild","_scaleX","Math","round","_scaleY","targetOffset","_getNumberOffset","_getNumberOffset2","popupOffsetX","popupOffsetY","_getNumberOffset3","_getNumberOffset4","targetOffsetX","targetOffsetY","_ref3","_ref4","popupPoint","targetPoint","targetPoints","popupPoints","targetAlignPoint","popupAlignPoint","nextAlignInfo","nextOffsetX","nextOffsetY","getIntersectionVisibleArea","area","visibleL","max","visibleT","visibleR","min","visibleB","originIntersectionVisibleArea","originIntersectionRecommendArea","targetAlignPointTL","popupAlignPointTL","targetAlignPointBR","popupAlignPointBR","adjustX","adjustY","shiftX","shiftY","supportAdjust","val","nextPopupY","nextPopupBottom","nextPopupX","nextPopupRight","syncNextPopupPosition","needAdjustY","sameTB","bt","tmpNextOffsetY","newVisibleArea","newVisibleRecommendArea","tb","_tmpNextOffsetY","_newVisibleArea","_newVisibleRecommendArea","needAdjustX","sameLR","rl","tmpNextOffsetX","_newVisibleArea2","_newVisibleRecommendArea2","lr","_tmpNextOffsetX","_newVisibleArea3","_newVisibleRecommendArea3","numShiftX","numShiftY","popupLeft","popupRight","popupTop","popupBottom","targetLeft","targetRight","targetTop","targetBottom","maxLeft","minRight","xCenter","nextArrowX","maxTop","minBottom","yCenter","nextArrowY","offsetX4Right","offsetY4Bottom","triggerAlign","id","Promise","resolve","then","resetReady","ori"],"sources":["/Users/jmmallon/Downloads/js/ticketproject/src/node_modules/@rc-component/trigger/es/hooks/useAlign.js"],"sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport { isDOM } from \"rc-util/es/Dom/findDOMNode\";\nimport isVisible from \"rc-util/es/Dom/isVisible\";\nimport useEvent from \"rc-util/es/hooks/useEvent\";\nimport useLayoutEffect from \"rc-util/es/hooks/useLayoutEffect\";\nimport * as React from 'react';\nimport { collectScroller, getVisibleArea, getWin, toNum } from \"../util\";\nfunction getUnitOffset(size) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var offsetStr = \"\".concat(offset);\n  var cells = offsetStr.match(/^(.*)\\%$/);\n  if (cells) {\n    return size * (parseFloat(cells[1]) / 100);\n  }\n  return parseFloat(offsetStr);\n}\nfunction getNumberOffset(rect, offset) {\n  var _ref = offset || [],\n    _ref2 = _slicedToArray(_ref, 2),\n    offsetX = _ref2[0],\n    offsetY = _ref2[1];\n  return [getUnitOffset(rect.width, offsetX), getUnitOffset(rect.height, offsetY)];\n}\nfunction splitPoints() {\n  var points = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  return [points[0], points[1]];\n}\nfunction getAlignPoint(rect, points) {\n  var topBottom = points[0];\n  var leftRight = points[1];\n  var x;\n  var y;\n\n  // Top & Bottom\n  if (topBottom === 't') {\n    y = rect.y;\n  } else if (topBottom === 'b') {\n    y = rect.y + rect.height;\n  } else {\n    y = rect.y + rect.height / 2;\n  }\n\n  // Left & Right\n  if (leftRight === 'l') {\n    x = rect.x;\n  } else if (leftRight === 'r') {\n    x = rect.x + rect.width;\n  } else {\n    x = rect.x + rect.width / 2;\n  }\n  return {\n    x: x,\n    y: y\n  };\n}\nfunction reversePoints(points, index) {\n  var reverseMap = {\n    t: 'b',\n    b: 't',\n    l: 'r',\n    r: 'l'\n  };\n  return points.map(function (point, i) {\n    if (i === index) {\n      return reverseMap[point] || 'c';\n    }\n    return point;\n  }).join('');\n}\nexport default function useAlign(open, popupEle, target, placement, builtinPlacements, popupAlign, onPopupAlign) {\n  var _React$useState = React.useState({\n      ready: false,\n      offsetX: 0,\n      offsetY: 0,\n      offsetR: 0,\n      offsetB: 0,\n      arrowX: 0,\n      arrowY: 0,\n      scaleX: 1,\n      scaleY: 1,\n      align: builtinPlacements[placement] || {}\n    }),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    offsetInfo = _React$useState2[0],\n    setOffsetInfo = _React$useState2[1];\n  var alignCountRef = React.useRef(0);\n  var scrollerList = React.useMemo(function () {\n    if (!popupEle) {\n      return [];\n    }\n    return collectScroller(popupEle);\n  }, [popupEle]);\n\n  // ========================= Flip ==========================\n  // We will memo flip info.\n  // If size change to make flip, it will memo the flip info and use it in next align.\n  var prevFlipRef = React.useRef({});\n  var resetFlipCache = function resetFlipCache() {\n    prevFlipRef.current = {};\n  };\n  if (!open) {\n    resetFlipCache();\n  }\n\n  // ========================= Align =========================\n  var onAlign = useEvent(function () {\n    if (popupEle && target && open) {\n      var _popupElement$parentE, _popupElement$parentE2;\n      var popupElement = popupEle;\n      var doc = popupElement.ownerDocument;\n      var win = getWin(popupElement);\n      var _win$getComputedStyle = win.getComputedStyle(popupElement),\n        width = _win$getComputedStyle.width,\n        height = _win$getComputedStyle.height,\n        popupPosition = _win$getComputedStyle.position;\n      var originLeft = popupElement.style.left;\n      var originTop = popupElement.style.top;\n      var originRight = popupElement.style.right;\n      var originBottom = popupElement.style.bottom;\n      var originOverflow = popupElement.style.overflow;\n\n      // Placement\n      var placementInfo = _objectSpread(_objectSpread({}, builtinPlacements[placement]), popupAlign);\n\n      // placeholder element\n      var placeholderElement = doc.createElement('div');\n      (_popupElement$parentE = popupElement.parentElement) === null || _popupElement$parentE === void 0 || _popupElement$parentE.appendChild(placeholderElement);\n      placeholderElement.style.left = \"\".concat(popupElement.offsetLeft, \"px\");\n      placeholderElement.style.top = \"\".concat(popupElement.offsetTop, \"px\");\n      placeholderElement.style.position = popupPosition;\n      placeholderElement.style.height = \"\".concat(popupElement.offsetHeight, \"px\");\n      placeholderElement.style.width = \"\".concat(popupElement.offsetWidth, \"px\");\n\n      // Reset first\n      popupElement.style.left = '0';\n      popupElement.style.top = '0';\n      popupElement.style.right = 'auto';\n      popupElement.style.bottom = 'auto';\n      popupElement.style.overflow = 'hidden';\n\n      // Calculate align style, we should consider `transform` case\n      var targetRect;\n      if (Array.isArray(target)) {\n        targetRect = {\n          x: target[0],\n          y: target[1],\n          width: 0,\n          height: 0\n        };\n      } else {\n        var rect = target.getBoundingClientRect();\n        targetRect = {\n          x: rect.x,\n          y: rect.y,\n          width: rect.width,\n          height: rect.height\n        };\n      }\n      var popupRect = popupElement.getBoundingClientRect();\n      var _doc$documentElement = doc.documentElement,\n        clientWidth = _doc$documentElement.clientWidth,\n        clientHeight = _doc$documentElement.clientHeight,\n        scrollWidth = _doc$documentElement.scrollWidth,\n        scrollHeight = _doc$documentElement.scrollHeight,\n        scrollTop = _doc$documentElement.scrollTop,\n        scrollLeft = _doc$documentElement.scrollLeft;\n      var popupHeight = popupRect.height;\n      var popupWidth = popupRect.width;\n      var targetHeight = targetRect.height;\n      var targetWidth = targetRect.width;\n\n      // Get bounding of visible area\n      var visibleRegion = {\n        left: 0,\n        top: 0,\n        right: clientWidth,\n        bottom: clientHeight\n      };\n      var scrollRegion = {\n        left: -scrollLeft,\n        top: -scrollTop,\n        right: scrollWidth - scrollLeft,\n        bottom: scrollHeight - scrollTop\n      };\n      var htmlRegion = placementInfo.htmlRegion;\n      var VISIBLE = 'visible';\n      var VISIBLE_FIRST = 'visibleFirst';\n      if (htmlRegion !== 'scroll' && htmlRegion !== VISIBLE_FIRST) {\n        htmlRegion = VISIBLE;\n      }\n      var isVisibleFirst = htmlRegion === VISIBLE_FIRST;\n      var scrollRegionArea = getVisibleArea(scrollRegion, scrollerList);\n      var visibleRegionArea = getVisibleArea(visibleRegion, scrollerList);\n      var visibleArea = htmlRegion === VISIBLE ? visibleRegionArea : scrollRegionArea;\n\n      // When set to `visibleFirst`,\n      // the check `adjust` logic will use `visibleRegion` for check first.\n      var adjustCheckVisibleArea = isVisibleFirst ? visibleRegionArea : visibleArea;\n\n      // Record right & bottom align data\n      popupElement.style.left = 'auto';\n      popupElement.style.top = 'auto';\n      popupElement.style.right = '0';\n      popupElement.style.bottom = '0';\n      var popupMirrorRect = popupElement.getBoundingClientRect();\n\n      // Reset back\n      popupElement.style.left = originLeft;\n      popupElement.style.top = originTop;\n      popupElement.style.right = originRight;\n      popupElement.style.bottom = originBottom;\n      popupElement.style.overflow = originOverflow;\n      (_popupElement$parentE2 = popupElement.parentElement) === null || _popupElement$parentE2 === void 0 || _popupElement$parentE2.removeChild(placeholderElement);\n\n      // Calculate scale\n      var _scaleX = toNum(Math.round(popupWidth / parseFloat(width) * 1000) / 1000);\n      var _scaleY = toNum(Math.round(popupHeight / parseFloat(height) * 1000) / 1000);\n\n      // No need to align since it's not visible in view\n      if (_scaleX === 0 || _scaleY === 0 || isDOM(target) && !isVisible(target)) {\n        return;\n      }\n\n      // Offset\n      var offset = placementInfo.offset,\n        targetOffset = placementInfo.targetOffset;\n      var _getNumberOffset = getNumberOffset(popupRect, offset),\n        _getNumberOffset2 = _slicedToArray(_getNumberOffset, 2),\n        popupOffsetX = _getNumberOffset2[0],\n        popupOffsetY = _getNumberOffset2[1];\n      var _getNumberOffset3 = getNumberOffset(targetRect, targetOffset),\n        _getNumberOffset4 = _slicedToArray(_getNumberOffset3, 2),\n        targetOffsetX = _getNumberOffset4[0],\n        targetOffsetY = _getNumberOffset4[1];\n      targetRect.x -= targetOffsetX;\n      targetRect.y -= targetOffsetY;\n\n      // Points\n      var _ref3 = placementInfo.points || [],\n        _ref4 = _slicedToArray(_ref3, 2),\n        popupPoint = _ref4[0],\n        targetPoint = _ref4[1];\n      var targetPoints = splitPoints(targetPoint);\n      var popupPoints = splitPoints(popupPoint);\n      var targetAlignPoint = getAlignPoint(targetRect, targetPoints);\n      var popupAlignPoint = getAlignPoint(popupRect, popupPoints);\n\n      // Real align info may not same as origin one\n      var nextAlignInfo = _objectSpread({}, placementInfo);\n\n      // Next Offset\n      var nextOffsetX = targetAlignPoint.x - popupAlignPoint.x + popupOffsetX;\n      var nextOffsetY = targetAlignPoint.y - popupAlignPoint.y + popupOffsetY;\n\n      // ============== Intersection ===============\n      // Get area by position. Used for check if flip area is better\n      function getIntersectionVisibleArea(offsetX, offsetY) {\n        var area = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : visibleArea;\n        var l = popupRect.x + offsetX;\n        var t = popupRect.y + offsetY;\n        var r = l + popupWidth;\n        var b = t + popupHeight;\n        var visibleL = Math.max(l, area.left);\n        var visibleT = Math.max(t, area.top);\n        var visibleR = Math.min(r, area.right);\n        var visibleB = Math.min(b, area.bottom);\n        return Math.max(0, (visibleR - visibleL) * (visibleB - visibleT));\n      }\n      var originIntersectionVisibleArea = getIntersectionVisibleArea(nextOffsetX, nextOffsetY);\n\n      // As `visibleFirst`, we prepare this for check\n      var originIntersectionRecommendArea = getIntersectionVisibleArea(nextOffsetX, nextOffsetY, visibleRegionArea);\n\n      // ========================== Overflow ===========================\n      var targetAlignPointTL = getAlignPoint(targetRect, ['t', 'l']);\n      var popupAlignPointTL = getAlignPoint(popupRect, ['t', 'l']);\n      var targetAlignPointBR = getAlignPoint(targetRect, ['b', 'r']);\n      var popupAlignPointBR = getAlignPoint(popupRect, ['b', 'r']);\n      var overflow = placementInfo.overflow || {};\n      var adjustX = overflow.adjustX,\n        adjustY = overflow.adjustY,\n        shiftX = overflow.shiftX,\n        shiftY = overflow.shiftY;\n      var supportAdjust = function supportAdjust(val) {\n        if (typeof val === 'boolean') {\n          return val;\n        }\n        return val >= 0;\n      };\n\n      // Prepare position\n      var nextPopupY;\n      var nextPopupBottom;\n      var nextPopupX;\n      var nextPopupRight;\n      function syncNextPopupPosition() {\n        nextPopupY = popupRect.y + nextOffsetY;\n        nextPopupBottom = nextPopupY + popupHeight;\n        nextPopupX = popupRect.x + nextOffsetX;\n        nextPopupRight = nextPopupX + popupWidth;\n      }\n      syncNextPopupPosition();\n\n      // >>>>>>>>>> Top & Bottom\n      var needAdjustY = supportAdjust(adjustY);\n      var sameTB = popupPoints[0] === targetPoints[0];\n\n      // Bottom to Top\n      if (needAdjustY && popupPoints[0] === 't' && (nextPopupBottom > adjustCheckVisibleArea.bottom || prevFlipRef.current.bt)) {\n        var tmpNextOffsetY = nextOffsetY;\n        if (sameTB) {\n          tmpNextOffsetY -= popupHeight - targetHeight;\n        } else {\n          tmpNextOffsetY = targetAlignPointTL.y - popupAlignPointBR.y - popupOffsetY;\n        }\n        var newVisibleArea = getIntersectionVisibleArea(nextOffsetX, tmpNextOffsetY);\n        var newVisibleRecommendArea = getIntersectionVisibleArea(nextOffsetX, tmpNextOffsetY, visibleRegionArea);\n        if (\n        // Of course use larger one\n        newVisibleArea > originIntersectionVisibleArea || newVisibleArea === originIntersectionVisibleArea && (!isVisibleFirst ||\n        // Choose recommend one\n        newVisibleRecommendArea >= originIntersectionRecommendArea)) {\n          prevFlipRef.current.bt = true;\n          nextOffsetY = tmpNextOffsetY;\n          popupOffsetY = -popupOffsetY;\n          nextAlignInfo.points = [reversePoints(popupPoints, 0), reversePoints(targetPoints, 0)];\n        } else {\n          prevFlipRef.current.bt = false;\n        }\n      }\n\n      // Top to Bottom\n      if (needAdjustY && popupPoints[0] === 'b' && (nextPopupY < adjustCheckVisibleArea.top || prevFlipRef.current.tb)) {\n        var _tmpNextOffsetY = nextOffsetY;\n        if (sameTB) {\n          _tmpNextOffsetY += popupHeight - targetHeight;\n        } else {\n          _tmpNextOffsetY = targetAlignPointBR.y - popupAlignPointTL.y - popupOffsetY;\n        }\n        var _newVisibleArea = getIntersectionVisibleArea(nextOffsetX, _tmpNextOffsetY);\n        var _newVisibleRecommendArea = getIntersectionVisibleArea(nextOffsetX, _tmpNextOffsetY, visibleRegionArea);\n        if (\n        // Of course use larger one\n        _newVisibleArea > originIntersectionVisibleArea || _newVisibleArea === originIntersectionVisibleArea && (!isVisibleFirst ||\n        // Choose recommend one\n        _newVisibleRecommendArea >= originIntersectionRecommendArea)) {\n          prevFlipRef.current.tb = true;\n          nextOffsetY = _tmpNextOffsetY;\n          popupOffsetY = -popupOffsetY;\n          nextAlignInfo.points = [reversePoints(popupPoints, 0), reversePoints(targetPoints, 0)];\n        } else {\n          prevFlipRef.current.tb = false;\n        }\n      }\n\n      // >>>>>>>>>> Left & Right\n      var needAdjustX = supportAdjust(adjustX);\n\n      // >>>>> Flip\n      var sameLR = popupPoints[1] === targetPoints[1];\n\n      // Right to Left\n      if (needAdjustX && popupPoints[1] === 'l' && (nextPopupRight > adjustCheckVisibleArea.right || prevFlipRef.current.rl)) {\n        var tmpNextOffsetX = nextOffsetX;\n        if (sameLR) {\n          tmpNextOffsetX -= popupWidth - targetWidth;\n        } else {\n          tmpNextOffsetX = targetAlignPointTL.x - popupAlignPointBR.x - popupOffsetX;\n        }\n        var _newVisibleArea2 = getIntersectionVisibleArea(tmpNextOffsetX, nextOffsetY);\n        var _newVisibleRecommendArea2 = getIntersectionVisibleArea(tmpNextOffsetX, nextOffsetY, visibleRegionArea);\n        if (\n        // Of course use larger one\n        _newVisibleArea2 > originIntersectionVisibleArea || _newVisibleArea2 === originIntersectionVisibleArea && (!isVisibleFirst ||\n        // Choose recommend one\n        _newVisibleRecommendArea2 >= originIntersectionRecommendArea)) {\n          prevFlipRef.current.rl = true;\n          nextOffsetX = tmpNextOffsetX;\n          popupOffsetX = -popupOffsetX;\n          nextAlignInfo.points = [reversePoints(popupPoints, 1), reversePoints(targetPoints, 1)];\n        } else {\n          prevFlipRef.current.rl = false;\n        }\n      }\n\n      // Left to Right\n      if (needAdjustX && popupPoints[1] === 'r' && (nextPopupX < adjustCheckVisibleArea.left || prevFlipRef.current.lr)) {\n        var _tmpNextOffsetX = nextOffsetX;\n        if (sameLR) {\n          _tmpNextOffsetX += popupWidth - targetWidth;\n        } else {\n          _tmpNextOffsetX = targetAlignPointBR.x - popupAlignPointTL.x - popupOffsetX;\n        }\n        var _newVisibleArea3 = getIntersectionVisibleArea(_tmpNextOffsetX, nextOffsetY);\n        var _newVisibleRecommendArea3 = getIntersectionVisibleArea(_tmpNextOffsetX, nextOffsetY, visibleRegionArea);\n        if (\n        // Of course use larger one\n        _newVisibleArea3 > originIntersectionVisibleArea || _newVisibleArea3 === originIntersectionVisibleArea && (!isVisibleFirst ||\n        // Choose recommend one\n        _newVisibleRecommendArea3 >= originIntersectionRecommendArea)) {\n          prevFlipRef.current.lr = true;\n          nextOffsetX = _tmpNextOffsetX;\n          popupOffsetX = -popupOffsetX;\n          nextAlignInfo.points = [reversePoints(popupPoints, 1), reversePoints(targetPoints, 1)];\n        } else {\n          prevFlipRef.current.lr = false;\n        }\n      }\n\n      // ============================ Shift ============================\n      syncNextPopupPosition();\n      var numShiftX = shiftX === true ? 0 : shiftX;\n      if (typeof numShiftX === 'number') {\n        // Left\n        if (nextPopupX < visibleRegionArea.left) {\n          nextOffsetX -= nextPopupX - visibleRegionArea.left - popupOffsetX;\n          if (targetRect.x + targetWidth < visibleRegionArea.left + numShiftX) {\n            nextOffsetX += targetRect.x - visibleRegionArea.left + targetWidth - numShiftX;\n          }\n        }\n\n        // Right\n        if (nextPopupRight > visibleRegionArea.right) {\n          nextOffsetX -= nextPopupRight - visibleRegionArea.right - popupOffsetX;\n          if (targetRect.x > visibleRegionArea.right - numShiftX) {\n            nextOffsetX += targetRect.x - visibleRegionArea.right + numShiftX;\n          }\n        }\n      }\n      var numShiftY = shiftY === true ? 0 : shiftY;\n      if (typeof numShiftY === 'number') {\n        // Top\n        if (nextPopupY < visibleRegionArea.top) {\n          nextOffsetY -= nextPopupY - visibleRegionArea.top - popupOffsetY;\n\n          // When target if far away from visible area\n          // Stop shift\n          if (targetRect.y + targetHeight < visibleRegionArea.top + numShiftY) {\n            nextOffsetY += targetRect.y - visibleRegionArea.top + targetHeight - numShiftY;\n          }\n        }\n\n        // Bottom\n        if (nextPopupBottom > visibleRegionArea.bottom) {\n          nextOffsetY -= nextPopupBottom - visibleRegionArea.bottom - popupOffsetY;\n          if (targetRect.y > visibleRegionArea.bottom - numShiftY) {\n            nextOffsetY += targetRect.y - visibleRegionArea.bottom + numShiftY;\n          }\n        }\n      }\n\n      // ============================ Arrow ============================\n      // Arrow center align\n      var popupLeft = popupRect.x + nextOffsetX;\n      var popupRight = popupLeft + popupWidth;\n      var popupTop = popupRect.y + nextOffsetY;\n      var popupBottom = popupTop + popupHeight;\n      var targetLeft = targetRect.x;\n      var targetRight = targetLeft + targetWidth;\n      var targetTop = targetRect.y;\n      var targetBottom = targetTop + targetHeight;\n      var maxLeft = Math.max(popupLeft, targetLeft);\n      var minRight = Math.min(popupRight, targetRight);\n      var xCenter = (maxLeft + minRight) / 2;\n      var nextArrowX = xCenter - popupLeft;\n      var maxTop = Math.max(popupTop, targetTop);\n      var minBottom = Math.min(popupBottom, targetBottom);\n      var yCenter = (maxTop + minBottom) / 2;\n      var nextArrowY = yCenter - popupTop;\n      onPopupAlign === null || onPopupAlign === void 0 || onPopupAlign(popupEle, nextAlignInfo);\n\n      // Additional calculate right & bottom position\n      var offsetX4Right = popupMirrorRect.right - popupRect.x - (nextOffsetX + popupRect.width);\n      var offsetY4Bottom = popupMirrorRect.bottom - popupRect.y - (nextOffsetY + popupRect.height);\n      setOffsetInfo({\n        ready: true,\n        offsetX: nextOffsetX / _scaleX,\n        offsetY: nextOffsetY / _scaleY,\n        offsetR: offsetX4Right / _scaleX,\n        offsetB: offsetY4Bottom / _scaleY,\n        arrowX: nextArrowX / _scaleX,\n        arrowY: nextArrowY / _scaleY,\n        scaleX: _scaleX,\n        scaleY: _scaleY,\n        align: nextAlignInfo\n      });\n    }\n  });\n  var triggerAlign = function triggerAlign() {\n    alignCountRef.current += 1;\n    var id = alignCountRef.current;\n\n    // Merge all align requirement into one frame\n    Promise.resolve().then(function () {\n      if (alignCountRef.current === id) {\n        onAlign();\n      }\n    });\n  };\n\n  // Reset ready status when placement & open changed\n  var resetReady = function resetReady() {\n    setOffsetInfo(function (ori) {\n      return _objectSpread(_objectSpread({}, ori), {}, {\n        ready: false\n      });\n    });\n  };\n  useLayoutEffect(resetReady, [placement]);\n  useLayoutEffect(function () {\n    if (!open) {\n      resetReady();\n    }\n  }, [open]);\n  return [offsetInfo.ready, offsetInfo.offsetX, offsetInfo.offsetY, offsetInfo.offsetR, offsetInfo.offsetB, offsetInfo.arrowX, offsetInfo.arrowY, offsetInfo.scaleX, offsetInfo.scaleY, offsetInfo.align, triggerAlign];\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}