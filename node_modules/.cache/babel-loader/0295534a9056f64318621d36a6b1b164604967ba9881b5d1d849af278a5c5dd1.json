{"ast":null,"code":"import _typeof from\"@babel/runtime/helpers/esm/typeof\";import _objectSpread from\"@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";/* eslint-disable no-param-reassign */import*as React from'react';import raf from\"rc-util/es/raf\";import useLayoutEffect from\"rc-util/es/hooks/useLayoutEffect\";import{warning}from'rc-util';var MAX_TIMES=10;export default function useScrollTo(containerRef,data,heights,itemHeight,getKey,collectHeight,syncScrollTop,triggerFlash){var scrollRef=React.useRef();var _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),syncState=_React$useState2[0],setSyncState=_React$useState2[1];// ========================== Sync Scroll ==========================\nuseLayoutEffect(function(){if(syncState&&syncState.times<MAX_TIMES){// Never reach\nif(!containerRef.current){setSyncState(function(ori){return _objectSpread({},ori);});return;}collectHeight();var targetAlign=syncState.targetAlign,originAlign=syncState.originAlign,index=syncState.index,offset=syncState.offset;var height=containerRef.current.clientHeight;var needCollectHeight=false;var newTargetAlign=targetAlign;var targetTop=null;// Go to next frame if height not exist\nif(height){var mergedAlign=targetAlign||originAlign;// Get top & bottom\nvar stackTop=0;var itemTop=0;var itemBottom=0;var maxLen=Math.min(data.length-1,index);for(var i=0;i<=maxLen;i+=1){var key=getKey(data[i]);itemTop=stackTop;var cacheHeight=heights.get(key);itemBottom=itemTop+(cacheHeight===undefined?itemHeight:cacheHeight);stackTop=itemBottom;}// Check if need sync height (visible range has item not record height)\nvar leftHeight=mergedAlign==='top'?offset:height-offset;for(var _i=maxLen;_i>=0;_i-=1){var _key=getKey(data[_i]);var _cacheHeight=heights.get(_key);if(_cacheHeight===undefined){needCollectHeight=true;break;}leftHeight-=_cacheHeight;if(leftHeight<=0){break;}}// Scroll to\nswitch(mergedAlign){case'top':targetTop=itemTop-offset;break;case'bottom':targetTop=itemBottom-height+offset;break;default:{var scrollTop=containerRef.current.scrollTop;var scrollBottom=scrollTop+height;if(itemTop<scrollTop){newTargetAlign='top';}else if(itemBottom>scrollBottom){newTargetAlign='bottom';}}}if(targetTop!==null){syncScrollTop(targetTop);}// One more time for sync\nif(targetTop!==syncState.lastTop){needCollectHeight=true;}}// Trigger next effect\nif(needCollectHeight){setSyncState(_objectSpread(_objectSpread({},syncState),{},{times:syncState.times+1,targetAlign:newTargetAlign,lastTop:targetTop}));}}else if(process.env.NODE_ENV!=='production'&&(syncState===null||syncState===void 0?void 0:syncState.times)===MAX_TIMES){warning(false,'Seems `scrollTo` with `rc-virtual-list` reach the max limitation. Please fire issue for us. Thanks.');}},[syncState,containerRef.current]);// =========================== Scroll To ===========================\nreturn function(arg){// When not argument provided, we think dev may want to show the scrollbar\nif(arg===null||arg===undefined){triggerFlash();return;}// Normal scroll logic\nraf.cancel(scrollRef.current);if(typeof arg==='number'){syncScrollTop(arg);}else if(arg&&_typeof(arg)==='object'){var index;var align=arg.align;if('index'in arg){index=arg.index;}else{index=data.findIndex(function(item){return getKey(item)===arg.key;});}var _arg$offset=arg.offset,offset=_arg$offset===void 0?0:_arg$offset;setSyncState({times:0,index:index,offset:offset,originAlign:align});}};}","map":{"version":3,"names":["_typeof","_objectSpread","_slicedToArray","React","raf","useLayoutEffect","warning","MAX_TIMES","useScrollTo","containerRef","data","heights","itemHeight","getKey","collectHeight","syncScrollTop","triggerFlash","scrollRef","useRef","_React$useState","useState","_React$useState2","syncState","setSyncState","times","current","ori","targetAlign","originAlign","index","offset","height","clientHeight","needCollectHeight","newTargetAlign","targetTop","mergedAlign","stackTop","itemTop","itemBottom","maxLen","Math","min","length","i","key","cacheHeight","get","undefined","leftHeight","_i","_key","_cacheHeight","scrollTop","scrollBottom","lastTop","process","env","NODE_ENV","arg","cancel","align","findIndex","item","_arg$offset"],"sources":["/Users/jmmallon/Downloads/js/ticketproject/src/node_modules/rc-virtual-list/es/hooks/useScrollTo.js"],"sourcesContent":["import _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n/* eslint-disable no-param-reassign */\nimport * as React from 'react';\nimport raf from \"rc-util/es/raf\";\nimport useLayoutEffect from \"rc-util/es/hooks/useLayoutEffect\";\nimport { warning } from 'rc-util';\nvar MAX_TIMES = 10;\nexport default function useScrollTo(containerRef, data, heights, itemHeight, getKey, collectHeight, syncScrollTop, triggerFlash) {\n  var scrollRef = React.useRef();\n  var _React$useState = React.useState(null),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    syncState = _React$useState2[0],\n    setSyncState = _React$useState2[1];\n\n  // ========================== Sync Scroll ==========================\n  useLayoutEffect(function () {\n    if (syncState && syncState.times < MAX_TIMES) {\n      // Never reach\n      if (!containerRef.current) {\n        setSyncState(function (ori) {\n          return _objectSpread({}, ori);\n        });\n        return;\n      }\n      collectHeight();\n      var targetAlign = syncState.targetAlign,\n        originAlign = syncState.originAlign,\n        index = syncState.index,\n        offset = syncState.offset;\n      var height = containerRef.current.clientHeight;\n      var needCollectHeight = false;\n      var newTargetAlign = targetAlign;\n      var targetTop = null;\n\n      // Go to next frame if height not exist\n      if (height) {\n        var mergedAlign = targetAlign || originAlign;\n\n        // Get top & bottom\n        var stackTop = 0;\n        var itemTop = 0;\n        var itemBottom = 0;\n        var maxLen = Math.min(data.length - 1, index);\n        for (var i = 0; i <= maxLen; i += 1) {\n          var key = getKey(data[i]);\n          itemTop = stackTop;\n          var cacheHeight = heights.get(key);\n          itemBottom = itemTop + (cacheHeight === undefined ? itemHeight : cacheHeight);\n          stackTop = itemBottom;\n        }\n\n        // Check if need sync height (visible range has item not record height)\n        var leftHeight = mergedAlign === 'top' ? offset : height - offset;\n        for (var _i = maxLen; _i >= 0; _i -= 1) {\n          var _key = getKey(data[_i]);\n          var _cacheHeight = heights.get(_key);\n          if (_cacheHeight === undefined) {\n            needCollectHeight = true;\n            break;\n          }\n          leftHeight -= _cacheHeight;\n          if (leftHeight <= 0) {\n            break;\n          }\n        }\n\n        // Scroll to\n        switch (mergedAlign) {\n          case 'top':\n            targetTop = itemTop - offset;\n            break;\n          case 'bottom':\n            targetTop = itemBottom - height + offset;\n            break;\n          default:\n            {\n              var scrollTop = containerRef.current.scrollTop;\n              var scrollBottom = scrollTop + height;\n              if (itemTop < scrollTop) {\n                newTargetAlign = 'top';\n              } else if (itemBottom > scrollBottom) {\n                newTargetAlign = 'bottom';\n              }\n            }\n        }\n        if (targetTop !== null) {\n          syncScrollTop(targetTop);\n        }\n\n        // One more time for sync\n        if (targetTop !== syncState.lastTop) {\n          needCollectHeight = true;\n        }\n      }\n\n      // Trigger next effect\n      if (needCollectHeight) {\n        setSyncState(_objectSpread(_objectSpread({}, syncState), {}, {\n          times: syncState.times + 1,\n          targetAlign: newTargetAlign,\n          lastTop: targetTop\n        }));\n      }\n    } else if (process.env.NODE_ENV !== 'production' && (syncState === null || syncState === void 0 ? void 0 : syncState.times) === MAX_TIMES) {\n      warning(false, 'Seems `scrollTo` with `rc-virtual-list` reach the max limitation. Please fire issue for us. Thanks.');\n    }\n  }, [syncState, containerRef.current]);\n\n  // =========================== Scroll To ===========================\n  return function (arg) {\n    // When not argument provided, we think dev may want to show the scrollbar\n    if (arg === null || arg === undefined) {\n      triggerFlash();\n      return;\n    }\n\n    // Normal scroll logic\n    raf.cancel(scrollRef.current);\n    if (typeof arg === 'number') {\n      syncScrollTop(arg);\n    } else if (arg && _typeof(arg) === 'object') {\n      var index;\n      var align = arg.align;\n      if ('index' in arg) {\n        index = arg.index;\n      } else {\n        index = data.findIndex(function (item) {\n          return getKey(item) === arg.key;\n        });\n      }\n      var _arg$offset = arg.offset,\n        offset = _arg$offset === void 0 ? 0 : _arg$offset;\n      setSyncState({\n        times: 0,\n        index: index,\n        offset: offset,\n        originAlign: align\n      });\n    }\n  };\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}