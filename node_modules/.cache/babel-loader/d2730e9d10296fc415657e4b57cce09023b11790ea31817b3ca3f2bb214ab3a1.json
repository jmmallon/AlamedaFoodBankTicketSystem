{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";import*as React from'react';import{useRef,useEffect}from'react';import findDOMNode from\"rc-util/es/Dom/findDOMNode\";import raf from\"rc-util/es/raf\";import CacheMap from\"../utils/CacheMap\";export default function useHeights(getKey,onItemAdd,onItemRemove){var _React$useState=React.useState(0),_React$useState2=_slicedToArray(_React$useState,2),updatedMark=_React$useState2[0],setUpdatedMark=_React$useState2[1];var instanceRef=useRef(new Map());var heightsRef=useRef(new CacheMap());var collectRafRef=useRef();function cancelRaf(){raf.cancel(collectRafRef.current);}function collectHeight(){var sync=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;cancelRaf();var doCollect=function doCollect(){instanceRef.current.forEach(function(element,key){if(element&&element.offsetParent){var htmlElement=findDOMNode(element);var offsetHeight=htmlElement.offsetHeight;if(heightsRef.current.get(key)!==offsetHeight){heightsRef.current.set(key,htmlElement.offsetHeight);}}});// Always trigger update mark to tell parent that should re-calculate heights when resized\nsetUpdatedMark(function(c){return c+1;});};if(sync){doCollect();}else{collectRafRef.current=raf(doCollect);}}function setInstanceRef(item,instance){var key=getKey(item);var origin=instanceRef.current.get(key);if(instance){instanceRef.current.set(key,instance);collectHeight();}else{instanceRef.current.delete(key);}// Instance changed\nif(!origin!==!instance){if(instance){onItemAdd===null||onItemAdd===void 0||onItemAdd(item);}else{onItemRemove===null||onItemRemove===void 0||onItemRemove(item);}}}useEffect(function(){return cancelRaf;},[]);return[setInstanceRef,collectHeight,heightsRef.current,updatedMark];}","map":{"version":3,"names":["_slicedToArray","React","useRef","useEffect","findDOMNode","raf","CacheMap","useHeights","getKey","onItemAdd","onItemRemove","_React$useState","useState","_React$useState2","updatedMark","setUpdatedMark","instanceRef","Map","heightsRef","collectRafRef","cancelRaf","cancel","current","collectHeight","sync","arguments","length","undefined","doCollect","forEach","element","key","offsetParent","htmlElement","offsetHeight","get","set","c","setInstanceRef","item","instance","origin","delete"],"sources":["/Users/jmmallon/Downloads/js/ticketproject/src/node_modules/rc-virtual-list/es/hooks/useHeights.js"],"sourcesContent":["import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport * as React from 'react';\nimport { useRef, useEffect } from 'react';\nimport findDOMNode from \"rc-util/es/Dom/findDOMNode\";\nimport raf from \"rc-util/es/raf\";\nimport CacheMap from \"../utils/CacheMap\";\nexport default function useHeights(getKey, onItemAdd, onItemRemove) {\n  var _React$useState = React.useState(0),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    updatedMark = _React$useState2[0],\n    setUpdatedMark = _React$useState2[1];\n  var instanceRef = useRef(new Map());\n  var heightsRef = useRef(new CacheMap());\n  var collectRafRef = useRef();\n  function cancelRaf() {\n    raf.cancel(collectRafRef.current);\n  }\n  function collectHeight() {\n    var sync = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    cancelRaf();\n    var doCollect = function doCollect() {\n      instanceRef.current.forEach(function (element, key) {\n        if (element && element.offsetParent) {\n          var htmlElement = findDOMNode(element);\n          var offsetHeight = htmlElement.offsetHeight;\n          if (heightsRef.current.get(key) !== offsetHeight) {\n            heightsRef.current.set(key, htmlElement.offsetHeight);\n          }\n        }\n      });\n\n      // Always trigger update mark to tell parent that should re-calculate heights when resized\n      setUpdatedMark(function (c) {\n        return c + 1;\n      });\n    };\n    if (sync) {\n      doCollect();\n    } else {\n      collectRafRef.current = raf(doCollect);\n    }\n  }\n  function setInstanceRef(item, instance) {\n    var key = getKey(item);\n    var origin = instanceRef.current.get(key);\n    if (instance) {\n      instanceRef.current.set(key, instance);\n      collectHeight();\n    } else {\n      instanceRef.current.delete(key);\n    }\n\n    // Instance changed\n    if (!origin !== !instance) {\n      if (instance) {\n        onItemAdd === null || onItemAdd === void 0 || onItemAdd(item);\n      } else {\n        onItemRemove === null || onItemRemove === void 0 || onItemRemove(item);\n      }\n    }\n  }\n  useEffect(function () {\n    return cancelRaf;\n  }, []);\n  return [setInstanceRef, collectHeight, heightsRef.current, updatedMark];\n}"],"mappings":"AAAA,MAAO,CAAAA,cAAc,KAAM,0CAA0C,CACrE,MAAO,GAAK,CAAAC,KAAK,KAAM,OAAO,CAC9B,OAASC,MAAM,CAAEC,SAAS,KAAQ,OAAO,CACzC,MAAO,CAAAC,WAAW,KAAM,4BAA4B,CACpD,MAAO,CAAAC,GAAG,KAAM,gBAAgB,CAChC,MAAO,CAAAC,QAAQ,KAAM,mBAAmB,CACxC,cAAe,SAAS,CAAAC,UAAUA,CAACC,MAAM,CAAEC,SAAS,CAAEC,YAAY,CAAE,CAClE,GAAI,CAAAC,eAAe,CAAGV,KAAK,CAACW,QAAQ,CAAC,CAAC,CAAC,CACrCC,gBAAgB,CAAGb,cAAc,CAACW,eAAe,CAAE,CAAC,CAAC,CACrDG,WAAW,CAAGD,gBAAgB,CAAC,CAAC,CAAC,CACjCE,cAAc,CAAGF,gBAAgB,CAAC,CAAC,CAAC,CACtC,GAAI,CAAAG,WAAW,CAAGd,MAAM,CAAC,GAAI,CAAAe,GAAG,CAAC,CAAC,CAAC,CACnC,GAAI,CAAAC,UAAU,CAAGhB,MAAM,CAAC,GAAI,CAAAI,QAAQ,CAAC,CAAC,CAAC,CACvC,GAAI,CAAAa,aAAa,CAAGjB,MAAM,CAAC,CAAC,CAC5B,QAAS,CAAAkB,SAASA,CAAA,CAAG,CACnBf,GAAG,CAACgB,MAAM,CAACF,aAAa,CAACG,OAAO,CAAC,CACnC,CACA,QAAS,CAAAC,aAAaA,CAAA,CAAG,CACvB,GAAI,CAAAC,IAAI,CAAGC,SAAS,CAACC,MAAM,CAAG,CAAC,EAAID,SAAS,CAAC,CAAC,CAAC,GAAKE,SAAS,CAAGF,SAAS,CAAC,CAAC,CAAC,CAAG,KAAK,CACpFL,SAAS,CAAC,CAAC,CACX,GAAI,CAAAQ,SAAS,CAAG,QAAS,CAAAA,SAASA,CAAA,CAAG,CACnCZ,WAAW,CAACM,OAAO,CAACO,OAAO,CAAC,SAAUC,OAAO,CAAEC,GAAG,CAAE,CAClD,GAAID,OAAO,EAAIA,OAAO,CAACE,YAAY,CAAE,CACnC,GAAI,CAAAC,WAAW,CAAG7B,WAAW,CAAC0B,OAAO,CAAC,CACtC,GAAI,CAAAI,YAAY,CAAGD,WAAW,CAACC,YAAY,CAC3C,GAAIhB,UAAU,CAACI,OAAO,CAACa,GAAG,CAACJ,GAAG,CAAC,GAAKG,YAAY,CAAE,CAChDhB,UAAU,CAACI,OAAO,CAACc,GAAG,CAACL,GAAG,CAAEE,WAAW,CAACC,YAAY,CAAC,CACvD,CACF,CACF,CAAC,CAAC,CAEF;AACAnB,cAAc,CAAC,SAAUsB,CAAC,CAAE,CAC1B,MAAO,CAAAA,CAAC,CAAG,CAAC,CACd,CAAC,CAAC,CACJ,CAAC,CACD,GAAIb,IAAI,CAAE,CACRI,SAAS,CAAC,CAAC,CACb,CAAC,IAAM,CACLT,aAAa,CAACG,OAAO,CAAGjB,GAAG,CAACuB,SAAS,CAAC,CACxC,CACF,CACA,QAAS,CAAAU,cAAcA,CAACC,IAAI,CAAEC,QAAQ,CAAE,CACtC,GAAI,CAAAT,GAAG,CAAGvB,MAAM,CAAC+B,IAAI,CAAC,CACtB,GAAI,CAAAE,MAAM,CAAGzB,WAAW,CAACM,OAAO,CAACa,GAAG,CAACJ,GAAG,CAAC,CACzC,GAAIS,QAAQ,CAAE,CACZxB,WAAW,CAACM,OAAO,CAACc,GAAG,CAACL,GAAG,CAAES,QAAQ,CAAC,CACtCjB,aAAa,CAAC,CAAC,CACjB,CAAC,IAAM,CACLP,WAAW,CAACM,OAAO,CAACoB,MAAM,CAACX,GAAG,CAAC,CACjC,CAEA;AACA,GAAI,CAACU,MAAM,GAAK,CAACD,QAAQ,CAAE,CACzB,GAAIA,QAAQ,CAAE,CACZ/B,SAAS,GAAK,IAAI,EAAIA,SAAS,GAAK,IAAK,EAAC,EAAIA,SAAS,CAAC8B,IAAI,CAAC,CAC/D,CAAC,IAAM,CACL7B,YAAY,GAAK,IAAI,EAAIA,YAAY,GAAK,IAAK,EAAC,EAAIA,YAAY,CAAC6B,IAAI,CAAC,CACxE,CACF,CACF,CACApC,SAAS,CAAC,UAAY,CACpB,MAAO,CAAAiB,SAAS,CAClB,CAAC,CAAE,EAAE,CAAC,CACN,MAAO,CAACkB,cAAc,CAAEf,aAAa,CAAEL,UAAU,CAACI,OAAO,CAAER,WAAW,CAAC,CACzE","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}